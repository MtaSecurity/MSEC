<!doctype html><html lang=en dir=ltr class=scroll-smooth data-default-appearance=light data-auto-appearance=true><head><meta charset=utf-8><meta http-equiv=content-language content="en"><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=X-UA-Compatible content="ie=edge"><meta name=theme-color><title>Write-up for Reverse Master CSCV2025 &#183; MSEC</title><meta name=title content="Write-up for Reverse Master CSCV2025  &#183; MSEC"><link rel=canonical href=https://mtasecurity.github.io/MSEC/re/1761315247629-re/><meta property="og:url" content="https://mtasecurity.github.io/MSEC/re/1761315247629-re/"><meta property="og:site_name" content="MSEC"><meta property="og:title" content="Write-up for Reverse Master CSCV2025 "><meta property="og:description" content='Hello everyone🫡! Today I will write a little bit about The Reverse Master challenge in CSCV2025. The question: When we install the file we will have an apk file like this: Use jadx-gui to decompile this file,then open Source code/com/ctf.challenge and you will see Main Activity like this: Open that and you will see the code below:
package com.ctf.challenge; import android.graphics.Color; import android.os.Bundle; import android.util.Log; import android.view.View; import android.view.ViewGroup; import android.widget.Button; import android.widget.LinearLayout; import android.widget.TextView; import androidx.appcompat.app.AppCompatActivity; import com.google.android.material.textfield.TextInputEditText; import com.google.android.material.textfield.TextInputLayout; import java.io.BufferedReader; import java.io.File; import java.io.IOException; import java.io.InputStreamReader; import java.net.InetSocketAddress; import java.net.Socket; import o.CountDownTimerC0176z3; import o.F2; import o.F3; import o.RunnableC0154w; import o.V4; /* loaded from: classes.dex */ public final class MainActivity extends AppCompatActivity { public static final /* synthetic */ int b = 0; public final byte[] a = {66, 51, 122, 33, 86}; static { try { System.loadLibrary("native-lib"); } catch (UnsatisfiedLinkError e) { Log.e("CTF", "❌ Native lib failed: " + e.getMessage()); } } public final native boolean checkSecondHalf(String str); public final native String getHint(); public final void h(LinearLayout linearLayout, String str, String str2) { View viewInflate = getLayoutInflater().inflate(android.R.layout.simple_list_item_2, (ViewGroup) linearLayout, false); TextView textView = (TextView) viewInflate.findViewById(android.R.id.text1); TextView textView2 = (TextView) viewInflate.findViewById(android.R.id.text2); textView.setText("⚠️ ".concat(str)); textView.setTextColor(Color.parseColor("#FF5252")); textView.setTextSize(16.0f); textView.setTypeface(null, 1); textView2.setText(str2); textView2.setTextColor(Color.parseColor("#BDBDBD")); textView2.setTextSize(13.0f); linearLayout.addView(viewInflate); } @Override // androidx.fragment.app.FragmentActivity, androidx.activity.ComponentActivity, androidx.core.app.ComponentActivity, android.app.Activity public final void onCreate(Bundle bundle) throws IOException { boolean z; String line; super.onCreate(bundle); setContentView(R.layout.activity_main); boolean z2 = false; boolean z3 = (getApplicationInfo().flags & 2) != 0; String[] strArr = {"/system/app/Superuser.apk", "/sbin/su", "/system/bin/su", "/system/xbin/su", "/data/local/xbin/su", "/data/local/bin/su", "/system/sd/xbin/su", "/system/bin/failsafe/su", "/data/local/su"}; int i = 0; while (true) { if (i >= 9) { try { Runtime.getRuntime().exec("su"); break; } catch (Exception unused) { z = false; } } else if (new File(strArr[i]).exists()) { break; } else { i++; } } z = true; try { BufferedReader bufferedReader = new BufferedReader(new InputStreamReader(Runtime.getRuntime().exec("ps").getInputStream())); do { line = bufferedReader.readLine(); if (line == null) { break; } else if (!V4.u(line, "frida") && !V4.u(line, "gum-js-loop")) { } } while (!V4.u(line, "gmain")); z2 = true; bufferedReader.close(); } catch (Exception unused2) { } int i2 = 27042; while (true) { if (i2 >= 27053) { break; } try { Socket socket = new Socket(); socket.connect(new InetSocketAddress("127.0.0.1", i2), 100); socket.close(); z2 = true; break; } catch (Exception unused3) { i2++; } } if (!z3 && !z && !z2) { Thread thread = new Thread(new RunnableC0154w(8, this)); thread.setDaemon(true); thread.start(); final TextInputLayout textInputLayout = (TextInputLayout) findViewById(R.id.flagInputLayout); final TextInputEditText textInputEditText = (TextInputEditText) findViewById(R.id.flagInput); Button button = (Button) findViewById(R.id.checkButton); Button button2 = (Button) findViewById(R.id.hintButton); button.setOnClickListener(new View.OnClickListener() { // from class: o.y3 /* JADX WARN: Removed duplicated region for block: B:4:0x001a */ @Override // android.view.View.OnClickListener /* Code decompiled incorrectly, please refer to instructions dump. To view partially-correct code enable &#39;Show inconsistent code&#39; option in preferences */ public final void onClick(android.view.View r13) { /* r12 = this; r13 = 16 r0 = 1 int r1 = com.ctf.challenge.MainActivity.b com.google.android.material.textfield.TextInputEditText r1 = r1 android.text.Editable r1 = r1.getText() java.lang.String r1 = java.lang.String.valueOf(r1) com.ctf.challenge.MainActivity r2 = r2 java.lang.String r3 = "CSCV2025{" boolean r3 = r1.startsWith(r3) r4 = 0 if (r3 != 0) goto L1c L1a: r13 = r4 goto L6e L1c: java.lang.String r3 = "}" boolean r3 = r1.endsWith(r3) if (r3 != 0) goto L25 goto L1a L25: int r3 = r1.length() int r3 = r3 - r0 r5 = 9 java.lang.String r1 = r1.substring(r5, r3) java.lang.String r3 = "substring(...)" o.F2.e(r1, r3) java.lang.String r5 = r1.substring(r4, r13) o.F2.e(r5, r3) byte[] r6 = new byte[r13] r6 = {x0090: FILL_ARRAY_DATA , data: [122, 86, 27, 22, 53, 35, 80, 77, 24, 98, 122, 7, 72, 21, 98, 114} // fill-array byte[] r7 = new byte[r13] r8 = r4 L44: if (r8 >= r13) goto L55 r9 = r6[r8] byte[] r10 = r2.a int r11 = r10.length int r11 = r8 % r11 r10 = r10[r11] r9 = r9 ^ r10 byte r9 = (byte) r9 r7[r8] = r9 int r8 = r8 + r0 goto L44 L55: java.lang.String r6 = new java.lang.String java.nio.charset.Charset r8 = o.X.a r6.<init>(r7, r8) boolean r5 = r5.equals(r6) if (r5 != 0) goto L63 goto L1a L63: java.lang.String r13 = r1.substring(r13) o.F2.e(r13, r3) boolean r13 = r2.checkSecondHalf(r13) L6e: com.google.android.material.textfield.TextInputLayout r1 = r3 if (r13 == 0) goto L80 java.lang.String r13 = "🎉 Correct! Flag is valid!" android.widget.Toast r13 = android.widget.Toast.makeText(r2, r13, r0) r13.show() r13 = 0 r1.setError(r13) return L80: java.lang.String r13 = "❌ Wrong flag! Try again!" android.widget.Toast r13 = android.widget.Toast.makeText(r2, r13, r4) r13.show() java.lang.String r13 = "Invalid flag" r1.setError(r13) return */ throw new UnsupportedOperationException("Method not decompiled: o.ViewOnClickListenerC0170y3.onClick(android.view.View):void"); } }); button2.setOnClickListener(new F3(3, this)); return; } setContentView(R.layout.security_warning); TextView textView = (TextView) findViewById(R.id.countdownText); LinearLayout linearLayout = (LinearLayout) findViewById(R.id.issuesList); if (z3) { F2.c(linearLayout); h(linearLayout, "Debug Mode Detected", "Application is running in debuggable mode"); } if (z) { F2.c(linearLayout); h(linearLayout, "Root Access Detected", "Device has been rooted or jailbroken"); } if (z2) { F2.c(linearLayout); h(linearLayout, "Frida Framework Detected", "Dynamic instrumentation tool is running"); } new CountDownTimerC0176z3(textView, this).start(); } public final native void startFridaMonitoring(); } You can find the first half of the flag with this XOR code from python:'><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="re"><meta property="og:image" content="https://mtasecurity.github.io/MSEC/re/1761315247629-re/featured.png"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://mtasecurity.github.io/MSEC/re/1761315247629-re/featured.png"><meta name=twitter:title content="Write-up for Reverse Master CSCV2025 "><meta name=twitter:description content='Hello everyone🫡! Today I will write a little bit about The Reverse Master challenge in CSCV2025. The question: When we install the file we will have an apk file like this: Use jadx-gui to decompile this file,then open Source code/com/ctf.challenge and you will see Main Activity like this: Open that and you will see the code below:
package com.ctf.challenge; import android.graphics.Color; import android.os.Bundle; import android.util.Log; import android.view.View; import android.view.ViewGroup; import android.widget.Button; import android.widget.LinearLayout; import android.widget.TextView; import androidx.appcompat.app.AppCompatActivity; import com.google.android.material.textfield.TextInputEditText; import com.google.android.material.textfield.TextInputLayout; import java.io.BufferedReader; import java.io.File; import java.io.IOException; import java.io.InputStreamReader; import java.net.InetSocketAddress; import java.net.Socket; import o.CountDownTimerC0176z3; import o.F2; import o.F3; import o.RunnableC0154w; import o.V4; /* loaded from: classes.dex */ public final class MainActivity extends AppCompatActivity { public static final /* synthetic */ int b = 0; public final byte[] a = {66, 51, 122, 33, 86}; static { try { System.loadLibrary("native-lib"); } catch (UnsatisfiedLinkError e) { Log.e("CTF", "❌ Native lib failed: " + e.getMessage()); } } public final native boolean checkSecondHalf(String str); public final native String getHint(); public final void h(LinearLayout linearLayout, String str, String str2) { View viewInflate = getLayoutInflater().inflate(android.R.layout.simple_list_item_2, (ViewGroup) linearLayout, false); TextView textView = (TextView) viewInflate.findViewById(android.R.id.text1); TextView textView2 = (TextView) viewInflate.findViewById(android.R.id.text2); textView.setText("⚠️ ".concat(str)); textView.setTextColor(Color.parseColor("#FF5252")); textView.setTextSize(16.0f); textView.setTypeface(null, 1); textView2.setText(str2); textView2.setTextColor(Color.parseColor("#BDBDBD")); textView2.setTextSize(13.0f); linearLayout.addView(viewInflate); } @Override // androidx.fragment.app.FragmentActivity, androidx.activity.ComponentActivity, androidx.core.app.ComponentActivity, android.app.Activity public final void onCreate(Bundle bundle) throws IOException { boolean z; String line; super.onCreate(bundle); setContentView(R.layout.activity_main); boolean z2 = false; boolean z3 = (getApplicationInfo().flags & 2) != 0; String[] strArr = {"/system/app/Superuser.apk", "/sbin/su", "/system/bin/su", "/system/xbin/su", "/data/local/xbin/su", "/data/local/bin/su", "/system/sd/xbin/su", "/system/bin/failsafe/su", "/data/local/su"}; int i = 0; while (true) { if (i >= 9) { try { Runtime.getRuntime().exec("su"); break; } catch (Exception unused) { z = false; } } else if (new File(strArr[i]).exists()) { break; } else { i++; } } z = true; try { BufferedReader bufferedReader = new BufferedReader(new InputStreamReader(Runtime.getRuntime().exec("ps").getInputStream())); do { line = bufferedReader.readLine(); if (line == null) { break; } else if (!V4.u(line, "frida") && !V4.u(line, "gum-js-loop")) { } } while (!V4.u(line, "gmain")); z2 = true; bufferedReader.close(); } catch (Exception unused2) { } int i2 = 27042; while (true) { if (i2 >= 27053) { break; } try { Socket socket = new Socket(); socket.connect(new InetSocketAddress("127.0.0.1", i2), 100); socket.close(); z2 = true; break; } catch (Exception unused3) { i2++; } } if (!z3 && !z && !z2) { Thread thread = new Thread(new RunnableC0154w(8, this)); thread.setDaemon(true); thread.start(); final TextInputLayout textInputLayout = (TextInputLayout) findViewById(R.id.flagInputLayout); final TextInputEditText textInputEditText = (TextInputEditText) findViewById(R.id.flagInput); Button button = (Button) findViewById(R.id.checkButton); Button button2 = (Button) findViewById(R.id.hintButton); button.setOnClickListener(new View.OnClickListener() { // from class: o.y3 /* JADX WARN: Removed duplicated region for block: B:4:0x001a */ @Override // android.view.View.OnClickListener /* Code decompiled incorrectly, please refer to instructions dump. To view partially-correct code enable &#39;Show inconsistent code&#39; option in preferences */ public final void onClick(android.view.View r13) { /* r12 = this; r13 = 16 r0 = 1 int r1 = com.ctf.challenge.MainActivity.b com.google.android.material.textfield.TextInputEditText r1 = r1 android.text.Editable r1 = r1.getText() java.lang.String r1 = java.lang.String.valueOf(r1) com.ctf.challenge.MainActivity r2 = r2 java.lang.String r3 = "CSCV2025{" boolean r3 = r1.startsWith(r3) r4 = 0 if (r3 != 0) goto L1c L1a: r13 = r4 goto L6e L1c: java.lang.String r3 = "}" boolean r3 = r1.endsWith(r3) if (r3 != 0) goto L25 goto L1a L25: int r3 = r1.length() int r3 = r3 - r0 r5 = 9 java.lang.String r1 = r1.substring(r5, r3) java.lang.String r3 = "substring(...)" o.F2.e(r1, r3) java.lang.String r5 = r1.substring(r4, r13) o.F2.e(r5, r3) byte[] r6 = new byte[r13] r6 = {x0090: FILL_ARRAY_DATA , data: [122, 86, 27, 22, 53, 35, 80, 77, 24, 98, 122, 7, 72, 21, 98, 114} // fill-array byte[] r7 = new byte[r13] r8 = r4 L44: if (r8 >= r13) goto L55 r9 = r6[r8] byte[] r10 = r2.a int r11 = r10.length int r11 = r8 % r11 r10 = r10[r11] r9 = r9 ^ r10 byte r9 = (byte) r9 r7[r8] = r9 int r8 = r8 + r0 goto L44 L55: java.lang.String r6 = new java.lang.String java.nio.charset.Charset r8 = o.X.a r6.<init>(r7, r8) boolean r5 = r5.equals(r6) if (r5 != 0) goto L63 goto L1a L63: java.lang.String r13 = r1.substring(r13) o.F2.e(r13, r3) boolean r13 = r2.checkSecondHalf(r13) L6e: com.google.android.material.textfield.TextInputLayout r1 = r3 if (r13 == 0) goto L80 java.lang.String r13 = "🎉 Correct! Flag is valid!" android.widget.Toast r13 = android.widget.Toast.makeText(r2, r13, r0) r13.show() r13 = 0 r1.setError(r13) return L80: java.lang.String r13 = "❌ Wrong flag! Try again!" android.widget.Toast r13 = android.widget.Toast.makeText(r2, r13, r4) r13.show() java.lang.String r13 = "Invalid flag" r1.setError(r13) return */ throw new UnsupportedOperationException("Method not decompiled: o.ViewOnClickListenerC0170y3.onClick(android.view.View):void"); } }); button2.setOnClickListener(new F3(3, this)); return; } setContentView(R.layout.security_warning); TextView textView = (TextView) findViewById(R.id.countdownText); LinearLayout linearLayout = (LinearLayout) findViewById(R.id.issuesList); if (z3) { F2.c(linearLayout); h(linearLayout, "Debug Mode Detected", "Application is running in debuggable mode"); } if (z) { F2.c(linearLayout); h(linearLayout, "Root Access Detected", "Device has been rooted or jailbroken"); } if (z2) { F2.c(linearLayout); h(linearLayout, "Frida Framework Detected", "Dynamic instrumentation tool is running"); } new CountDownTimerC0176z3(textView, this).start(); } public final native void startFridaMonitoring(); } You can find the first half of the flag with this XOR code from python:'><link type=text/css rel=stylesheet href=/MSEC/css/main.bundle.min.f29275ec9a06cd0f99442e96f7c1c5a8b1f1f1f98e65f2846b8beffe8797ee2e760933eecb052747f470d68248c81e22b82d8b8b260116d51bcc0d2d9a77a4e6.css integrity="sha512-8pJ17JoGzQ+ZRC6W98HFqLHx8fmOZfKEa4vv/oeX7i52CTPuywUnR/Rw1oJIyB4iuC2LiyYBFtUbzA0tmnek5g=="><script type=text/javascript src=/MSEC/js/appearance.min.6f41174b3a05b680820fe08cadbfa5fb7a7ca347b76a0955cdc68b9d8aca1ce24f0547e138cea33bcc7904d551a90afcb1cc7f2d9fe8557075d501419046c08c.js integrity="sha512-b0EXSzoFtoCCD+CMrb+l+3p8o0e3aglVzcaLnYrKHOJPBUfhOM6jO8x5BNVRqQr8scx/LZ/oVXB11QFBkEbAjA=="></script><script src=/MSEC/lib/zoom/zoom.min.umd.a527109b68c082a70f3697716dd72a9d5aa8b545cf800cecbbc7399f2ca6f6e0ce3e431f2062b48bbfa47c9ea42822714060bef309be073f49b9c0e30d318d7b.js integrity="sha512-pScQm2jAgqcPNpdxbdcqnVqotUXPgAzsu8c5nyym9uDOPkMfIGK0i7+kfJ6kKCJxQGC+8wm+Bz9JucDjDTGNew=="></script><script defer type=text/javascript id=script-bundle src=/MSEC/js/main.bundle.min.9df4fc14d50efcc9aa4cfc2b6f348e365f421f5ad491278f8f48c0360cf2f93f08882fda6da162d7ace8e5add57c2df4ac46bd3861306b1d4c452cd31f448d64.js integrity="sha512-nfT8FNUO/MmqTPwrbzSONl9CH1rUkSePj0jANgzy+T8IiC/abaFi16zo5a3VfC30rEa9OGEwax1MRSzTH0SNZA==" data-copy=Copy data-copied=Copied></script><script src=/MSEC/lib/jquery/jquery.slim.min.b0dca576e87d7eaa5850ae4e61759c065786cdb6489d68fcc82240539eebd5da522bdb4fda085ffd245808c8fe2acb2516408eb774ef26b5f6015fc6737c0ea8.js integrity="sha512-sNylduh9fqpYUK5OYXWcBleGzbZInWj8yCJAU57r1dpSK9tP2ghf/SRYCMj+KsslFkCOt3TvJrX2AV/Gc3wOqA=="></script><link rel=apple-touch-icon sizes=180x180 href=/MSEC/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/MSEC/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/MSEC/favicon-16x16.png><link rel=manifest href=/MSEC/site.webmanifest><script type=application/ld+json>[{"@context":"https://schema.org","@type":"Article","articleSection":"REs","name":"Write-up for Reverse Master CSCV2025 ","headline":"Write-up for Reverse Master CSCV2025 ","abstract":"\u003cp\u003eHello everyone🫡! Today I will write a little bit about The \u003cem\u003e\u003cstrong\u003eReverse Master\u003c\/strong\u003e\u003c\/em\u003e challenge in CSCV2025.\nThe question:\n\u003cfigure\u003e\u003cimg\n    class=\u0022my-0 rounded-md\u0022\n    loading=\u0022lazy\u0022\n    decoding=\u0022async\u0022\n    fetchpriority=\u0022low\u0022\n    alt=\u0022image\u0022\n    src=\u0022https:\/\/hackmd.io\/_uploads\/B1vSBTNAee.png\u0022\n    \u003e\u003c\/figure\u003e\n\u003c\/p\u003e\n\u003cp\u003eWhen we install the file we will have an apk file like this:\n\u003cfigure\u003e\u003cimg\n    class=\u0022my-0 rounded-md\u0022\n    loading=\u0022lazy\u0022\n    decoding=\u0022async\u0022\n    fetchpriority=\u0022low\u0022\n    alt=\u0022image\u0022\n    src=\u0022https:\/\/hackmd.io\/_uploads\/Bk60raNReg.png\u0022\n    \u003e\u003c\/figure\u003e\n\nUse \u003cstrong\u003ejadx-gui\u003c\/strong\u003e to decompile this file,then open \u003cstrong\u003eSource code\/com\/ctf.challenge\u003c\/strong\u003e and you will see \u003cstrong\u003eMain Activity\u003c\/strong\u003e like this:\n\u003cfigure\u003e\u003cimg\n    class=\u0022my-0 rounded-md\u0022\n    loading=\u0022lazy\u0022\n    decoding=\u0022async\u0022\n    fetchpriority=\u0022low\u0022\n    alt=\u0022image\u0022\n    src=\u0022https:\/\/hackmd.io\/_uploads\/BJ7-D6NRlx.png\u0022\n    \u003e\u003c\/figure\u003e\n\nOpen that and you will see the code below:\u003c\/p\u003e\n\u003cpre tabindex=\u00220\u0022\u003e\u003ccode\u003epackage com.ctf.challenge;\n\nimport android.graphics.Color;\nimport android.os.Bundle;\nimport android.util.Log;\nimport android.view.View;\nimport android.view.ViewGroup;\nimport android.widget.Button;\nimport android.widget.LinearLayout;\nimport android.widget.TextView;\nimport androidx.appcompat.app.AppCompatActivity;\nimport com.google.android.material.textfield.TextInputEditText;\nimport com.google.android.material.textfield.TextInputLayout;\nimport java.io.BufferedReader;\nimport java.io.File;\nimport java.io.IOException;\nimport java.io.InputStreamReader;\nimport java.net.InetSocketAddress;\nimport java.net.Socket;\nimport o.CountDownTimerC0176z3;\nimport o.F2;\nimport o.F3;\nimport o.RunnableC0154w;\nimport o.V4;\n\n\/* loaded from: classes.dex *\/\npublic final class MainActivity extends AppCompatActivity {\n    public static final \/* synthetic *\/ int b = 0;\n    public final byte[] a = {66, 51, 122, 33, 86};\n\n    static {\n        try {\n            System.loadLibrary(\u0026#34;native-lib\u0026#34;);\n        } catch (UnsatisfiedLinkError e) {\n            Log.e(\u0026#34;CTF\u0026#34;, \u0026#34;❌ Native lib failed: \u0026#34; \u002b e.getMessage());\n        }\n    }\n\n    public final native boolean checkSecondHalf(String str);\n\n    public final native String getHint();\n\n    public final void h(LinearLayout linearLayout, String str, String str2) {\n        View viewInflate = getLayoutInflater().inflate(android.R.layout.simple_list_item_2, (ViewGroup) linearLayout, false);\n        TextView textView = (TextView) viewInflate.findViewById(android.R.id.text1);\n        TextView textView2 = (TextView) viewInflate.findViewById(android.R.id.text2);\n        textView.setText(\u0026#34;⚠️ \u0026#34;.concat(str));\n        textView.setTextColor(Color.parseColor(\u0026#34;#FF5252\u0026#34;));\n        textView.setTextSize(16.0f);\n        textView.setTypeface(null, 1);\n        textView2.setText(str2);\n        textView2.setTextColor(Color.parseColor(\u0026#34;#BDBDBD\u0026#34;));\n        textView2.setTextSize(13.0f);\n        linearLayout.addView(viewInflate);\n    }\n\n    @Override \/\/ androidx.fragment.app.FragmentActivity, androidx.activity.ComponentActivity, androidx.core.app.ComponentActivity, android.app.Activity\n    public final void onCreate(Bundle bundle) throws IOException {\n        boolean z;\n        String line;\n        super.onCreate(bundle);\n        setContentView(R.layout.activity_main);\n        boolean z2 = false;\n        boolean z3 = (getApplicationInfo().flags \u0026amp; 2) != 0;\n        String[] strArr = {\u0026#34;\/system\/app\/Superuser.apk\u0026#34;, \u0026#34;\/sbin\/su\u0026#34;, \u0026#34;\/system\/bin\/su\u0026#34;, \u0026#34;\/system\/xbin\/su\u0026#34;, \u0026#34;\/data\/local\/xbin\/su\u0026#34;, \u0026#34;\/data\/local\/bin\/su\u0026#34;, \u0026#34;\/system\/sd\/xbin\/su\u0026#34;, \u0026#34;\/system\/bin\/failsafe\/su\u0026#34;, \u0026#34;\/data\/local\/su\u0026#34;};\n        int i = 0;\n        while (true) {\n            if (i \u0026gt;= 9) {\n                try {\n                    Runtime.getRuntime().exec(\u0026#34;su\u0026#34;);\n                    break;\n                } catch (Exception unused) {\n                    z = false;\n                }\n            } else if (new File(strArr[i]).exists()) {\n                break;\n            } else {\n                i\u002b\u002b;\n            }\n        }\n        z = true;\n        try {\n            BufferedReader bufferedReader = new BufferedReader(new InputStreamReader(Runtime.getRuntime().exec(\u0026#34;ps\u0026#34;).getInputStream()));\n            do {\n                line = bufferedReader.readLine();\n                if (line == null) {\n                    break;\n                } else if (!V4.u(line, \u0026#34;frida\u0026#34;) \u0026amp;\u0026amp; !V4.u(line, \u0026#34;gum-js-loop\u0026#34;)) {\n                }\n            } while (!V4.u(line, \u0026#34;gmain\u0026#34;));\n            z2 = true;\n            bufferedReader.close();\n        } catch (Exception unused2) {\n        }\n        int i2 = 27042;\n        while (true) {\n            if (i2 \u0026gt;= 27053) {\n                break;\n            }\n            try {\n                Socket socket = new Socket();\n                socket.connect(new InetSocketAddress(\u0026#34;127.0.0.1\u0026#34;, i2), 100);\n                socket.close();\n                z2 = true;\n                break;\n            } catch (Exception unused3) {\n                i2\u002b\u002b;\n            }\n        }\n        if (!z3 \u0026amp;\u0026amp; !z \u0026amp;\u0026amp; !z2) {\n            Thread thread = new Thread(new RunnableC0154w(8, this));\n            thread.setDaemon(true);\n            thread.start();\n            final TextInputLayout textInputLayout = (TextInputLayout) findViewById(R.id.flagInputLayout);\n            final TextInputEditText textInputEditText = (TextInputEditText) findViewById(R.id.flagInput);\n            Button button = (Button) findViewById(R.id.checkButton);\n            Button button2 = (Button) findViewById(R.id.hintButton);\n            button.setOnClickListener(new View.OnClickListener() { \/\/ from class: o.y3\n                \/* JADX WARN: Removed duplicated region for block: B:4:0x001a  *\/\n                @Override \/\/ android.view.View.OnClickListener\n                \/*\n                    Code decompiled incorrectly, please refer to instructions dump.\n                    To view partially-correct code enable \u0026#39;Show inconsistent code\u0026#39; option in preferences\n                *\/\n                public final void onClick(android.view.View r13) {\n                    \/*\n                        r12 = this;\n                        r13 = 16\n                        r0 = 1\n                        int r1 = com.ctf.challenge.MainActivity.b\n                        com.google.android.material.textfield.TextInputEditText r1 = r1\n                        android.text.Editable r1 = r1.getText()\n                        java.lang.String r1 = java.lang.String.valueOf(r1)\n                        com.ctf.challenge.MainActivity r2 = r2\n                        java.lang.String r3 = \u0026#34;CSCV2025{\u0026#34;\n                        boolean r3 = r1.startsWith(r3)\n                        r4 = 0\n                        if (r3 != 0) goto L1c\n                    L1a:\n                        r13 = r4\n                        goto L6e\n                    L1c:\n                        java.lang.String r3 = \u0026#34;}\u0026#34;\n                        boolean r3 = r1.endsWith(r3)\n                        if (r3 != 0) goto L25\n                        goto L1a\n                    L25:\n                        int r3 = r1.length()\n                        int r3 = r3 - r0\n                        r5 = 9\n                        java.lang.String r1 = r1.substring(r5, r3)\n                        java.lang.String r3 = \u0026#34;substring(...)\u0026#34;\n                        o.F2.e(r1, r3)\n                        java.lang.String r5 = r1.substring(r4, r13)\n                        o.F2.e(r5, r3)\n                        byte[] r6 = new byte[r13]\n                        r6 = {x0090: FILL_ARRAY_DATA , data: [122, 86, 27, 22, 53, 35, 80, 77, 24, 98, 122, 7, 72, 21, 98, 114} \/\/ fill-array\n                        byte[] r7 = new byte[r13]\n                        r8 = r4\n                    L44:\n                        if (r8 \u0026gt;= r13) goto L55\n                        r9 = r6[r8]\n                        byte[] r10 = r2.a\n                        int r11 = r10.length\n                        int r11 = r8 % r11\n                        r10 = r10[r11]\n                        r9 = r9 ^ r10\n                        byte r9 = (byte) r9\n                        r7[r8] = r9\n                        int r8 = r8 \u002b r0\n                        goto L44\n                    L55:\n                        java.lang.String r6 = new java.lang.String\n                        java.nio.charset.Charset r8 = o.X.a\n                        r6.\u0026lt;init\u0026gt;(r7, r8)\n                        boolean r5 = r5.equals(r6)\n                        if (r5 != 0) goto L63\n                        goto L1a\n                    L63:\n                        java.lang.String r13 = r1.substring(r13)\n                        o.F2.e(r13, r3)\n                        boolean r13 = r2.checkSecondHalf(r13)\n                    L6e:\n                        com.google.android.material.textfield.TextInputLayout r1 = r3\n                        if (r13 == 0) goto L80\n                        java.lang.String r13 = \u0026#34;🎉 Correct! Flag is valid!\u0026#34;\n                        android.widget.Toast r13 = android.widget.Toast.makeText(r2, r13, r0)\n                        r13.show()\n                        r13 = 0\n                        r1.setError(r13)\n                        return\n                    L80:\n                        java.lang.String r13 = \u0026#34;❌ Wrong flag! Try again!\u0026#34;\n                        android.widget.Toast r13 = android.widget.Toast.makeText(r2, r13, r4)\n                        r13.show()\n                        java.lang.String r13 = \u0026#34;Invalid flag\u0026#34;\n                        r1.setError(r13)\n                        return\n                    *\/\n                    throw new UnsupportedOperationException(\u0026#34;Method not decompiled: o.ViewOnClickListenerC0170y3.onClick(android.view.View):void\u0026#34;);\n                }\n            });\n            button2.setOnClickListener(new F3(3, this));\n            return;\n        }\n        setContentView(R.layout.security_warning);\n        TextView textView = (TextView) findViewById(R.id.countdownText);\n        LinearLayout linearLayout = (LinearLayout) findViewById(R.id.issuesList);\n        if (z3) {\n            F2.c(linearLayout);\n            h(linearLayout, \u0026#34;Debug Mode Detected\u0026#34;, \u0026#34;Application is running in debuggable mode\u0026#34;);\n        }\n        if (z) {\n            F2.c(linearLayout);\n            h(linearLayout, \u0026#34;Root Access Detected\u0026#34;, \u0026#34;Device has been rooted or jailbroken\u0026#34;);\n        }\n        if (z2) {\n            F2.c(linearLayout);\n            h(linearLayout, \u0026#34;Frida Framework Detected\u0026#34;, \u0026#34;Dynamic instrumentation tool is running\u0026#34;);\n        }\n        new CountDownTimerC0176z3(textView, this).start();\n    }\n\n    public final native void startFridaMonitoring();\n}\n\u003c\/code\u003e\u003c\/pre\u003e\u003cp\u003eYou can find the first half of the flag with this XOR code from python:\u003c\/p\u003e","inLanguage":"en","url":"https:\/\/mtasecurity.github.io\/MSEC\/re\/1761315247629-re\/","author":{"@type":"Person","name":""},"mainEntityOfPage":"true","wordCount":"2330"}]</script></head><body class="flex flex-col h-screen m-auto leading-7 max-w-7xl px-6 sm:px-14 md:px-24 lg:px-32 text-lg bg-neutral text-neutral-900 dark:bg-neutral-800 dark:text-neutral scrollbar-thin scrollbar-track-neutral-200 scrollbar-thumb-neutral-400 dark:scrollbar-track-neutral-800 dark:scrollbar-thumb-neutral-600"><div id=the-top class="absolute flex self-center"><a class="px-3 py-1 text-sm -translate-y-8 rounded-b-lg bg-primary-200 focus:translate-y-0 dark:bg-neutral-600" href=#main-content><span class="font-bold text-primary-600 pe-2 dark:text-primary-400">&darr;</span>
Skip to main content</a></div><div class=min-h-[148px]></div><div class="fixed inset-x-0 z-100"><div id=menu-blur class="absolute opacity-0 inset-x-0 top-0 h-full single_hero_background nozoom backdrop-blur-2xl shadow-2xl"></div><div class="relative m-auto leading-7 max-w-7xl px-6 sm:px-14 md:px-24 lg:px-32"><div class="main-menu flex items-center justify-between py-6 md:justify-start gap-x-3 pt-[2px] pr-2 md:pr-4 pb-[3px] pl-0"><div><a href=/MSEC/ class=flex><span class=sr-only>MSEC</span>
<img src=/MSEC/ee.png width=250 height=250 class="logo max-h-[5rem] max-w-[5rem] object-scale-down object-left nozoom" alt></a></div><div class="flex flex-1 items-center justify-between"><nav class="flex space-x-3"><a href=/MSEC/ class="text-base font-medium">MSEC</a></nav><nav class="hidden md:flex items-center gap-x-5 md:ml-12 h-12"><a href=/MSEC/crypto/ class="flex items-center hover:text-primary-600 dark:hover:text-primary-400" aria-label=CRYPTO title=CRYPTOs><span class=mr-1><span class="relative block icon"><svg viewBox="0 0 512 512"><path fill="currentColor" d="M502.285 159.704l-234-156c-7.987-4.915-16.511-4.96-24.571.0l-234 156C3.714 163.703.0 170.847.0 177.989v155.999c0 7.143 3.714 14.286 9.715 18.286l234 156.022c7.987 4.915 16.511 4.96 24.571.0l234-156.022c6-3.999 9.715-11.143 9.715-18.286V177.989c-.001-7.142-3.715-14.286-9.716-18.285zM278 63.131l172.286 114.858-76.857 51.429L278 165.703V63.131zm-44 0v102.572l-95.429 63.715-76.857-51.429L234 63.131zM44 219.132l55.143 36.857L44 292.846v-73.714zm190 229.715L61.714 333.989l76.857-51.429L234 346.275v102.572zm22-140.858-77.715-52 77.715-52 77.715 52-77.715 52zm22 140.858V346.275l95.429-63.715 76.857 51.429L278 448.847zm190-156.001-55.143-36.857L468 219.132v73.714z"/></svg></span></span><p class="text-base font-medium">CRYPTO</p></a><a href=/MSEC/for/ class="flex items-center hover:text-primary-600 dark:hover:text-primary-400" aria-label=FOR title=FORs><span class=mr-1><span class="relative block icon"><svg viewBox="0 0 512 512"><path fill="currentColor" d="M48 64C21.5 64 0 85.5.0 112c0 15.1 7.1 29.3 19.2 38.4L236.8 313.6c11.4 8.5 27 8.5 38.4.0L492.8 150.4c12.1-9.1 19.2-23.3 19.2-38.4.0-26.5-21.5-48-48-48H48zM0 176V384c0 35.3 28.7 64 64 64H448c35.3.0 64-28.7 64-64V176L294.4 339.2c-22.8 17.1-54 17.1-76.8.0L0 176z"/></svg></span></span><p class="text-base font-medium">FOR</p></a><a href=/MSEC/pwn/ class="flex items-center hover:text-primary-600 dark:hover:text-primary-400" aria-label=PWN title=PWNs><span class=mr-1><span class="relative block icon"><svg viewBox="0 0 512 512"><path fill="currentColor" d="M256 8C119.252 8 8 119.252 8 256s111.252 248 248 248 248-111.252 248-248S392.748 8 256 8zm163.97 114.366c29.503 36.046 47.369 81.957 47.835 131.955-6.984-1.477-77.018-15.682-147.502-6.818-5.752-14.041-11.181-26.393-18.617-41.614 78.321-31.977 113.818-77.482 118.284-83.523zM396.421 97.87c-3.81 5.427-35.697 48.286-111.021 76.519-34.712-63.776-73.185-116.168-79.04-124.008 67.176-16.193 137.966 1.27 190.061 47.489zm-230.48-33.25c5.585 7.659 43.438 60.116 78.537 122.509-99.087 26.313-186.36 25.934-195.834 25.809C62.38 147.205 106.678 92.573 165.941 64.62zM44.17 256.323c0-2.166.043-4.322.108-6.473 9.268.19 111.92 1.513 217.706-30.146 6.064 11.868 11.857 23.915 17.174 35.949-76.599 21.575-146.194 83.527-180.531 142.306C64.794 360.405 44.17 310.73 44.17 256.323zm81.807 167.113c22.127-45.233 82.178-103.622 167.579-132.756 29.74 77.283 42.039 142.053 45.189 160.638-68.112 29.013-150.015 21.053-212.768-27.882zm248.38 8.489c-2.171-12.886-13.446-74.897-41.152-151.033 66.38-10.626 124.7 6.768 131.947 9.055-9.442 58.941-43.273 109.844-90.795 141.978z"/></svg></span></span><p class="text-base font-medium">PWN</p></a><a href=/MSEC/re/ class="flex items-center hover:text-primary-600 dark:hover:text-primary-400" aria-label=RE title=REs><p class="text-base font-medium">RE</p></a><a href=/MSEC/web/ class="flex items-center hover:text-primary-600 dark:hover:text-primary-400" aria-label=WEB title=WEBs><span class=mr-1><span class="relative block icon"><svg viewBox="0 0 512 512"><path fill="currentColor" d="M256 232.562c-21.183-41.196-78.868-117.97-132.503-155.834-51.378-36.272-70.978-29.987-83.828-24.181-14.872 6.72-17.577 29.554-17.577 42.988.0 13.433 7.365 110.138 12.169 126.281 15.873 53.336 72.376 71.358 124.413 65.574 2.66-.395 5.357-.759 8.089-1.097-2.68.429-5.379.796-8.089 1.097-76.259 11.294-143.984 39.085-55.158 137.972C201.224 526.527 237.424 403.67 256 341.379c18.576 62.291 39.972 180.718 150.734 83.983 83.174-83.983 22.851-126.674-53.408-137.969-2.71-.302-5.409-.667-8.089-1.096 2.732.337 5.429.702 8.089 1.096 52.037 5.785 108.54-12.239 124.413-65.574 4.804-16.142 12.169-112.847 12.169-126.281.0-13.434-2.705-36.267-17.577-42.988-12.85-5.806-32.45-12.09-83.829 24.181C334.868 114.595 277.183 191.366 256 232.562z"/></svg></span></span><p class="text-base font-medium">WEB</p></a><a href class="flex items-center hover:text-primary-600 dark:hover:text-primary-400" title></a><button id=search-button aria-label=Search class="text-base hover:text-primary-600 dark:hover:text-primary-400" title="Search (/)">
<span class="relative block icon"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7 405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9.0 208 0S0 93.1.0 208s93.1 208 208 208c48.3.0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9.0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7.0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7.0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg></span></button><div class="flex items-center"><button id=appearance-switcher aria-label="Dark mode switcher" type=button class="text-base hover:text-primary-600 dark:hover:text-primary-400"><div class="flex items-center justify-center dark:hidden"><span class="relative block icon"><svg viewBox="0 0 512 512"><path fill="currentColor" d="M32 256C32 132.2 132.3 32 255.8 32c11.36.0 29.7 1.668 40.9 3.746 9.616 1.777 11.75 14.63 3.279 19.44C245 86.5 211.2 144.6 211.2 207.8c0 109.7 99.71 193 208.3 172.3 9.561-1.805 16.28 9.324 10.11 16.95C387.9 448.6 324.8 480 255.8 480 132.1 480 32 379.6 32 256z"/></svg></span></div><div class="items-center justify-center hidden dark:flex"><span class="relative block icon"><svg viewBox="0 0 512 512"><path fill="currentColor" d="M256 159.1c-53.02.0-95.1 42.98-95.1 95.1s41.2 96.9 95.1 96.9 95.1-42.98 95.1-95.1S309 159.1 256 159.1zM509.3 347l-63.2-91.9 63.15-91.01c6.332-9.125 1.104-21.74-9.826-23.72l-109-19.7-19.7-109c-1.975-10.93-14.59-16.16-23.72-9.824L256 65.89 164.1 2.736c-9.125-6.332-21.74-1.107-23.72 9.824L121.6 121.6 12.56 141.3C1.633 143.2-3.596 155.9 2.736 164.1L65.89 256 2.74 347.01c-6.332 9.125-1.105 21.74 9.824 23.72l109 19.7 19.7 109c1.975 10.93 14.59 16.16 23.72 9.824L256 446.1l91.01 63.15c9.127 6.334 21.75 1.107 23.72-9.822l19.7-109 109-19.7C510.4 368.8 515.6 356.1 509.3 347zM256 383.1c-70.69.0-127.1-57.31-127.1-127.1.0-70.69 57.31-127.1 127.1-127.1S383.1 186.2 383.1 256c0 70.7-56.4 127.1-127.1 127.1z"/></svg></span></div></button></div></nav><div class="flex md:hidden items-center gap-x-5 md:ml-12 h-12"><span></span>
<button id=search-button-mobile aria-label=Search class="text-base hover:text-primary-600 dark:hover:text-primary-400" title="Search (/)">
<span class="relative block icon"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7 405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9.0 208 0S0 93.1.0 208s93.1 208 208 208c48.3.0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9.0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7.0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7.0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg>
</span></button>
<button id=appearance-switcher-mobile aria-label="Dark mode switcher" type=button class="text-base hover:text-primary-600 dark:hover:text-primary-400 me-1"><div class="flex items-center justify-center dark:hidden"><span class="relative block icon"><svg viewBox="0 0 512 512"><path fill="currentColor" d="M32 256C32 132.2 132.3 32 255.8 32c11.36.0 29.7 1.668 40.9 3.746 9.616 1.777 11.75 14.63 3.279 19.44C245 86.5 211.2 144.6 211.2 207.8c0 109.7 99.71 193 208.3 172.3 9.561-1.805 16.28 9.324 10.11 16.95C387.9 448.6 324.8 480 255.8 480 132.1 480 32 379.6 32 256z"/></svg></span></div><div class="items-center justify-center hidden dark:flex"><span class="relative block icon"><svg viewBox="0 0 512 512"><path fill="currentColor" d="M256 159.1c-53.02.0-95.1 42.98-95.1 95.1s41.2 96.9 95.1 96.9 95.1-42.98 95.1-95.1S309 159.1 256 159.1zM509.3 347l-63.2-91.9 63.15-91.01c6.332-9.125 1.104-21.74-9.826-23.72l-109-19.7-19.7-109c-1.975-10.93-14.59-16.16-23.72-9.824L256 65.89 164.1 2.736c-9.125-6.332-21.74-1.107-23.72 9.824L121.6 121.6 12.56 141.3C1.633 143.2-3.596 155.9 2.736 164.1L65.89 256 2.74 347.01c-6.332 9.125-1.105 21.74 9.824 23.72l109 19.7 19.7 109c1.975 10.93 14.59 16.16 23.72 9.824L256 446.1l91.01 63.15c9.127 6.334 21.75 1.107 23.72-9.822l19.7-109 109-19.7C510.4 368.8 515.6 356.1 509.3 347zM256 383.1c-70.69.0-127.1-57.31-127.1-127.1.0-70.69 57.31-127.1 127.1-127.1S383.1 186.2 383.1 256c0 70.7-56.4 127.1-127.1 127.1z"/></svg></span></div></button></div></div><div class="-my-2 md:hidden"><div id=menu-button class=block><div class="cursor-pointer hover:text-primary-600 dark:hover:text-primary-400"><span class="relative block icon"><svg viewBox="0 0 448 512"><path fill="currentColor" d="M0 96C0 78.33 14.33 64 32 64H416c17.7.0 32 14.33 32 32 0 17.7-14.3 32-32 32H32C14.33 128 0 113.7.0 96zM0 256c0-17.7 14.33-32 32-32H416c17.7.0 32 14.3 32 32s-14.3 32-32 32H32c-17.67.0-32-14.3-32-32zM416 448H32c-17.67.0-32-14.3-32-32s14.33-32 32-32H416c17.7.0 32 14.3 32 32s-14.3 32-32 32z"/></svg></span></div><div id=menu-wrapper class="fixed inset-0 z-30 invisible w-screen h-screen m-0 overflow-auto transition-opacity opacity-0 cursor-default bg-neutral-100/50 backdrop-blur-sm dark:bg-neutral-900/50 pt-[5px]"><ul class="flex space-y-2 mt-3 flex-col items-end w-full px-6 py-6 mx-auto overflow-visible list-none text-end max-w-7xl"><li id=menu-close-button><span class="cursor-pointer inline-block align-text-bottom hover:text-primary-600 dark:hover:text-primary-400"><span class="relative block icon"><svg viewBox="0 0 320 512"><path fill="currentColor" d="M310.6 361.4c12.5 12.5 12.5 32.75.0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3 54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75.0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75.0-45.25s32.75-12.5 45.25.0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25.0s12.5 32.75.0 45.25l-105.4 105.4L310.6 361.4z"/></svg></span></span></li><li class=mt-1><a href=/MSEC/crypto/ class="flex items-center hover:text-primary-600 dark:hover:text-primary-400" aria-label=CRYPTO title=CRYPTOs><div class=mr-2><span class="relative block icon"><svg viewBox="0 0 512 512"><path fill="currentColor" d="M502.285 159.704l-234-156c-7.987-4.915-16.511-4.96-24.571.0l-234 156C3.714 163.703.0 170.847.0 177.989v155.999c0 7.143 3.714 14.286 9.715 18.286l234 156.022c7.987 4.915 16.511 4.96 24.571.0l234-156.022c6-3.999 9.715-11.143 9.715-18.286V177.989c-.001-7.142-3.715-14.286-9.716-18.285zM278 63.131l172.286 114.858-76.857 51.429L278 165.703V63.131zm-44 0v102.572l-95.429 63.715-76.857-51.429L234 63.131zM44 219.132l55.143 36.857L44 292.846v-73.714zm190 229.715L61.714 333.989l76.857-51.429L234 346.275v102.572zm22-140.858-77.715-52 77.715-52 77.715 52-77.715 52zm22 140.858V346.275l95.429-63.715 76.857 51.429L278 448.847zm190-156.001-55.143-36.857L468 219.132v73.714z"/></svg></span></div><p class="text-bg font-bg">CRYPTO</p></a></li><li class=mt-1><a href=/MSEC/for/ class="flex items-center hover:text-primary-600 dark:hover:text-primary-400" aria-label=FOR title=FORs><div class=mr-2><span class="relative block icon"><svg viewBox="0 0 512 512"><path fill="currentColor" d="M48 64C21.5 64 0 85.5.0 112c0 15.1 7.1 29.3 19.2 38.4L236.8 313.6c11.4 8.5 27 8.5 38.4.0L492.8 150.4c12.1-9.1 19.2-23.3 19.2-38.4.0-26.5-21.5-48-48-48H48zM0 176V384c0 35.3 28.7 64 64 64H448c35.3.0 64-28.7 64-64V176L294.4 339.2c-22.8 17.1-54 17.1-76.8.0L0 176z"/></svg></span></div><p class="text-bg font-bg">FOR</p></a></li><li class=mt-1><a href=/MSEC/pwn/ class="flex items-center hover:text-primary-600 dark:hover:text-primary-400" aria-label=PWN title=PWNs><div class=mr-2><span class="relative block icon"><svg viewBox="0 0 512 512"><path fill="currentColor" d="M256 8C119.252 8 8 119.252 8 256s111.252 248 248 248 248-111.252 248-248S392.748 8 256 8zm163.97 114.366c29.503 36.046 47.369 81.957 47.835 131.955-6.984-1.477-77.018-15.682-147.502-6.818-5.752-14.041-11.181-26.393-18.617-41.614 78.321-31.977 113.818-77.482 118.284-83.523zM396.421 97.87c-3.81 5.427-35.697 48.286-111.021 76.519-34.712-63.776-73.185-116.168-79.04-124.008 67.176-16.193 137.966 1.27 190.061 47.489zm-230.48-33.25c5.585 7.659 43.438 60.116 78.537 122.509-99.087 26.313-186.36 25.934-195.834 25.809C62.38 147.205 106.678 92.573 165.941 64.62zM44.17 256.323c0-2.166.043-4.322.108-6.473 9.268.19 111.92 1.513 217.706-30.146 6.064 11.868 11.857 23.915 17.174 35.949-76.599 21.575-146.194 83.527-180.531 142.306C64.794 360.405 44.17 310.73 44.17 256.323zm81.807 167.113c22.127-45.233 82.178-103.622 167.579-132.756 29.74 77.283 42.039 142.053 45.189 160.638-68.112 29.013-150.015 21.053-212.768-27.882zm248.38 8.489c-2.171-12.886-13.446-74.897-41.152-151.033 66.38-10.626 124.7 6.768 131.947 9.055-9.442 58.941-43.273 109.844-90.795 141.978z"/></svg></span></div><p class="text-bg font-bg">PWN</p></a></li><li class=mt-1><a href=/MSEC/re/ class="flex items-center hover:text-primary-600 dark:hover:text-primary-400" aria-label=RE title=REs><p class="text-bg font-bg">RE</p></a></li><li class=mt-1><a href=/MSEC/web/ class="flex items-center hover:text-primary-600 dark:hover:text-primary-400" aria-label=WEB title=WEBs><div class=mr-2><span class="relative block icon"><svg viewBox="0 0 512 512"><path fill="currentColor" d="M256 232.562c-21.183-41.196-78.868-117.97-132.503-155.834-51.378-36.272-70.978-29.987-83.828-24.181-14.872 6.72-17.577 29.554-17.577 42.988.0 13.433 7.365 110.138 12.169 126.281 15.873 53.336 72.376 71.358 124.413 65.574 2.66-.395 5.357-.759 8.089-1.097-2.68.429-5.379.796-8.089 1.097-76.259 11.294-143.984 39.085-55.158 137.972C201.224 526.527 237.424 403.67 256 341.379c18.576 62.291 39.972 180.718 150.734 83.983 83.174-83.983 22.851-126.674-53.408-137.969-2.71-.302-5.409-.667-8.089-1.096 2.732.337 5.429.702 8.089 1.096 52.037 5.785 108.54-12.239 124.413-65.574 4.804-16.142 12.169-112.847 12.169-126.281.0-13.434-2.705-36.267-17.577-42.988-12.85-5.806-32.45-12.09-83.829 24.181C334.868 114.595 277.183 191.366 256 232.562z"/></svg></span></div><p class="text-bg font-bg">WEB</p></a></li><li class=mt-1><a href class="flex items-center hover:text-primary-600 dark:hover:text-primary-400" title></a></li></ul></div></div></div></div></div></div><script type=text/javascript src=/MSEC/js/background-blur.min.00a57c73ea12f2cab2980c3c3d649e89f6d82f190f74bbe2b67f2f5e39ab7d032ece47086400ca05396758aace13299da49aca43ea643d2625e62c506267a169.js integrity="sha512-AKV8c+oS8sqymAw8PWSeifbYLxkPdLvitn8vXjmrfQMuzkcIZADKBTlnWKrOEymdpJrKQ+pkPSYl5ixQYmehaQ==" data-blur-id=menu-blur></script><div class="relative flex flex-col grow"><main id=main-content class=grow><article><header id=single_header class="mt-5 max-w-prose"><h1 class="mt-0 text-4xl font-extrabold text-neutral-900 dark:text-neutral">Write-up for Reverse Master CSCV2025</h1><div class="mt-1 mb-6 text-base text-neutral-500 dark:text-neutral-400 print:hidden"><div class="flex flex-row flex-wrap items-center"><time datetime=0001-01-01T00:00:00+00:00>1 January 0001</time><span class="px-2 text-primary-500">&#183;</span><span>2330 words</span><span class="px-2 text-primary-500">&#183;</span><span title="Reading time">11 mins</span></div></div><div class="flex author"><div class=place-self-center><div class="text-2xl sm:text-lg"></div></div></div><div class=mb-5></div></header><section class="flex flex-col max-w-full mt-0 prose dark:prose-invert lg:flex-row"><div class="min-w-0 min-h-0 max-w-fit"><div class="article-content max-w-prose mb-20"><p>Hello everyone🫡! Today I will write a little bit about The <em><strong>Reverse Master</strong></em> challenge in CSCV2025.
The question:<figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=low alt=image src=https://hackmd.io/_uploads/B1vSBTNAee.png></figure></p><p>When we install the file we will have an apk file like this:<figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=low alt=image src=https://hackmd.io/_uploads/Bk60raNReg.png></figure>Use <strong>jadx-gui</strong> to decompile this file,then open <strong>Source code/com/ctf.challenge</strong> and you will see <strong>Main Activity</strong> like this:<figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=low alt=image src=https://hackmd.io/_uploads/BJ7-D6NRlx.png></figure>Open that and you will see the code below:</p><pre tabindex=0><code>package com.ctf.challenge;

import android.graphics.Color;
import android.os.Bundle;
import android.util.Log;
import android.view.View;
import android.view.ViewGroup;
import android.widget.Button;
import android.widget.LinearLayout;
import android.widget.TextView;
import androidx.appcompat.app.AppCompatActivity;
import com.google.android.material.textfield.TextInputEditText;
import com.google.android.material.textfield.TextInputLayout;
import java.io.BufferedReader;
import java.io.File;
import java.io.IOException;
import java.io.InputStreamReader;
import java.net.InetSocketAddress;
import java.net.Socket;
import o.CountDownTimerC0176z3;
import o.F2;
import o.F3;
import o.RunnableC0154w;
import o.V4;

/* loaded from: classes.dex */
public final class MainActivity extends AppCompatActivity {
    public static final /* synthetic */ int b = 0;
    public final byte[] a = {66, 51, 122, 33, 86};

    static {
        try {
            System.loadLibrary(&#34;native-lib&#34;);
        } catch (UnsatisfiedLinkError e) {
            Log.e(&#34;CTF&#34;, &#34;❌ Native lib failed: &#34; + e.getMessage());
        }
    }

    public final native boolean checkSecondHalf(String str);

    public final native String getHint();

    public final void h(LinearLayout linearLayout, String str, String str2) {
        View viewInflate = getLayoutInflater().inflate(android.R.layout.simple_list_item_2, (ViewGroup) linearLayout, false);
        TextView textView = (TextView) viewInflate.findViewById(android.R.id.text1);
        TextView textView2 = (TextView) viewInflate.findViewById(android.R.id.text2);
        textView.setText(&#34;⚠️ &#34;.concat(str));
        textView.setTextColor(Color.parseColor(&#34;#FF5252&#34;));
        textView.setTextSize(16.0f);
        textView.setTypeface(null, 1);
        textView2.setText(str2);
        textView2.setTextColor(Color.parseColor(&#34;#BDBDBD&#34;));
        textView2.setTextSize(13.0f);
        linearLayout.addView(viewInflate);
    }

    @Override // androidx.fragment.app.FragmentActivity, androidx.activity.ComponentActivity, androidx.core.app.ComponentActivity, android.app.Activity
    public final void onCreate(Bundle bundle) throws IOException {
        boolean z;
        String line;
        super.onCreate(bundle);
        setContentView(R.layout.activity_main);
        boolean z2 = false;
        boolean z3 = (getApplicationInfo().flags &amp; 2) != 0;
        String[] strArr = {&#34;/system/app/Superuser.apk&#34;, &#34;/sbin/su&#34;, &#34;/system/bin/su&#34;, &#34;/system/xbin/su&#34;, &#34;/data/local/xbin/su&#34;, &#34;/data/local/bin/su&#34;, &#34;/system/sd/xbin/su&#34;, &#34;/system/bin/failsafe/su&#34;, &#34;/data/local/su&#34;};
        int i = 0;
        while (true) {
            if (i &gt;= 9) {
                try {
                    Runtime.getRuntime().exec(&#34;su&#34;);
                    break;
                } catch (Exception unused) {
                    z = false;
                }
            } else if (new File(strArr[i]).exists()) {
                break;
            } else {
                i++;
            }
        }
        z = true;
        try {
            BufferedReader bufferedReader = new BufferedReader(new InputStreamReader(Runtime.getRuntime().exec(&#34;ps&#34;).getInputStream()));
            do {
                line = bufferedReader.readLine();
                if (line == null) {
                    break;
                } else if (!V4.u(line, &#34;frida&#34;) &amp;&amp; !V4.u(line, &#34;gum-js-loop&#34;)) {
                }
            } while (!V4.u(line, &#34;gmain&#34;));
            z2 = true;
            bufferedReader.close();
        } catch (Exception unused2) {
        }
        int i2 = 27042;
        while (true) {
            if (i2 &gt;= 27053) {
                break;
            }
            try {
                Socket socket = new Socket();
                socket.connect(new InetSocketAddress(&#34;127.0.0.1&#34;, i2), 100);
                socket.close();
                z2 = true;
                break;
            } catch (Exception unused3) {
                i2++;
            }
        }
        if (!z3 &amp;&amp; !z &amp;&amp; !z2) {
            Thread thread = new Thread(new RunnableC0154w(8, this));
            thread.setDaemon(true);
            thread.start();
            final TextInputLayout textInputLayout = (TextInputLayout) findViewById(R.id.flagInputLayout);
            final TextInputEditText textInputEditText = (TextInputEditText) findViewById(R.id.flagInput);
            Button button = (Button) findViewById(R.id.checkButton);
            Button button2 = (Button) findViewById(R.id.hintButton);
            button.setOnClickListener(new View.OnClickListener() { // from class: o.y3
                /* JADX WARN: Removed duplicated region for block: B:4:0x001a  */
                @Override // android.view.View.OnClickListener
                /*
                    Code decompiled incorrectly, please refer to instructions dump.
                    To view partially-correct code enable &#39;Show inconsistent code&#39; option in preferences
                */
                public final void onClick(android.view.View r13) {
                    /*
                        r12 = this;
                        r13 = 16
                        r0 = 1
                        int r1 = com.ctf.challenge.MainActivity.b
                        com.google.android.material.textfield.TextInputEditText r1 = r1
                        android.text.Editable r1 = r1.getText()
                        java.lang.String r1 = java.lang.String.valueOf(r1)
                        com.ctf.challenge.MainActivity r2 = r2
                        java.lang.String r3 = &#34;CSCV2025{&#34;
                        boolean r3 = r1.startsWith(r3)
                        r4 = 0
                        if (r3 != 0) goto L1c
                    L1a:
                        r13 = r4
                        goto L6e
                    L1c:
                        java.lang.String r3 = &#34;}&#34;
                        boolean r3 = r1.endsWith(r3)
                        if (r3 != 0) goto L25
                        goto L1a
                    L25:
                        int r3 = r1.length()
                        int r3 = r3 - r0
                        r5 = 9
                        java.lang.String r1 = r1.substring(r5, r3)
                        java.lang.String r3 = &#34;substring(...)&#34;
                        o.F2.e(r1, r3)
                        java.lang.String r5 = r1.substring(r4, r13)
                        o.F2.e(r5, r3)
                        byte[] r6 = new byte[r13]
                        r6 = {x0090: FILL_ARRAY_DATA , data: [122, 86, 27, 22, 53, 35, 80, 77, 24, 98, 122, 7, 72, 21, 98, 114} // fill-array
                        byte[] r7 = new byte[r13]
                        r8 = r4
                    L44:
                        if (r8 &gt;= r13) goto L55
                        r9 = r6[r8]
                        byte[] r10 = r2.a
                        int r11 = r10.length
                        int r11 = r8 % r11
                        r10 = r10[r11]
                        r9 = r9 ^ r10
                        byte r9 = (byte) r9
                        r7[r8] = r9
                        int r8 = r8 + r0
                        goto L44
                    L55:
                        java.lang.String r6 = new java.lang.String
                        java.nio.charset.Charset r8 = o.X.a
                        r6.&lt;init&gt;(r7, r8)
                        boolean r5 = r5.equals(r6)
                        if (r5 != 0) goto L63
                        goto L1a
                    L63:
                        java.lang.String r13 = r1.substring(r13)
                        o.F2.e(r13, r3)
                        boolean r13 = r2.checkSecondHalf(r13)
                    L6e:
                        com.google.android.material.textfield.TextInputLayout r1 = r3
                        if (r13 == 0) goto L80
                        java.lang.String r13 = &#34;🎉 Correct! Flag is valid!&#34;
                        android.widget.Toast r13 = android.widget.Toast.makeText(r2, r13, r0)
                        r13.show()
                        r13 = 0
                        r1.setError(r13)
                        return
                    L80:
                        java.lang.String r13 = &#34;❌ Wrong flag! Try again!&#34;
                        android.widget.Toast r13 = android.widget.Toast.makeText(r2, r13, r4)
                        r13.show()
                        java.lang.String r13 = &#34;Invalid flag&#34;
                        r1.setError(r13)
                        return
                    */
                    throw new UnsupportedOperationException(&#34;Method not decompiled: o.ViewOnClickListenerC0170y3.onClick(android.view.View):void&#34;);
                }
            });
            button2.setOnClickListener(new F3(3, this));
            return;
        }
        setContentView(R.layout.security_warning);
        TextView textView = (TextView) findViewById(R.id.countdownText);
        LinearLayout linearLayout = (LinearLayout) findViewById(R.id.issuesList);
        if (z3) {
            F2.c(linearLayout);
            h(linearLayout, &#34;Debug Mode Detected&#34;, &#34;Application is running in debuggable mode&#34;);
        }
        if (z) {
            F2.c(linearLayout);
            h(linearLayout, &#34;Root Access Detected&#34;, &#34;Device has been rooted or jailbroken&#34;);
        }
        if (z2) {
            F2.c(linearLayout);
            h(linearLayout, &#34;Frida Framework Detected&#34;, &#34;Dynamic instrumentation tool is running&#34;);
        }
        new CountDownTimerC0176z3(textView, this).start();
    }

    public final native void startFridaMonitoring();
}
</code></pre><p>You can find the first half of the flag with this XOR code from python:</p><pre tabindex=0><code>byte[] encrypted = {
  122, 86, 27, 22, 53, 35, 80, 77,
  24, 98, 122, 7, 72, 21, 98, 114
};
byte[] key = {66, 51, 122, 33, 86};

for (int i = 0; i &lt; 16; i++) {
    decrypted[i] = encrypted[i] ^ key[i % key.length];
}
String expected = new String(decrypted, Charset.UTF_8);
return input.equals(expected);
</code></pre><p>The output is:</p><pre tabindex=0><code>8ea7cac794842440
</code></pre><p>To find out the second half of the flag, we&rsquo;ll disassemble and analyze the native code to reverse the logic inside checkSecondHalf from <strong>libnative-lib.so</strong>
Let use <strong>apktool</strong> command in terminal to extract <strong>libnative-lib.so</strong> from the apk file:</p><pre tabindex=0><code>apktool d -f reverse-master.apk -o reverse-master_src
</code></pre><p><figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=low alt=image src=https://hackmd.io/_uploads/r1s7bAVAle.png></figure></p><p>A new folder named <strong>reverse-master_src</strong> will appear in the same path you use Terminal. Check that out and find <strong>libnative-lib.so</strong> in the lib folder<figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=low alt=image src=https://hackmd.io/_uploads/B1tjbRERxl.png></figure>Let open this file in <strong>ghidra</strong> and find the <strong>Java_com_ctf_challenge_MainActivity_checkSecondHalf</strong> function:</p><pre tabindex=0><code>bool Java_com_ctf_challenge_MainActivity_checkSecondHalf
               (long *param_1,undefined8 param_2,undefined8 param_3)

{
  int iVar1;
  int iVar2;
  int iVar3;
  ulong uVar4;
  char *__s;
  size_t sVar5;
  
  uVar4 = FUN_00119ca0();
  if ((uVar4 &amp; 1) != 0) {
    __android_log_print(4,&#34;Lib-Native&#34;,&#34;Debugger detected in native code!&#34;);
    return false;
  }
  __s = (char *)(**(code **)(*param_1 + 0x548))(param_1,param_3,0);
  if (__s != (char *)0x0) {
    sVar5 = strlen(__s);
    iVar1 = rand();
    iVar1 = iVar1 % 0x32 + 1;
    iVar2 = rand();
    iVar2 = iVar2 % 0x32 + 1;
    if (iVar1 * iVar1 + iVar2 * iVar2 == (iVar2 + iVar1) * (iVar2 + iVar1) + iVar1 * iVar2 * -2 + 1)
    {
      FUN_0011ac60(__s);
      FUN_0011accc();
    }
    iVar1 = rand();
    iVar1 = iVar1 % 100;
    iVar2 = rand();
    iVar2 = iVar2 % 100;
    if ((iVar2 + iVar1) * (iVar2 + iVar1) &lt; iVar1 * iVar1 + iVar2 * iVar2) {
      iVar3 = 0;
    }
    else {
      iVar3 = FUN_0011ad68(__s,sVar5 &amp; 0xffffffff);
      iVar1 = rand();
      iVar1 = iVar1 % 0x32 + 1;
      iVar2 = rand();
      iVar2 = iVar2 % 0x32 + 1;
      if (iVar1 * iVar1 + iVar2 * iVar2 ==
          (iVar2 + iVar1) * (iVar2 + iVar1) + iVar1 * iVar2 * -2 + 1) {
        FUN_0011b5e8(__s);
        FUN_0011b658();
      }
    }
    (**(code **)(*param_1 + 0x550))(param_1,param_3,__s);
    if (iVar3 != 0) {
      iVar1 = rand();
      iVar1 = iVar1 % 100;
      iVar2 = rand();
      iVar2 = iVar2 % 100;
      if (iVar1 * iVar1 + iVar2 * iVar2 &lt;= (iVar2 + iVar1) * (iVar2 + iVar1)) {
        return true;
      }
    }
    iVar1 = rand();
    iVar1 = iVar1 % 0x32 + 1;
    iVar2 = rand();
    iVar2 = iVar2 % 0x32 + 1;
    return iVar1 * iVar1 + iVar2 * iVar2 ==
           (iVar2 + iVar1) * (iVar2 + iVar1) + iVar1 * iVar2 * -2 + 1;
  }
  rand();
  rand();
  return false;
}
</code></pre><p>Let chatGPT analyze this:<figure><img class="my-0 rounded-md" loading=lazy decoding=async fetchpriority=low alt=image src=https://hackmd.io/_uploads/S1gEWJHCxe.png></figure>So let go to <strong>FUN_0011ad68</strong> to see what inside this:</p><pre tabindex=0><code>
undefined4 FUN_0011ad68(byte *param_1,int param_2)

{
  byte bVar1;
  byte bVar2;
  byte bVar3;
  byte bVar4;
  byte bVar5;
  undefined1 auVar6 [16];
  undefined8 uVar7;
  uint5 uVar8;
  int iVar9;
  int iVar10;
  byte *pbVar11;
  uint5 *puVar12;
  uint uVar13;
  byte bVar14;
  byte bVar15;
  byte bVar16;
  byte bVar17;
  byte bVar18;
  undefined4 local_90;
  
  pbVar11 = (byte *)calloc(0x10,1);
  uVar13 = 0x1a2b;
  bVar18 = 0;
  local_90 = 0;
  do {
    if (uVar13 &lt; 0x7a8b) {
      if (uVar13 == 0x1a2b) {
        iVar9 = rand();
        iVar9 = iVar9 % 100;
        iVar10 = rand();
        iVar10 = iVar10 % 100;
        uVar13 = 0xbecf;
        if (iVar9 * iVar9 + iVar10 * iVar10 &lt;= (iVar10 + iVar9) * (iVar10 + iVar9)) {
          uVar13 = 0x3c4d;
        }
      }
      else if (uVar13 == 0x3c4d) {
        if (param_2 != 0x10) goto LAB_0011b004;
        iVar9 = rand();
        iVar9 = iVar9 % 0x32 + 1;
        iVar10 = rand();
        iVar10 = iVar10 % 0x32 + 1;
        uVar13 = 0xbecf;
        if (iVar9 * iVar9 + iVar10 * iVar10 !=
            (iVar10 + iVar9) * (iVar10 + iVar9) + iVar9 * iVar10 * -2 + 1) {
          uVar13 = 0x5e6f;
        }
      }
      else {
        if (uVar13 != 0x5e6f) goto LAB_0011b538;
        puVar12 = (uint5 *)calloc(5,1);
        if (puVar12 == (uint5 *)0x0) {
          bVar14 = 0;
          bVar18 = 0;
          bVar16 = 0;
          bVar17 = 0;
          bVar15 = 0;
        }
        else {
          bVar14 = 99;
          bVar15 = 0x7d;
          bVar17 = 0xe2;
          bVar16 = 0x14;
          bVar18 = 0xb8;
          *(undefined4 *)puVar12 = 0xb814e27d;
          *(byte *)((long)puVar12 + 4) = 99;
        }
        bVar1 = *(byte *)((long)puVar12 + 1);
        bVar2 = (byte)*puVar12;
        bVar3 = *(byte *)((long)puVar12 + 2);
        bVar4 = *(byte *)((long)puVar12 + 3);
        bVar5 = *(byte *)((long)puVar12 + 4);
        uVar8 = *puVar12;
        pbVar11[1] = (bVar17 ^ 0x6c) - 10 ^ bVar1;
        *pbVar11 = (bVar15 ^ 0x2f) - 7 ^ bVar2;
        pbVar11[2] = ((bVar16 | 1) ^ 0x95) - 0xd ^ bVar3 ^ 2;
        pbVar11[0xd] = (bVar18 ^ 8) - 0x2e ^ bVar4 ^ 0xd;
        pbVar11[4] = (bVar14 ^ 0x74) - 0x13 ^ bVar5 ^ 4;
        pbVar11[0xf] = (bVar15 ^ 7) - 0x34 ^ bVar2 ^ 0xf;
        pbVar11[0x10] = 0;
        pbVar11[3] = ((bVar18 | 2) ^ 0x21) - 0x10 ^ bVar4;
        pbVar11[0xe] = (bVar14 ^ 0x5a) - 0x31 ^ bVar5 ^ 0xe;
        auVar6._5_3_ = 0;
        auVar6._0_5_ = uVar8;
        auVar6[8] = bVar2;
        auVar6[9] = bVar1;
        auVar6[10] = bVar3;
        auVar6[0xb] = bVar4;
        auVar6[0xc] = bVar5;
        auVar6._13_3_ = 0;
        uVar7 = a64_TBL(ZEXT816(0),auVar6,0x201000403020100);
        bVar18 = ((bVar18 | 7) ^ 0x4d) - 0x1f ^ 8 ^ (byte)((ulong)uVar7 &gt;&gt; 0x18);
        *(ulong *)(pbVar11 + 5) =
             CONCAT17(((bVar16 | 0xb) ^ 0x53) - 0x2b ^ 0xc ^ (byte)((ulong)uVar7 &gt;&gt; 0x38),
                      CONCAT16((bVar17 ^ 0xe2) - 0x28 ^ 0xb ^ (byte)((ulong)uVar7 &gt;&gt; 0x30),
                               CONCAT15((bVar15 ^ 0x17) - 0x25 ^ 10 ^ (byte)((ulong)uVar7 &gt;&gt; 0x28) ,
                                        CONCAT14(((bVar14 | 8) ^ 0x45) - 0x22 ^ 9 ^
                                                 (byte)((ulong)uVar7 &gt;&gt; 0x20),
                                                 CONCAT13(bVar18,CONCAT12((bVar16 ^ 0x28) - 0x1c ^  7
                                                                          ^ (byte)((ulong)uVar7 &gt;&gt;
                                                                                  0x10),
                                                                          CONCAT11(((bVar17 | 5) ^
                                                                                   0x47) - 0x19 ^ 6
                                                                                   ^ (byte)((ulong)
                                                  uVar7 &gt;&gt; 8),
                                                  (bVar15 ^ 0x4c) - 0x16 ^ 5 ^ (byte)uVar7)))))));
        iVar9 = rand();
        iVar9 = iVar9 % 100;
        iVar10 = rand();
        iVar10 = iVar10 % 100;
        uVar13 = 0xbecf;
        if (iVar9 * iVar9 + iVar10 * iVar10 &lt;= (iVar10 + iVar9) * (iVar10 + iVar9)) {
          uVar13 = 0x7a8b;
        }
      }
    }
    else if (uVar13 &lt; 0xbecf) {
      if (uVar13 == 0x7a8b) {
        if (((((((((((((((*pbVar11 == *param_1 &amp;&amp; pbVar11[1] == param_1[1]) &amp;&amp;
                        pbVar11[2] == param_1[2]) &amp;&amp; pbVar11[3] == param_1[3]) &amp;&amp;
                      pbVar11[4] == param_1[4]) &amp;&amp; pbVar11[5] == param_1[5]) &amp;&amp;
                    pbVar11[6] == param_1[6]) &amp;&amp; pbVar11[7] == param_1[7]) &amp;&amp; bVar18 == param_1[8])
                 &amp;&amp; pbVar11[9] == param_1[9]) &amp;&amp; pbVar11[10] == param_1[10]) &amp;&amp;
               pbVar11[0xb] == param_1[0xb]) &amp;&amp; pbVar11[0xc] == param_1[0xc]) &amp;&amp;
             pbVar11[0xd] == param_1[0xd]) &amp;&amp; pbVar11[0xe] == param_1[0xe]) &amp;&amp;
            pbVar11[0xf] == param_1[0xf]) {
          iVar9 = rand();
          iVar9 = iVar9 % 100;
          iVar10 = rand();
          iVar10 = iVar10 % 100;
          if (iVar9 * iVar9 + iVar10 * iVar10 &lt;= (iVar10 + iVar9) * (iVar10 + iVar9)) {
            uVar13 = 0x9cad;
            goto LAB_0011b008;
          }
        }
LAB_0011b004:
        uVar13 = 0xbecf;
      }
      else {
        if (uVar13 != 0x9cad) goto LAB_0011b538;
        local_90 = 1;
LAB_0011b0f4:
        uVar13 = 0xd1e2;
      }
    }
    else {
      if (uVar13 == 0xbecf) {
        local_90 = 0;
        goto LAB_0011b0f4;
      }
      if (uVar13 == 0xd1e2) {
        return local_90;
      }
LAB_0011b538:
      iVar9 = rand();
      iVar9 = iVar9 % 100;
      iVar10 = rand();
      iVar10 = iVar10 % 100;
      if (iVar9 * iVar9 + iVar10 * iVar10 &lt;= (iVar10 + iVar9) * (iVar10 + iVar9)) {
        uVar13 = 0xbecf;
      }
    }
LAB_0011b008:
    rand();
  } while( true );
}
</code></pre><p>So i give this to chatGPT and i have a python code solve the second half like this:</p><pre tabindex=0><code># solve_second_half.py
def u8(x): return x &amp; 0xFF

def compute_second_half():
    # puVar12 = 0xb8 14 e2 7d + 0x63 (little-endian 0xb814e27d then 0x63)
    b2 = 0x7d
    b1 = 0xe2
    b3 = 0x14
    b4 = 0xb8
    b5 = 0x63

    # duplicates in code
    b14 = 0x63
    b15 = 0x7d
    b17 = 0xe2
    b16 = 0x14
    b18 = 0xb8

    pb = [0]*16

    pb[1]  = u8(((b17 ^ 0x6C) - 10) ^ b1)
    pb[0]  = u8(((b15 ^ 0x2F) - 7) ^ b2)
    pb[2]  = u8((((b16 | 1) ^ 0x95) - 13) ^ b3 ^ 2)
    pb[13] = u8((((b18 ^ 8) - 46) ^ b4) ^ 13)
    pb[4]  = u8((((b14 ^ 0x74) - 19) ^ b5) ^ 4)
    pb[15] = u8((((b15 ^ 7) - 52) ^ b2) ^ 15)
    pb[3]  = u8((((b18 | 2) ^ 0x21) - 16) ^ b4)
    pb[14] = u8((((b14 ^ 0x5A) - 49) ^ b5) ^ 14)

    # Build auVar6 (first 5 bytes are [b2,b1,b3,b4,b5])
    au = [0]*16
    au[0],au[1],au[2],au[3],au[4] = b2,b1,b3,b4,b5

    # a64_TBL(..., mask=0x0201000403020100) → select bytes [0,1,2,3,4,0,1,2]
    sel = [au[i] for i in (0,1,2,3,4,0,1,2)]
    pick = lambda sh: sel[(sh//8)]

    # update b18 and fill pb[5..12]
    b18 = u8(((b18 | 7) ^ 0x4D) - 0x1F ^ 8 ^ pick(0x18))
    X1 = u8((b15 ^ 0x4C) - 0x16 ^ 5  ^ pick(0x00))
    X2 = u8(((b17 | 5) ^ 0x47) - 0x19 ^ 6  ^ pick(0x08))
    X3 = u8((b16 ^ 0x28) - 0x1C ^ 7  ^ pick(0x10))
    X4 = u8(((b14 | 8) ^ 0x45) - 0x22 ^ 9  ^ pick(0x20))
    X5 = u8((b15 ^ 0x17) - 0x25 ^ 10 ^ pick(0x28))
    X6 = u8((b17 ^ 0xE2) - 0x28 ^ 11 ^ pick(0x30))
    X7 = u8(((b16 | 0xB) ^ 0x53) - 0x2B ^ 12 ^ pick(0x38))

    pb[5],pb[6],pb[7],pb[8],pb[9],pb[10],pb[11],pb[12] = X1,X2,X3,b18,X4,X5,X6,X7

    return bytes(pb)

if __name__ == &#34;__main__&#34;:
    second = compute_second_half()
    print(second.hex())       # 6fe3ccc3cf2197e4
    print(second.decode())    # 6fe3ccc3cf2197e4
</code></pre><p>The output is:</p><pre tabindex=0><code>6fe3ccc3cf2197e4
</code></pre><p>So the flag is CSCV2025{8ea7cac7948424406fe3ccc3cf2197e4}
Thanks for watching this post😘!</p></div></div><script type=text/javascript src=/MSEC/js/page.min.54b6f4371722649edbe871e431d8670d670878c22be8f36e229fe53cc9b786fe25a834def5e6de621f7a3e37b72bc8cd73839aa5ed907ed6cbd45cd3e1b0fa20.js integrity="sha512-VLb0NxciZJ7b6HHkMdhnDWcIeMIr6PNuIp/lPMm3hv4lqDTe9ebeYh96Pje3K8jNc4Oape2QftbL1FzT4bD6IA==" data-oid=views_RE/1761315247629-re/index.md data-oid-likes=likes_RE/1761315247629-re/index.md></script></section><footer class="pt-8 max-w-prose print:hidden"><div class=pt-8><hr class="border-dotted border-neutral-300 dark:border-neutral-600"><div class="flex justify-between pt-3"><span class="flex flex-col"><a class="flex text-neutral-700 hover:text-primary-600 dark:text-neutral dark:hover:text-primary-400" href=/MSEC/re/1761292805274-dauif/><span class=leading-6><span class="inline-block rtl:rotate-180">&larr;</span>&ensp;Write-up REEZS
</span></a><span class="ms-6 mt-1 text-xs text-neutral-500 dark:text-neutral-400"><time datetime=0001-01-01T00:00:00+00:00>1 January 0001</time>
</span></span><span class="flex flex-col items-end"><a class="flex text-right text-neutral-700 hover:text-primary-600 dark:text-neutral dark:hover:text-primary-400" href=/MSEC/re/1761315251658-re/><span class=leading-6>Write-up for Chatbot CSCV2025&ensp;<span class="inline-block rtl:rotate-180">&rarr;</span>
</span></a><span class="me-6 mt-1 text-xs text-neutral-500 dark:text-neutral-400"><time datetime=0001-01-01T00:00:00+00:00>1 January 0001</time></span></span></div></div></footer></article><div id=scroll-to-top class="fixed bottom-24 end-6 z-50 transform translate-y-4 opacity-0 duration-200"><a href=#the-top class="pointer-events-auto flex h-12 w-12 items-center justify-center rounded-full bg-neutral/50 text-xl text-neutral-700 hover:text-primary-600 dark:bg-neutral-800/50 dark:text-neutral dark:hover:text-primary-400" aria-label="Scroll to top" title="Scroll to top">&uarr;</a></div></main><footer id=site-footer class="py-10 print:hidden"><nav class="flex flex-row pb-4 text-base font-medium text-neutral-500 dark:text-neutral-400 overflow-x-auto py-2"><ul class="flex list-none flex-row"><li class="flex mb-1 text-end sm:mb-0 sm:me-7 sm:last:me-0 me-4"><a class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2 flex items-center" href title></a></li></ul></nav><div class="flex items-center justify-between"><p class="text-sm text-neutral-500 dark:text-neutral-400">&copy;
2025</p><p class="text-xs text-neutral-500 dark:text-neutral-400">Powered by <a class="hover:underline hover:decoration-primary-400 hover:text-primary-500" href=https://gohugo.io/ target=_blank rel="noopener noreferrer">Hugo</a> & <a class="hover:underline hover:decoration-primary-400 hover:text-primary-500" href=https://blowfish.page/ target=_blank rel="noopener noreferrer">Blowfish</a></p></div><script>mediumZoom(document.querySelectorAll("img:not(.nozoom)"),{margin:24,background:"rgba(0,0,0,0.5)",scrollOffset:0})</script><script type=text/javascript src=/MSEC/js/process.min.ee03488f19c93c2efb199e2e3014ea5f3cb2ce7d45154adb3399a158cac27ca52831db249ede5bb602700ef87eb02434139de0858af1818ab0fb4182472204a4.js integrity="sha512-7gNIjxnJPC77GZ4uMBTqXzyyzn1FFUrbM5mhWMrCfKUoMdsknt5btgJwDvh+sCQ0E53ghYrxgYqw+0GCRyIEpA=="></script></footer><div id=search-wrapper class="invisible fixed inset-0 flex h-screen w-screen cursor-default flex-col bg-neutral-500/50 p-4 backdrop-blur-sm dark:bg-neutral-900/50 sm:p-6 md:p-[10vh] lg:p-[12vh] z-500" data-url=https://mtasecurity.github.io/MSEC/><div id=search-modal class="flex flex-col w-full max-w-3xl min-h-0 mx-auto border rounded-md shadow-lg top-20 border-neutral-200 bg-neutral dark:border-neutral-700 dark:bg-neutral-800"><header class="relative z-10 flex items-center justify-between flex-none px-2"><form class="flex items-center flex-auto min-w-0"><div class="flex items-center justify-center w-8 h-8 text-neutral-400"><span class="relative block icon"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7 405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9.0 208 0S0 93.1.0 208s93.1 208 208 208c48.3.0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9.0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7.0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7.0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg></span></div><input type=search id=search-query class="flex flex-auto h-12 mx-1 bg-transparent appearance-none focus:outline-dotted focus:outline-2 focus:outline-transparent" placeholder=Search tabindex=0></form><button id=close-search-button class="flex items-center justify-center w-8 h-8 text-neutral-700 hover:text-primary-600 dark:text-neutral dark:hover:text-primary-400" title="Close (Esc)">
<span class="relative block icon"><svg viewBox="0 0 320 512"><path fill="currentColor" d="M310.6 361.4c12.5 12.5 12.5 32.75.0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3 54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75.0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75.0-45.25s32.75-12.5 45.25.0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25.0s12.5 32.75.0 45.25l-105.4 105.4L310.6 361.4z"/></svg></span></button></header><section class="flex-auto px-2 overflow-auto"><ul id=search-results></ul></section></div></div></div></body></html>